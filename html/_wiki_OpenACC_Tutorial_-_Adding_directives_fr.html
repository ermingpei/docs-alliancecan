<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Tutoriel OpenACC : Ajouter des directives - Alliance Doc</title>
<script>(function(){var className="client-js";var cookie=document.cookie.match(/(?:^|; )ccwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],"wgRequestId":"aDpE1rFgDh4jAkatbzZEzAAAAIE","wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"OpenACC_Tutorial_-_Adding_directives/fr","wgTitle":"OpenACC Tutorial - Adding directives/fr","wgCurRevisionId":138004,"wgRevisionId":138004,"wgArticleId":3228,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":
null,"wgUserGroups":["*"],"wgCategories":[],"wgPageViewLanguage":"fr","wgPageContentLanguage":"fr","wgPageContentModel":"wikitext","wgRelevantPageName":"OpenACC_Tutorial_-_Adding_directives/fr","wgRelevantArticleId":3228,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgULSAcceptLanguageList":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"watchlist":false,"tagline":false},"wgCiteReferencePreviewsActive":true,"wgTranslatePageTranslation":"translation","wgULSPosition":"personal","wgULSisCompactLinksEnabled":true,"wgVector2022LanguageInHeader":false,"wgULSisLanguageSelectorEmpty":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.translate.tag.languages":"ready","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.translate":"ready","codex-search-styles":"ready","ext.uls.pt":"ready"};RLPAGEMODULES=["ext.pygments.view","mediawiki.page.media","site",
"mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.languageSelector","ext.translate.pagetranslation.uls","ext.uls.compactlinks","ext.uls.geoclient","ext.uls.interface","ext.moderation.notify","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=codex-search-styles%7Cext.pygments%2Ctranslate%7Cext.translate.tag.languages%7Cext.uls.pt%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector">
<script async="" src="/mediawiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<link rel="icon" href="/mediawiki/resources/assets/Alliance_favicon.png">
<link rel="search" type="application/opensearchdescription+xml" href="/mediawiki/rest.php/v1/search" title="Alliance Doc (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://docs.alliancecan.ca/mediawiki/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="Alliance Doc Atom feed" href="/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector-legacy mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-OpenACC_Tutorial_-_Adding_directives_fr rootpage-OpenACC_Tutorial_-_Adding_directives_fr skin-vector action-view"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	<div id="mw-indicator-languageselector" class="mw-indicator"><span id="languageselector-box-1" class="languageselector " style=""><form name="languageselector-form-1" id="languageselector-form-1" method="get" action="/mediawiki/index.php" style="display:inline;"><input type="hidden" value="OpenACC_Tutorial_-_Adding_directives/fr" name="title"><select name="setlang" id="languageselector-select-1" style=""><option value="aae">Arbërisht</option><option value="ab">аԥсшәа</option><option value="abs">bahasa ambon</option><option value="ace">Acèh</option><option value="acf">Kwéyòl Sent Lisi</option><option value="acm">عراقي</option><option value="ady">адыгабзэ</option><option value="ady-cyrl">адыгабзэ</option><option value="aeb">تونسي / Tûnsî</option><option value="aeb-arab">تونسي</option><option value="aeb-latn">Tûnsî</option><option value="af">Afrikaans</option><option value="aln">Gegë</option><option value="alt">алтай тил</option><option value="am">አማርኛ</option><option value="ami">Pangcah</option><option value="an">aragonés</option><option value="ang">Ænglisc</option><option value="ann">Obolo</option><option value="anp">अंगिका</option><option value="apc">شامي</option><option value="ar">العربية</option><option value="arc">ܐܪܡܝܐ</option><option value="arn">mapudungun</option><option value="arq">جازايرية</option><option value="ary">الدارجة</option><option value="arz">مصرى</option><option value="as">অসমীয়া</option><option value="ase">American sign language</option><option value="ast">asturianu</option><option value="atj">Atikamekw</option><option value="av">авар</option><option value="avk">Kotava</option><option value="awa">अवधी</option><option value="ay">Aymar aru</option><option value="az">azərbaycanca</option><option value="azb">تۆرکجه</option><option value="ba">башҡортса</option><option value="ban">Basa Bali</option><option value="ban-bali">ᬩᬲᬩᬮᬶ</option><option value="bar">Boarisch</option><option value="bbc">Batak Toba</option><option value="bbc-latn">Batak Toba</option><option value="bcc">جهلسری بلوچی</option><option value="bci">wawle</option><option value="bcl">Bikol Central</option><option value="bdr">Bajau Sama</option><option value="be">беларуская</option><option value="be-tarask">беларуская (тарашкевіца)</option><option value="bew">Betawi</option><option value="bg">български</option><option value="bgc">हरियाणवी</option><option value="bgn">روچ کپتین بلوچی</option><option value="bh">भोजपुरी</option><option value="bho">भोजपुरी</option><option value="bi">Bislama</option><option value="bjn">Banjar</option><option value="blk">ပအိုဝ်ႏဘာႏသာႏ</option><option value="bm">bamanankan</option><option value="bn">বাংলা</option><option value="bo">བོད་ཡིག</option><option value="bpy">বিষ্ণুপ্রিয়া মণিপুরী</option><option value="bqi">بختیاری</option><option value="br">brezhoneg</option><option value="brh">Bráhuí</option><option value="bs">bosanski</option><option value="btm">Batak Mandailing</option><option value="bto">Iriga Bicolano</option><option value="bug">Basa Ugi</option><option value="bxr">буряад</option><option value="ca">català</option><option value="cbk-zam">Chavacano de Zamboanga</option><option value="ccp">𑄌𑄋𑄴𑄟𑄳𑄦</option><option value="cdo">閩東語 / Mìng-dĕ̤ng-ngṳ̄</option><option value="ce">нохчийн</option><option value="ceb">Cebuano</option><option value="ch">Chamoru</option><option value="chn">chinuk wawa</option><option value="chr">ᏣᎳᎩ</option><option value="chy">Tsetsêhestâhese</option><option value="ckb">کوردی</option><option value="co">corsu</option><option value="cps">Capiceño</option><option value="cpx">莆仙語 / Pó-sing-gṳ̂</option><option value="cpx-hans">莆仙语（简体）</option><option value="cpx-hant">莆仙語（繁體）</option><option value="cr">Nēhiyawēwin / ᓀᐦᐃᔭᐍᐏᐣ</option><option value="crh">qırımtatarca</option><option value="crh-cyrl">къырымтатарджа (Кирилл)</option><option value="crh-latn">qırımtatarca (Latin)</option><option value="crh-ro">tatarşa</option><option value="cs">čeština</option><option value="csb">kaszëbsczi</option><option value="cu">словѣньскъ / ⰔⰎⰑⰂⰡⰐⰠⰔⰍⰟ</option><option value="cv">чӑвашла</option><option value="cy">Cymraeg</option><option value="da">dansk</option><option value="dag">dagbanli</option><option value="de">Deutsch</option><option value="de-at">Österreichisches Deutsch</option><option value="de-ch">Schweizer Hochdeutsch</option><option value="de-formal">Deutsch (Sie-Form)</option><option value="dga">Dagaare</option><option value="din">Thuɔŋjäŋ</option><option value="diq">Zazaki</option><option value="dsb">dolnoserbski</option><option value="dtp">Kadazandusun</option><option value="dty">डोटेली</option><option value="dua">Duálá</option><option value="dv">ދިވެހިބަސް</option><option value="dz">ཇོང་ཁ</option><option value="ee">eʋegbe</option><option value="efi">Efịk</option><option value="egl">emiliàn e rumagnòl</option><option value="el">Ελληνικά</option><option value="eml">emiliàn e rumagnòl</option><option value="en" selected="">English</option><option value="en-ca">Canadian English</option><option value="en-gb">British English</option><option value="eo">Esperanto</option><option value="es">español</option><option value="es-formal">español (formal)</option><option value="et">eesti</option><option value="eu">euskara</option><option value="ext">estremeñu</option><option value="fa">فارسی</option><option value="fat">mfantse</option><option value="ff">Fulfulde</option><option value="fi">suomi</option><option value="fit">meänkieli</option><option value="fj">Na Vosa Vakaviti</option><option value="fo">føroyskt</option><option value="fon">fɔ̀ngbè</option><option value="fr">français</option><option value="frc">français cadien</option><option value="frp">arpetan</option><option value="frr">Nordfriisk</option><option value="fur">furlan</option><option value="fy">Frysk</option><option value="ga">Gaeilge</option><option value="gaa">Ga</option><option value="gag">Gagauz</option><option value="gan">贛語</option><option value="gan-hans">赣语（简体）</option><option value="gan-hant">贛語（繁體）</option><option value="gcf">kréyòl Gwadloup</option><option value="gcr">kriyòl gwiyannen</option><option value="gd">Gàidhlig</option><option value="gl">galego</option><option value="gld">на̄ни</option><option value="glk">گیلکی</option><option value="gn">Avañe'ẽ</option><option value="gom">गोंयची कोंकणी / Gõychi Konknni</option><option value="gom-deva">गोंयची कोंकणी</option><option value="gom-latn">Gõychi Konknni</option><option value="gor">Bahasa Hulontalo</option><option value="got">𐌲𐌿𐍄𐌹𐍃𐌺</option><option value="gpe">Ghanaian Pidgin</option><option value="grc">Ἀρχαία ἑλληνικὴ</option><option value="gsw">Alemannisch</option><option value="gu">ગુજરાતી</option><option value="guc">wayuunaiki</option><option value="gur">farefare</option><option value="guw">gungbe</option><option value="gv">Gaelg</option><option value="ha">Hausa</option><option value="hak">客家語 / Hak-kâ-ngî</option><option value="haw">Hawaiʻi</option><option value="he">עברית</option><option value="hi">हिन्दी</option><option value="hif">Fiji Hindi</option><option value="hif-latn">Fiji Hindi</option><option value="hil">Ilonggo</option><option value="hno">ہندکو</option><option value="hr">hrvatski</option><option value="hrx">Hunsrik</option><option value="hsb">hornjoserbsce</option><option value="hsn">湘語</option><option value="ht">Kreyòl ayisyen</option><option value="hu">magyar</option><option value="hu-formal">magyar (formal)</option><option value="hy">հայերեն</option><option value="hyw">Արեւմտահայերէն</option><option value="ia">interlingua</option><option value="iba">Jaku Iban</option><option value="ibb">ibibio</option><option value="id">Bahasa Indonesia</option><option value="ie">Interlingue</option><option value="ig">Igbo</option><option value="igl">Igala</option><option value="ii">ꆇꉙ</option><option value="ik">Iñupiatun</option><option value="ike-cans">ᐃᓄᒃᑎᑐᑦ</option><option value="ike-latn">inuktitut</option><option value="ilo">Ilokano</option><option value="inh">гӀалгӀай</option><option value="io">Ido</option><option value="is">íslenska</option><option value="isv-cyrl">меджусловјанскы</option><option value="isv-latn">medžuslovjansky</option><option value="it">italiano</option><option value="iu">ᐃᓄᒃᑎᑐᑦ / inuktitut</option><option value="ja">日本語</option><option value="jam">Patois</option><option value="jbo">la .lojban.</option><option value="jut">jysk</option><option value="jv">Jawa</option><option value="ka">ქართული</option><option value="kaa">Qaraqalpaqsha</option><option value="kab">Taqbaylit</option><option value="kai">Karai-karai</option><option value="kbd">адыгэбзэ</option><option value="kbd-cyrl">адыгэбзэ</option><option value="kbp">Kabɩyɛ</option><option value="kcg">Tyap</option><option value="kea">kabuverdianu</option><option value="kg">Kongo</option><option value="kge">Kumoring</option><option value="khw">کھوار</option><option value="ki">Gĩkũyũ</option><option value="kiu">Kırmancki</option><option value="kjh">хакас</option><option value="kjp">ဖၠုံလိက်</option><option value="kk">қазақша</option><option value="kk-arab">قازاقشا (تٴوتە)</option><option value="kk-cn">قازاقشا (جۇنگو)</option><option value="kk-cyrl">қазақша (кирил)</option><option value="kk-kz">қазақша (Қазақстан)</option><option value="kk-latn">qazaqşa (latın)</option><option value="kk-tr">qazaqşa (Türkïya)</option><option value="kl">kalaallisut</option><option value="km">ភាសាខ្មែរ</option><option value="kn">ಕನ್ನಡ</option><option value="knc">Yerwa Kanuri</option><option value="ko">한국어</option><option value="ko-kp">조선말</option><option value="koi">перем коми</option><option value="kr">kanuri</option><option value="krc">къарачай-малкъар</option><option value="kri">Krio</option><option value="krj">Kinaray-a</option><option value="krl">karjal</option><option value="ks">कॉशुर / کٲشُر</option><option value="ks-arab">کٲشُر</option><option value="ks-deva">कॉशुर</option><option value="ksh">Ripoarisch</option><option value="ksw">စှီၤ</option><option value="ku">kurdî</option><option value="ku-arab">کوردی (عەرەبی)</option><option value="ku-latn">kurdî (latînî)</option><option value="kum">къумукъ</option><option value="kus">Kʋsaal</option><option value="kv">коми</option><option value="kw">kernowek</option><option value="ky">кыргызча</option><option value="la">Latina</option><option value="lad">Ladino</option><option value="lb">Lëtzebuergesch</option><option value="lbe">лакку</option><option value="lez">лезги</option><option value="lfn">Lingua Franca Nova</option><option value="lg">Luganda</option><option value="li">Limburgs</option><option value="lij">Ligure</option><option value="liv">Līvõ kēļ</option><option value="lki">لەکی</option><option value="lld">Ladin</option><option value="lmo">lombard</option><option value="ln">lingála</option><option value="lo">ລາວ</option><option value="loz">Silozi</option><option value="lrc">لۊری شومالی</option><option value="lt">lietuvių</option><option value="ltg">latgaļu</option><option value="lua">ciluba</option><option value="lus">Mizo ţawng</option><option value="luz">لئری دوٙمینی</option><option value="lv">latviešu</option><option value="lzh">文言</option><option value="lzz">Lazuri</option><option value="mad">Madhurâ</option><option value="mag">मगही</option><option value="mai">मैथिली</option><option value="map-bms">Basa Banyumasan</option><option value="mdf">мокшень</option><option value="mg">Malagasy</option><option value="mhr">олык марий</option><option value="mi">Māori</option><option value="min">Minangkabau</option><option value="mk">македонски</option><option value="ml">മലയാളം</option><option value="mn">монгол</option><option value="mnc">manju gisun</option><option value="mnc-latn">manju gisun</option><option value="mnc-mong">ᠮᠠᠨᠵᡠ ᡤᡳᠰᡠᠨ</option><option value="mni">ꯃꯤꯇꯩ ꯂꯣꯟ</option><option value="mnw">ဘာသာမန်</option><option value="mo">молдовеняскэ</option><option value="mos">moore</option><option value="mr">मराठी</option><option value="mrh">Mara</option><option value="mrj">кырык мары</option><option value="ms">Bahasa Melayu</option><option value="ms-arab">بهاس ملايو</option><option value="mt">Malti</option><option value="mui">Baso Palembang</option><option value="mwl">Mirandés</option><option value="my">မြန်မာဘာသာ</option><option value="myv">эрзянь</option><option value="mzn">مازِرونی</option><option value="na">Dorerin Naoero</option><option value="nah">Nāhuatl</option><option value="nan">閩南語 / Bân-lâm-gú</option><option value="nan-hant">閩南語（傳統漢字）</option><option value="nan-latn-pehoeji">Bân-lâm-gú (Pe̍h-ōe-jī)</option><option value="nan-latn-tailo">Bân-lâm-gú (Tâi-lô)</option><option value="nap">Napulitano</option><option value="nb">norsk bokmål</option><option value="nds">Plattdüütsch</option><option value="nds-nl">Nedersaksies</option><option value="ne">नेपाली</option><option value="new">नेपाल भाषा</option><option value="nia">Li Niha</option><option value="nit">కొలామి</option><option value="niu">Niuē</option><option value="nl">Nederlands</option><option value="nl-informal">Nederlands (informeel)</option><option value="nmz">nawdm</option><option value="nn">norsk nynorsk</option><option value="nod">ᨣᩤᩴᨾᩮᩬᩥᨦ</option><option value="nog">ногайша</option><option value="nov">Novial</option><option value="nqo">ߒߞߏ</option><option value="nr">isiNdebele seSewula</option><option value="nrm">Nouormand</option><option value="nso">Sesotho sa Leboa</option><option value="nup">Nupe</option><option value="nv">Diné bizaad</option><option value="ny">Chi-Chewa</option><option value="nyn">runyankore</option><option value="nyo">Orunyoro</option><option value="nys">Nyunga</option><option value="oc">occitan</option><option value="ojb">Ojibwemowin</option><option value="olo">livvinkarjala</option><option value="om">Oromoo</option><option value="or">ଓଡ଼ିଆ</option><option value="os">ирон</option><option value="pa">ਪੰਜਾਬੀ</option><option value="pag">Pangasinan</option><option value="pam">Kapampangan</option><option value="pap">Papiamentu</option><option value="pcd">Picard</option><option value="pcm">Naijá</option><option value="pdc">Deitsch</option><option value="pdt">Plautdietsch</option><option value="pfl">Pälzisch</option><option value="pi">पालि</option><option value="pih">Norfuk / Pitkern</option><option value="pl">polski</option><option value="pms">Piemontèis</option><option value="pnb">پنجابی</option><option value="pnt">Ποντιακά</option><option value="prg">prūsiskan</option><option value="ps">پښتو</option><option value="pt">português</option><option value="pt-br">português do Brasil</option><option value="pwn">pinayuanan</option><option value="qqq">Message documentation</option><option value="qu">Runa Simi</option><option value="qug">Runa shimi</option><option value="rgn">Rumagnôl</option><option value="rif">Tarifit</option><option value="rki">ရခိုင်</option><option value="rm">rumantsch</option><option value="rmc">romaňi čhib</option><option value="rmy">romani čhib</option><option value="rn">ikirundi</option><option value="ro">română</option><option value="roa-tara">tarandíne</option><option value="rsk">руски</option><option value="ru">русский</option><option value="rue">русиньскый</option><option value="rup">armãneashti</option><option value="ruq">Vlăheşte</option><option value="ruq-cyrl">Влахесте</option><option value="ruq-latn">Vlăheşte</option><option value="rut">мыхаӀбишды</option><option value="rw">Ikinyarwanda</option><option value="ryu">うちなーぐち</option><option value="sa">संस्कृतम्</option><option value="sah">саха тыла</option><option value="sat">ᱥᱟᱱᱛᱟᱲᱤ</option><option value="sc">sardu</option><option value="scn">sicilianu</option><option value="sco">Scots</option><option value="sd">سنڌي</option><option value="sdc">Sassaresu</option><option value="sdh">کوردی خوارگ</option><option value="se">davvisámegiella</option><option value="se-fi">davvisámegiella (Suoma bealde)</option><option value="se-no">davvisámegiella (Norgga bealde)</option><option value="se-se">davvisámegiella (Ruoŧa bealde)</option><option value="sei">Cmique Itom</option><option value="ses">Koyraboro Senni</option><option value="sg">Sängö</option><option value="sgs">žemaitėška</option><option value="sh">srpskohrvatski / српскохрватски</option><option value="sh-cyrl">српскохрватски (ћирилица)</option><option value="sh-latn">srpskohrvatski (latinica)</option><option value="shi">Taclḥit</option><option value="shn">ၽႃႇသႃႇတႆး </option><option value="shy">tacawit</option><option value="shy-latn">tacawit</option><option value="si">සිංහල</option><option value="sjd">кӣллт са̄мь кӣлл</option><option value="sje">bidumsámegiella</option><option value="sk">slovenčina</option><option value="skr">سرائیکی</option><option value="skr-arab">سرائیکی</option><option value="sl">slovenščina</option><option value="sli">Schläsch</option><option value="sm">Gagana Samoa</option><option value="sma">åarjelsaemien</option><option value="smn">anarâškielâ</option><option value="sms">nuõrttsääʹmǩiõll</option><option value="sn">chiShona</option><option value="so">Soomaaliga</option><option value="sq">shqip</option><option value="sr">српски / srpski</option><option value="sr-ec">српски (ћирилица)</option><option value="sr-el">srpski (latinica)</option><option value="srn">Sranantongo</option><option value="sro">sardu campidanesu</option><option value="ss">SiSwati</option><option value="st">Sesotho</option><option value="stq">Seeltersk</option><option value="sty">себертатар</option><option value="su">Sunda</option><option value="sv">svenska</option><option value="sw">Kiswahili</option><option value="syl">ꠍꠤꠟꠐꠤ</option><option value="szl">ślůnski</option><option value="szy">Sakizaya</option><option value="ta">தமிழ்</option><option value="tay">Tayal</option><option value="tcy">ತುಳು</option><option value="tdd">ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ</option><option value="te">తెలుగు</option><option value="tet">tetun</option><option value="tg">тоҷикӣ</option><option value="tg-cyrl">тоҷикӣ</option><option value="tg-latn">tojikī</option><option value="th">ไทย</option><option value="ti">ትግርኛ</option><option value="tig">ትግሬ</option><option value="tk">Türkmençe</option><option value="tl">Tagalog</option><option value="tly">tolışi</option><option value="tn">Setswana</option><option value="to">lea faka-Tonga</option><option value="tok">toki pona</option><option value="tpi">Tok Pisin</option><option value="tr">Türkçe</option><option value="tru">Ṫuroyo</option><option value="trv">Seediq</option><option value="ts">Xitsonga</option><option value="tt">татарча / tatarça</option><option value="tt-cyrl">татарча</option><option value="tt-latn">tatarça</option><option value="ttj">Orutooro</option><option value="tum">chiTumbuka</option><option value="tw">Twi</option><option value="ty">reo tahiti</option><option value="tyv">тыва дыл</option><option value="tzm">ⵜⴰⵎⴰⵣⵉⵖⵜ</option><option value="udm">удмурт</option><option value="ug">ئۇيغۇرچە / Uyghurche</option><option value="ug-arab">ئۇيغۇرچە</option><option value="ug-latn">Uyghurche</option><option value="uk">українська</option><option value="ur">اردو</option><option value="uz">oʻzbekcha / ўзбекча</option><option value="ve">Tshivenda</option><option value="vec">vèneto</option><option value="vep">vepsän kel’</option><option value="vi">Tiếng Việt</option><option value="vls">West-Vlams</option><option value="vmf">Mainfränkisch</option><option value="vmw">emakhuwa</option><option value="vo">Volapük</option><option value="vot">Vaďďa</option><option value="vro">võro</option><option value="wa">walon</option><option value="wal">wolaytta</option><option value="war">Winaray</option><option value="wls">Fakaʻuvea</option><option value="wo">Wolof</option><option value="wuu">吴语</option><option value="wuu-hans">吴语（简体）</option><option value="wuu-hant">吳語（正體）</option><option value="xal">хальмг</option><option value="xh">isiXhosa</option><option value="xmf">მარგალური</option><option value="xsy">saisiyat</option><option value="yi">ייִדיש</option><option value="yo">Yorùbá</option><option value="yrl">Nhẽẽgatú</option><option value="yue">粵語</option><option value="yue-hans">粵语（简体）</option><option value="yue-hant">粵語（繁體）</option><option value="za">Vahcuengh</option><option value="zea">Zeêuws</option><option value="zgh">ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ</option><option value="zh">中文</option><option value="zh-cn">中文（中国大陆）</option><option value="zh-hans">中文（简体）</option><option value="zh-hant">中文（繁體）</option><option value="zh-hk">中文（香港）</option><option value="zh-mo">中文（澳門）</option><option value="zh-my">中文（马来西亚）</option><option value="zh-sg">中文（新加坡）</option><option value="zh-tw">中文（臺灣）</option><option value="zu">isiZulu</option></select><input id="languageselector-commit-1" style="" type="submit" value="set"></form></span></div>
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">Tutoriel OpenACC : Ajouter des directives</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Alliance Doc</div>
		<div id="contentSub"><div id="mw-content-subtitle"></div></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a rel="nofollow" class="external text" href="https://docs.alliancecan.ca/mediawiki/index.php?title=Special:Translate&amp;group=page-OpenACC+Tutorial+-+Adding+directives&amp;action=page&amp;filter=&amp;language=fr">translated version</a></span> of the page <a href="/wiki/OpenACC_Tutorial_-_Adding_directives" title="OpenACC Tutorial - Adding directives">OpenACC Tutorial - Adding directives</a> and the translation is 100% complete.</div><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="/wiki/OpenACC_Tutorial_-_Adding_directives" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="OpenACC Tutorial - Adding directives (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">français</span></li></ul></div>
<p><br />
</p>
<div class="panel objectives"><div class="panel-heading objectives"><div class="panel-heading-icon objectives"></div><div class="panel-heading-title">Objectifs d'apprentissage</div></div>
<div class="panel-body objectives">
<ul><li>comprendre le processus de transfert (<i>offloading</i>)</li>
<li>comprendre ce qu'est une directive OpenACC</li>
<li>connaitre la différence entre les directives <tt>loop</tt> et <tt>kernels</tt></li>
<li>savoir programmer avec OpenACC</li>
<li>comprendre le concept d'alias en C/C++</li>
<li>savoir utiliser la rétroaction du compilateur et éviter les faux alias</li></ul>
</div></div>
<p><br />
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Transfert_vers_un_processeur_graphique_(GPU)"><span class="tocnumber">1</span> <span class="toctext">Transfert vers un processeur graphique (GPU)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Directives_OpenACC"><span class="tocnumber">2</span> <span class="toctext">Directives OpenACC</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Boucles_et_noyaux"><span class="tocnumber">2.1</span> <span class="toctext">Boucles et noyaux</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#La_directive_kernels"><span class="tocnumber">3</span> <span class="toctext">La directive kernels</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Exemple_:_porter_un_produit_matrice-vecteur"><span class="tocnumber">3.1</span> <span class="toctext">Exemple&#160;: porter un produit matrice-vecteur</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Construire_avec_OpenACC"><span class="tocnumber">3.1.1</span> <span class="toctext">Construire avec OpenACC</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Réparer_les_fausses_dépendances_de_boucles"><span class="tocnumber">4</span> <span class="toctext">Réparer les fausses dépendances de boucles</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Mot-clé_restrict"><span class="tocnumber">4.1</span> <span class="toctext">Mot-clé restrict</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Boucle_avec_clause_independent"><span class="tocnumber">4.2</span> <span class="toctext">Boucle avec clause independent</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Produit_matrice-vecteur"><span class="tocnumber">4.3</span> <span class="toctext">Produit matrice-vecteur</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Performance_du_code_porté"><span class="tocnumber">5</span> <span class="toctext">Performance du code porté</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#NVIDIA_Visual_Profiler"><span class="tocnumber">5.1</span> <span class="toctext">NVIDIA Visual Profiler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#La_directive_parallel_loop"><span class="tocnumber">6</span> <span class="toctext">La directive parallel loop</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Différences_entre_parallel_loop_et_kernels"><span class="tocnumber">7</span> <span class="toctext">Différences entre parallel loop et kernels</span></a></li>
</ul>
</div>

<h2><span id="Transfert_vers_un_processeur_graphique_.28GPU.29"></span><span class="mw-headline" id="Transfert_vers_un_processeur_graphique_(GPU)">Transfert vers un processeur graphique (GPU)</span></h2>
<p>Avant de porter du code sur un GPU, il faut savoir que ceux-ci ne partagent pas la même mémoire que le CPU de l'hôte.
</p>
<ul><li>la mémoire de l'hôte est en général plus grande, mais plus lente que la mémoire du GPU;</li>
<li>un GPU n'a pas d'accès direct à la mémoire de l'hôte;</li>
<li>pour pouvoir utiliser un GPU, les données doivent passer par le bus PCI, dont la bande passante est moins grande que celles du CPU et du GPU;</li>
<li>il est donc de la plus haute importance de bien gérer les transferts entre la mémoire de départ et le GPU.  En anglais, ce processus s'appelle <i>offloading</i>.</li></ul>
<h2><span class="mw-headline" id="Directives_OpenACC">Directives OpenACC</span></h2>
<p>Les directives OpenAcc sont semblables aux directives <a href="/wiki/OpenMP/fr" title="OpenMP/fr">OpenMP</a>. En C/C++, ce sont des énoncés <tt>pragmas</tt>  et en Fortran, des commentaires. L'emploi de directives comporte plusieurs avantages&#160;:
</p>
<ul><li>Premièrement, puisque le code est peu affecté, les modifications peuvent se faire de manière incrémentale, un <tt>pragma</tt> à la fois;  ceci est particulièrement utile pour le débogage puisqu'il est ainsi facile d'identifier le changement précis qui crée le bogue.</li>
<li>Deuxièmement, OpenACC peut être désactivé au moment de la compilation;  les <tt>pragmas</tt> sont alors vus comme étant des commentaires et ne sont pas considérés par le compilateur, ce qui permet de compiler une version accélérée et une version normale à partir du même code source.</li>
<li>Troisièmement, comme le compilateur fait tout le travail de transfert, le même code peut être compilé pour différents types d'accélérateurs, que ce soit un GPU ou des instructions SIMD sur un CPU;    ainsi, un changement du matériel exigera simplement la mise à jour du compilateur, sans modification au code.</li></ul>
<p>Le code de notre exemple contient deux boucles&#160;: la première initialise deux vecteurs et la seconde effectue une opération de <a rel="nofollow" class="external text" href="https://fr.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">niveau 1</a> d'addition des vecteurs. 
</p>
<table class="wikitable" width="100%">

<tbody><tr>
<th>C/C++</th>
<th>FORTRAN
</th></tr>
<tr>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="2"></span><span class="p">{</span>
</span><span class="linenos" data-line="3"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos" data-line="6"></span><span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="linenos" data-line="7"></span><span class="w">  </span><span class="p">}</span>
<span class="linenos" data-line="8"></span>
<span class="linenos" data-line="9"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="10"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="11"></span><span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="12"></span><span class="w">  </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="13"></span><span class="p">}</span>
</span></pre></div></td>
<td><div class="mw-highlight mw-highlight-lang-fortran mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="c">!$acc kernels</span>
</span><span class="linenos" data-line="2"></span><span class="w">  </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span>
<span class="linenos" data-line="3"></span><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos" data-line="4"></span><span class="w">    </span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos" data-line="5"></span><span class="w">  </span><span class="k">end do</span>
<span class="linenos" data-line="6"></span><span class="k">  </span>
<span class="hll"><span class="linenos" data-line="7"></span><span class="k">  </span><span class="n">y</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">(:)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(:)</span>
</span><span class="linenos" data-line="8"></span><span class="c">!$acc end kernels</span>
</pre></div>
</td></tr></tbody></table>
<p>Dans les deux cas, le compilateur identifie deux noyaux (<i>kernels</i>)&#160;:
</p>
<ul><li>en C/C++, les deux noyaux sont à l'intérieur de chaque boucle.;</li>
<li>en Fortran, les noyaux sont à l'intérieur de la première boucle et à l'intérieur de la boucle implicite effectuée lors d'une opération sur des tableaux.</li></ul>
<p>Remarquez que le bloc OpenACC est délimité en C/C++ par des accolades; en Fortran, le commentaire est placé une fois au début et une dernière fois à la fin, avec l'ajout cette fois de <tt>end</tt>.
</p>
<h3><span class="mw-headline" id="Boucles_et_noyaux">Boucles et noyaux</span></h3>
<p>Quand le compilateur lit la directive OpenACC <tt>kernels</tt>, il analyse le code pour identifier les sections pouvant être parallélisées.
Ceci correspond souvent au corps d'une boucle qui a des itérations indépendantes.
Dans ce cas, le compilateur délimite le début et la fin du corps du code avec la fonction <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Compute_kernel"><i>kernel</i></a>.
Les appels à cette fonction ne seront pas affectés par les autres appels.
La fonction est compilée et peut ensuite être exécutée sur un accélérateur.
Comme chaque appel est indépendant, chacun des centaines de cœurs de l'accélérateur peut exécuter la fonction en parallèle pour un index spécifique.
</p>
<table class="wikitable" width="100%">

<tbody><tr>
<th>BOUCLE</th>
<th>KERNEL
</th></tr>
<tr>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="4"></span><span class="p">}</span>
</pre></div></td>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="kt">void</span><span class="w"> </span><span class="nf">kernelName</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="4"></span><span class="p">}</span>
</pre></div>
</td></tr>
<tr>
<td>Calcule séquentiellement de <tt>i=0</tt> à <tt>i=N-1</tt>, inclusivement.</td>
<td>Chaque unité de calcul exécute la fonction pour une seule valeur de <tt>i</tt>.
</td></tr></tbody></table>
<h2><span class="mw-headline" id="La_directive_kernels">La directive <code>kernels</code></span></h2>
<p>Cette directive est dite <i>descriptive</i>.  Le programmeur l'utilise pour signifier au compilateur les portions qui selon lui peuvent être parallélisées. Le compilateur fait ce qu'il veut de cette information et adopte la stratégie qui lui semble la meilleure pour exécuter le code, <b>incluant</b> son exécution séquentielle. De façon générale, le compilateur 
</p>
<ol><li>analyse le code pour détecter le parallélisme,</li>
<li>s'il détecte du parallélisme, identifie les données à transférer et décide quand faire le transfert,</li>
<li>crée un kernel,</li>
<li>transfère le kernel au GPU.</li></ol>
<p>Voici un exemple de cette directive&#160;:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="2"></span><span class="p">{</span>
</span><span class="linenos" data-line="3"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="6"></span><span class="w">  </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="7"></span><span class="p">}</span>
</span></pre></div> 
<p>Il est rare que le code soit aussi simple et il faut se baser sur la <a href="/wiki/OpenACC_Tutorial_-_Profiling/fr#Renseignements_sur_le_compilateur" title="OpenACC Tutorial - Profiling/fr"> rétroaction du compilateur</a> pour trouver les portions qu'il a négligé de paralléliser. 
</p><p><br />
</p>
<div class="panel callout"><div class="panel-heading callout"><div class="panel-heading-icon callout"></div><div class="panel-heading-title">Description ou prescription</div></div>
<div class="panel-body callout">
<p>Si vous avez déjà utilisé <a href="/wiki/OpenMP/fr" title="OpenMP/fr">OpenMP</a>, vous retrouverez dans OpenACC le principe de <i>directives</i>. Il existe cependant d'importantes différences entre les directives OpenMP et OpenACC&#160;:
</p>
<ul><li>Les directives OpenMP sont à la base <i>prescriptives</i>. Ceci signifie que le compilateur est forcé d'accomplir la parallélisation, peu importe que l'effet détériore ou améliore la performance. Le résultat est prévisible pour tous les compilateurs. De plus, la parallélisation se fera de la même manière, peu importe le matériel utilisé pour exécuter le code. Par contre, le même code peut connaitre une moins bonne performance, dépendant de l'architecture. Il peut donc être préférable par exemple de changer l'ordre des boucles. Pour paralléliser du code avec OpenMP et obtenir une performance optimale dans différentes architectures, il faudrait avoir un ensemble différent de directives pour chaque architecture.</li></ul>
<ul><li>Pour leur part, plusieurs directives OpenACC sont de nature <i>descriptive</i>. Ici, le compilateur est libre de compiler le code de la façon qu'il juge la meilleure, selon l'architecture visée. Dans certains cas, le code ne sera pas parallélisé du tout. Le <b>même code</b> exécuté sur un GPU ou sur un CPU peut donner du code binaire différent. Ceci signifie que la performance pourrait varier selon le compilateur  et que les compilateurs d'une nouvelle génération seront plus efficaces, surtout en présence de nouveau matériel.</li></ul>
</div></div>
<p><br />
</p>
<h3><span class="mw-headline" id="Exemple_:_porter_un_produit_matrice-vecteur">Exemple&#160;: porter un produit matrice-vecteur</span></h3>
<p>Pour notre exemple, nous utilisons du code provenant du  <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc">répertoire Github</a>, particulièrement une portion de code <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/cpp/matrix_functions.h#L20">fichier <code>cpp/matrix_functions.h</code></a>. Le code Fortran équivalent se trouve dans la sous-routine <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/f90/matrix.F90#L101"><code>matvec</code> contenue dans le fichier <code>matrix.F90</code></a>. Le code C++ est comme suit&#160;:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="29"></span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="30"></span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="31"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="32"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="linenos" data-line="33"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="34"></span><span class="w">      </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="35"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="36"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="37"></span><span class="w">      </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="38"></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-line="39"></span><span class="w">    </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="40"></span><span class="w">  </span><span class="p">}</span>
</pre></div> 
<p>Le  <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/cpp/step1.kernels/matrix_functions.h#L29">premier changement</a> à faire au code est d'ajouter la directive <tt>kernels</tt>  pour essayer de le faire exécuter sur le GPU.
Pour l'instant, nous n'avons pas à nous préoccuper du transfert des données ou à fournir des renseignements au compilateur.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="29"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="30"></span><span class="w">  </span><span class="p">{</span>
</span><span class="linenos" data-line="31"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="32"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="33"></span><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="34"></span><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="linenos" data-line="35"></span><span class="w">      </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="36"></span><span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="37"></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="38"></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="39"></span><span class="w">        </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="40"></span><span class="w">      </span><span class="p">}</span>
<span class="linenos" data-line="41"></span><span class="w">      </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="42"></span><span class="w">    </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="43"></span><span class="w">  </span><span class="p">}</span>
</span></pre></div> 
<h4><span class="mw-headline" id="Construire_avec_OpenACC">Construire avec OpenACC</span></h4>
<p>Les compilateurs NVidia utilisent l'option <code>-acc</code> pour permettre la compilation pour un accélérateur. Nous utilisons la sous-option <code>-gpu=managed</code> pour indiquer au compilateur que nous voulons utiliser la <a rel="nofollow" class="external text" href="https://developer.nvidia.com/blog/unified-memory-cuda-beginners/">mémoire gérée</a>  pour simplifier le transfert de données en provenance et à destination du périphérique; nous n'utiliserons pas cette option dans un prochain exemple. Nous utilisons aussi l'option <code>-fast</code> pour l'optimisation.
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
...
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">30</span>,<span class="w"> </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>cols<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">          </span><span class="m">31</span>,<span class="w"> </span>Loop<span class="w"> </span>carried<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>ycoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>parallelization
<span class="w">              </span>Loop<span class="w"> </span>carried<span class="w"> </span>backward<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>ycoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>vectorization
<span class="w">              </span>Complex<span class="w"> </span>loop<span class="w"> </span>carried<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>Acoefs-&gt;,xcoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>parallelization
<span class="w">              </span>Generating<span class="w"> </span>NVIDIA<span class="w"> </span>GPU<span class="w"> </span>code
<span class="w">              </span><span class="m">31</span>,<span class="w"> </span><span class="c1">#pragma acc loop seq</span>
<span class="w">              </span><span class="m">35</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Generating<span class="w"> </span>implicit<span class="w"> </span>reduction<span class="o">(</span>+:sum<span class="o">)</span>
<span class="w">          </span><span class="m">35</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<p>Le résultat montre que la boucle externe sur la ligne 31 n'a pas pu être parallélisée par le compilateur. Dans la prochaine section, nous expliquons comment traiter ces dépendances.
</p>
<h2><span id="R.C3.A9parer_les_fausses_d.C3.A9pendances_de_boucles"></span><span class="mw-headline" id="Réparer_les_fausses_dépendances_de_boucles">Réparer les fausses dépendances de boucles</span></h2>
<p>Même lorsque le programmeur sait qu'une boucle peut être parallélisée, il arrive que le compilateur ne le remarque pas. Un cas commun en C/C++ est connu sous le nom de <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Pointer_aliasing"><i>pointer aliasing</i></a>. Contrairement au Fortran, C/C++ ne possèdent pas comme tel de tableaux (<i>arrays</i>), mais plutôt des pointeurs. Le concept d'alias s'applique à deux pointeurs dirigés vers la même mémoire. Si le compilateur ne sait pas que des pointeurs ne sont pas des alias, il doit cependant le supposer. Dans l'exemple précédent, on voit clairement pourquoi le compilateur ne pouvait pas paralléliser la boucle. En supposant que les pointeurs sont identiques, il y a forcément dépendance des itérations de la boucle. 
</p>
<h3><span id="Mot-cl.C3.A9_restrict"></span><span class="mw-headline" id="Mot-clé_restrict">Mot-clé <tt>restrict</tt></span></h3>
<p>Une des manières de dire au compilateur que les pointeurs <b>ne sont pas</b> des alias est d'utiliser  le mot-clé  <tt>restrict</tt>, introduit à cette fin dans C99.  Il n'y a toujours pas de manière standard pour ce faire en C++, mais chaque compilateur possède un mot-clé qui lui est propre. Dépendant du compilateur, on peut utiliser <tt>__restrict</tt> ou <tt>__restrict__</tt>. Les compilateurs du Portland Group et de NVidia utilisent <tt>__restrict</tt>. Pour savoir pourquoi il n'existe pas de standard en C++, consultez <a rel="nofollow" class="external text" href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3988.pdf">ce document</a>. Ce concept est important pour OpenACC comme pour toute programmation C/C++, car les compilateurs peuvent effectuer plusieurs autres optimisations si les pointeurs ne sont pas des alias. Remarquez que le mot-clé se place <b>après</b> le pointeur puisque c'est à ce dernier qu'il se réfère, et non au type; autrement dit, la déclaration doit se lire <code>float * __restrict A;</code> plutôt que <code>float __restrict * A;</code>. 
</p><p><br />
</p>
<div class="panel callout"><div class="panel-heading callout"><div class="panel-heading-icon callout"></div><div class="panel-heading-title">Utilisation du mot-clé <tt>restrict</tt></div></div>
<div class="panel-body callout">
<p>En déclarant un pointeur comme étant <i>restreint</i>, on s'assure qu'uniquement ce pointeur ou une valeur dérivée (comme <tt>ptr +1</tt>) pourra accéder à l'objet auquel il réfère, et ce pour la durée de vie du pointeur. Ceci est une garantie que le programmeur donne au compilateur;  si le programmeur manque à son obligation, le comportement n'est pas défini. Pour plus d'information, consultez l'article Wikipédia <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Fstab">restrict</a>.
</p>
</div></div>
<p><br />
</p><p><br />
</p>
<h3><span class="mw-headline" id="Boucle_avec_clause_independent">Boucle avec clause <tt>independent</tt></span></h3>
<p>Une autre façon de s'assurer que le compilateur traite les boucles de manière indépendante est de le spécifier explicitement  avec la clause <tt>independent</tt>. Comme toute autre directive <i>prescriptive</i>, le compilateur y est obligé et l'analyse qu'il pourrait faire ne sera pas considérée. En reprenant l'exemple de la section <i>La directive <tt>kernels</tt></i> ci-dessus, nous avons&#160;:  
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="hll"><span class="linenos" data-line="3"></span><span class="cp">#pragma acc loop independent</span>
</span><span class="linenos" data-line="4"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="5"></span><span class="p">{</span>
<span class="linenos" data-line="6"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="7"></span><span class="p">}</span>
<span class="linenos" data-line="8"></span><span class="p">}</span>
</pre></div> 
<h3><span class="mw-headline" id="Produit_matrice-vecteur">Produit matrice-vecteur</span></h3>
<p>Revenons au cas du produit matrice-vecteur présenté plus haut. Notre recommandation pour éviter les faux alias est de définir les pointeurs comme étant restreints en remplaçant le code de <tt>matrix_functions.h</tt>. 
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Acoefs</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">xcoefs</span><span class="o">=</span><span class="n">x</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ycoefs</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
</pre></div> 
<p>par le code 
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">Acoefs</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">xcoefs</span><span class="o">=</span><span class="n">x</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">ycoefs</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
</pre></div> 
<p>Remarquez que les autres pointeurs n'ont pas besoin d'être restreints puisque le compilateur ne les rapporte pas comme causant des problèmes. En recompilant avec les changements que nous venons de faire, le compilateur émet le message suivant&#160;: 
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">]</span>,cols<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">          </span><span class="m">30</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
<span class="w">              </span>Generating<span class="w"> </span>Tesla<span class="w"> </span>code
<span class="w">              </span><span class="m">30</span>,<span class="w"> </span><span class="c1">#pragma acc loop gang /* blockIdx.x */</span>
<span class="w">              </span><span class="m">34</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Generating<span class="w"> </span>implicit<span class="w"> </span>reduction<span class="o">(</span>+:sum<span class="o">)</span>
<span class="w">          </span><span class="m">34</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<h2><span id="Performance_du_code_port.C3.A9"></span><span class="mw-headline" id="Performance_du_code_porté">Performance du code porté</span></h2>
<p>Maintenant que le code est porté sur le GPU, nous pouvons analyser sa performance et vérifier si les résultats sont corrects. L'exécution du code original sur un nœud GPU produit ceci&#160;:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=.%2Fcg.x" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>./cg.x<span class="w"> </span>
Rows:<span class="w"> </span><span class="m">8120601</span>,<span class="w"> </span>nnz:<span class="w"> </span><span class="m">218535025</span>
Iteration:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.0067e+08
Iteration:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.8772e+07
Iteration:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">6</span>.4359e+05
Iteration:<span class="w"> </span><span class="m">30</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">2</span>.3202e+04
Iteration:<span class="w"> </span><span class="m">40</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">8</span>.3565e+02
Iteration:<span class="w"> </span><span class="m">50</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.0039e+01
Iteration:<span class="w"> </span><span class="m">60</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.0764e+00
Iteration:<span class="w"> </span><span class="m">70</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.8360e-02
Iteration:<span class="w"> </span><span class="m">80</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.3515e-03
Iteration:<span class="w"> </span><span class="m">90</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.6209e-05
Total<span class="w"> </span>Iterations:<span class="w"> </span><span class="m">100</span><span class="w"> </span>Total<span class="w"> </span>Time:<span class="w"> </span><span class="m">29</span>.894881s
</pre></div>
</div>
</div>
<p>Voici le résultat pour la version OpenACC&#160;:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=.%2Fchallenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>./challenge<span class="w"> </span>
Rows:<span class="w"> </span><span class="m">8120601</span>,<span class="w"> </span>nnz:<span class="w"> </span><span class="m">218535025</span>
Iteration:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.0067e+08
Iteration:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.8772e+07
Iteration:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">6</span>.4359e+05
Iteration:<span class="w"> </span><span class="m">30</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">2</span>.3202e+04
Iteration:<span class="w"> </span><span class="m">40</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">8</span>.3565e+02
Iteration:<span class="w"> </span><span class="m">50</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.0039e+01
Iteration:<span class="w"> </span><span class="m">60</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.0764e+00
Iteration:<span class="w"> </span><span class="m">70</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.8360e-02
Iteration:<span class="w"> </span><span class="m">80</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.3515e-03
Iteration:<span class="w"> </span><span class="m">90</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.6209e-05
Total<span class="w"> </span>Iterations:<span class="w"> </span><span class="m">100</span><span class="w"> </span>Total<span class="w"> </span>Time:<span class="w"> </span><span class="m">115</span>.068931s
</pre></div>
</div>
</div>
<figure class="mw-default-size" typeof="mw:File/Thumb"><a href="/wiki/File:Openacc_profiling1.png" class="mw-file-description"><img src="/mediawiki/images/thumb/3/36/Openacc_profiling1.png/300px-Openacc_profiling1.png" decoding="async" width="300" height="101" class="mw-file-element" srcset="/mediawiki/images/thumb/3/36/Openacc_profiling1.png/450px-Openacc_profiling1.png 1.5x, /mediawiki/images/thumb/3/36/Openacc_profiling1.png/600px-Openacc_profiling1.png 2x" /></a><figcaption>Cliquez pour agrandir.</figcaption></figure>
<p>Les résultats sont corrects,  toutefois, loin de gagner en vitesse, l'opération a pris près de quatre fois plus de temps! Utilisons le NVidia Visual Profiler (<tt>nvvp</tt>) pour voir ce qui se passe.
</p>
<h3><span class="mw-headline" id="NVIDIA_Visual_Profiler">NVIDIA Visual Profiler</span></h3>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Nvvp-pic0.png" class="mw-file-description"><img src="/mediawiki/images/thumb/6/66/Nvvp-pic0.png/300px-Nvvp-pic0.png" decoding="async" width="300" height="170" class="mw-file-element" srcset="/mediawiki/images/thumb/6/66/Nvvp-pic0.png/450px-Nvvp-pic0.png 1.5x, /mediawiki/images/thumb/6/66/Nvvp-pic0.png/600px-Nvvp-pic0.png 2x" /></a><figcaption>Profileur NVVP</figcaption></figure>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Nvvp-pic1.png" class="mw-file-description"><img src="/mediawiki/images/thumb/7/79/Nvvp-pic1.png/300px-Nvvp-pic1.png" decoding="async" width="300" height="170" class="mw-file-element" srcset="/mediawiki/images/thumb/7/79/Nvvp-pic1.png/450px-Nvvp-pic1.png 1.5x, /mediawiki/images/thumb/7/79/Nvvp-pic1.png/600px-Nvvp-pic1.png 2x" /></a><figcaption>Recherche de l'exécutable que vous voulez profiler</figcaption></figure>
<p><a rel="nofollow" class="external text" href="https://developer.nvidia.com/nvidia-visual-profiler">NVIDIA Visual Profiler (NVVP)</a> est un profileur graphique pour les applications OpenACC.
C'est un outil d'analyse pour les <b>codes écrits avec les directives OpenACC et CUDA C/C++</b>.
En conséquence, si l'exécutable n'utilise pas le GPU, ce profileur ne fournira aucun résultat.
</p><p>Quand <a href="/wiki/Visualization#Fenêtres_à_distance_avec_redirection_X11" title="Visualization">X11 est redirigé vers un serveur X-Server</a> ou quand vous utilisez un <a href="/wiki/VNC/fr" title="VNC/fr">environnement bureau Linux</a> (aussi via <a href="/wiki/JupyterHub/fr#Bureau" title="JupyterHub/fr">JupyterHub</a> avec 2 cœurs CPU, 5000M de mémoire et 1 GPU),
vous pouvez lancer NVVP à partir d'un terminal&#160;:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=module+load+cuda%2F11.7+java%2F1.8" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>cuda/11.7<span class="w"> </span>java/1.8
</pre></div>
</div>
</div>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvvp" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvvp
</pre></div>
</div>
</div>
<ol><li>Après l'affichage de la fenêtre de lancement de NVVP, vous devez entrer le répertoire <i>Workspace</i> qui sera employé pour les fichiers temporaires. Dans le chemin suggéré, remplacez <code>home</code> par <code>scratch</code> et cliquez sur <i>OK</i>.</li>
<li>Sélectionnez <i>File &gt; New Session</i> ou cliquez sur le bouton correspondant dans la barre d'outils.</li>
<li>Cliquez sur le bouton <i>Browse</i> à la droite du champ <i>File</i> pour le chemin.
<ol><li>Changez le répertoire s'il y a lieu.</li>
<li>Sélectionnez un exécutable construit avec des codes écrits avec des directives OpenACC et CUDA C/C++.</li></ol></li>
<li>Sous le champ <i>Arguments</i>, sélectionnez l'option <i>Profile current process only</i>.</li>
<li>Cliquez sur <i>Next &gt;</i> pour voir les autres options de profilage.</li>
<li>Cliquez sur <i>Finish</i> pour lancer le profilage de l'exécutable.</li></ol>
<p>Pour faire ceci, suivez ces étapes&#160;: 
</p>
<ol><li>Lancez <tt>nvvp</tt> avec la commande <tt>nvvp &amp;</tt>   (le symbole <tt>&amp;</tt> commande le lancement en arrière-plan).</li>
<li>Sélectionnez <i> File -&gt; New Session</i>.</li>
<li>Dans le champ <i>File:</i>, cherchez l'exécutable (nommé dans notre exemple <tt>challenge</tt>).</li>
<li>Cliquez sur <i>Next</i> jusqu'à ce que vous puissiez cliquer sur <i>Finish</i>.</li></ol>
<p>Le programme est exécuté et on obtient un tableau chronologique du déroulement (voir l'image). On remarque que le transfert de données entre le départ et l'arrivée occupe la plus grande partie du temps d'exécution, ce qui est fréquent quand du code est porté d'un CPU vers un GPU. Nous verrons comment ceci peut être amélioré dans la prochaine partie, <a href="/wiki/OpenACC_Tutorial_-_Data_movement/fr" title="OpenACC Tutorial - Data movement/fr">Mouvement des données</a>.
</p>
<h2><span class="mw-headline" id="La_directive_parallel_loop">La directive <tt>parallel loop</tt></span></h2>
<p>Avec la directive <tt>kernels</tt>, c'est le compilateur qui fait toute l'analyse; ceci est une approche <i>descriptive</i> pour porter du code. OpenACC offre aussi une approche <i>prescriptive</i> avec la directive <tt>parallel</tt> qui peut être combinée à la directive <tt>loop</tt> ainsi&#160;:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc parallel loop</span>
</span><span class="linenos" data-line="2"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="3"></span><span class="p">{</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="5"></span><span class="p">}</span>
</pre></div> 
<p>Comme <tt>parallel loop</tt> est une directive <i>prescriptive</i>, le compilateur est forcé d'exécuter la boucle en parallèle. Ceci signifie que la clause <tt>independent</tt> mentionnée plus haut est implicite à l'intérieur d'une zone parallèle. 
</p><p>Pour utiliser cette directive dans notre exemple du produit matrice-vecteur, nous avons besoin des clauses <tt>private</tt> et <tt>reduction</tt> pour gérer le flux des données dans la zone parallèle.   
</p>
<ul><li>Avec la clause <tt>private</tt>, une copie de la variable est faite pour chaque itération de la boucle; la valeur de la variable est ainsi indépendante des autres itérations.</li>
<li>Avec la clause <tt>reduction</tt>, les valeurs de la variable dans chaque itération est <i>réduite</i> à une valeur unique.  La clause s'utilise entre autres avec les opérations addition (+), multiplication (*), maximum (max) et minimum (min).</li></ul>
<p>Ces clauses ne sont pas nécessaires avec la directive <tt>kernels</tt> puisque celle-ci fait le travail pour vous. 
</p><p>Reprenons l'exemple de produit matrice-vecteur avec la directive <tt>parallel loop</tt>;
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="cp">#pragma acc parallel loop</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="4"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="hll"><span class="linenos" data-line="6"></span><span class="cp">#pragma acc loop reduction(+:sum)</span>
</span><span class="linenos" data-line="7"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="8"></span><span class="w">      </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="9"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="10"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="11"></span><span class="w">      </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="12"></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-line="13"></span><span class="w">    </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="14"></span><span class="w">  </span><span class="p">}</span>
</pre></div>
<p>La compilation produit le message suivant&#160;:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Accelerator<span class="w"> </span>kernel<span class="w"> </span>generated
<span class="w">              </span>Generating<span class="w"> </span>Tesla<span class="w"> </span>code
<span class="w">              </span><span class="m">29</span>,<span class="w"> </span><span class="c1">#pragma acc loop gang /* blockIdx.x */</span>
<span class="w">              </span><span class="m">34</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Sum<span class="w"> </span>reduction<span class="w"> </span>generated<span class="w"> </span><span class="k">for</span><span class="w"> </span>sum
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Generating<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span>
<span class="w">              </span>Generating<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">]</span>,cols<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">])</span>
<span class="w">          </span><span class="m">34</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<h2><span id="Diff.C3.A9rences_entre_parallel_loop_et_kernels"></span><span class="mw-headline" id="Différences_entre_parallel_loop_et_kernels">Différences entre <tt>parallel loop</tt> et <tt>kernels</tt></span></h2>
<table class="wikitable" width="100%">

<tbody><tr>
<th>PARALLEL LOOP</th>
<th>KERNELS
</th></tr>
<tr>
<td>
<ul><li>l'intégrité du code parallélisé revient au programmeur</li>
<li>le programmeur voit la parallélisation que le compilateur pourrait manquer</li>
<li>le fonctionnement est identique en OpenMP</li></ul>
</td>
<td>
<ul><li>la responsabilité d'analyser le code et de garantir son intégrité revient au compilateur</li>
<li>une seule directive peut s'appliquer à une grande portion de code</li>
<li>le compilateur est libre d'optimiser le code</li></ul>
</td></tr></tbody></table>
<p>Les deux approches sont valides et leur performance est comparable.
</p><p><br /> 
</p>
<div class="panel challenge"><div class="panel-heading challenge"><div class="panel-heading-icon challenge"></div><div class="panel-heading-title">Exercice&#160;: utiliser <tt>kernels</tt> ou <tt>parallel loop</tt></div></div>
<div class="panel-body challenge">
<ol><li>Modifiez les fonctions <tt>matvec</tt>, <tt>waxpby</tt> et <tt>dot</tt>. Vous pouvez utiliser soit <tt>kernels</tt>, soit <tt>parallel loop</tt>. La solution se trouve dans les répertoires <tt>step1. de <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc">Github</a> *</tt>.</li>
<li>Modifiez le Makefile en ajoutant <tt>-acc -gpu=managed</tt> et <tt>-Minfo=accel</tt> aux indicateurs pour le compilateur.</li></ol>
</div></div>
<p><br />
</p><p><a href="/wiki/OpenACC_Tutorial_-_Profiling/fr" title="OpenACC Tutorial - Profiling/fr">&lt;- Page précédente, Profileurs</a> | <a href="/wiki/OpenACC_Tutorial/fr" title="OpenACC Tutorial/fr">^- Retour au début du tutoriel</a> | <a href="/wiki/OpenACC_Tutorial_-_Data_movement/fr" title="OpenACC Tutorial - Data movement/fr">Page suivante, Mouvement des données -&gt;</a>
</p>
<!-- 
NewPP limit report
Cached time: 20250530235254
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.065 seconds
Real time usage: 0.067 seconds
Preprocessor visited node count: 366/1000000
Post‐expand include size: 9652/2097152 bytes
Template argument size: 9186/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 19/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 40584/5000000 bytes
ExtLoops count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.663      1 -total
 29.65%    1.383      7 Template:Command
 18.62%    0.868      1 Template:Objectives
 12.18%    0.568      4 Template:Panel
 10.89%    0.508      2 Template:Callout
  8.84%    0.412      1 Template:Challenge
-->

<!-- Saved in parser cache with key ccwiki:pcache:idhash:3228-0!canonical and timestamp 20250530235254 and revision id 138004. Rendering was triggered because: page-view
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;oldid=138004">https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;oldid=138004</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-login" class="mw-list-item"><a href="/mediawiki/index.php?title=Special:UserLogin&amp;returnto=OpenACC+Tutorial+-+Adding+directives%2Ffr" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li>
		</ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-namespaces-label"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/OpenACC_Tutorial_-_Adding_directives/fr" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="/mediawiki/index.php?title=Talk:OpenACC_Tutorial_-_Adding_directives/fr&amp;action=edit&amp;redlink=1" rel="discussion" class="new" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-variants-label"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	>
	<label
		id="p-variants-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">français</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-views-label"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected mw-list-item"><a href="/wiki/OpenACC_Tutorial_-_Adding_directives/fr"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-cactions-label"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<h3 >Search</h3>
	<form action="/mediawiki/index.php" id="searchform" class="vector-search-box-form">
		<div id="simpleSearch"
			class="vector-search-box-inner"
			 data-search-loc="header-navigation">
			<input class="vector-search-box-input"
				 type="search" name="search" placeholder="Search Alliance Doc" aria-label="Search Alliance Doc" autocapitalize="sentences" title="Search Alliance Doc [f]" accesskey="f" id="searchInput"
			>
			<input type="hidden" name="title" value="Special:Search">
			<input id="mw-searchButton"
				 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
			<input id="searchButton"
				 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel" class="vector-legacy-sidebar">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Technical_documentation"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu-portal portal vector-menu" aria-labelledby="p-navigation-label"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-wiki-main-page" class="mw-list-item"><a href="/wiki/Technical_documentation"><span>Wiki Main Page</span></a></li>
		</ul>
		
	</div>
</nav>

	
<nav id="p-sidebar-support" class="mw-portlet mw-portlet-sidebar-support vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-support-label"  >
	<h3
		id="p-sidebar-support-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Support</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-getting-started" class="mw-list-item"><a href="/wiki/Getting_started"><span>Getting started</span></a></li><li id="n-sidebar-technical-support" class="mw-list-item"><a href="/wiki/Technical_support"><span>Getting help</span></a></li><li id="n-sidebar-running-jobs" class="mw-list-item"><a href="/wiki/Running_jobs"><span>Running jobs</span></a></li><li id="n-sidebar-known-issues" class="mw-list-item"><a href="/wiki/Known_issues"><span>Known issues</span></a></li><li id="n-sidebar-system-status" class="mw-list-item"><a href="http://status.computecanada.ca" rel="nofollow"><span>System status</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-resources" class="mw-portlet mw-portlet-sidebar-resources vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-resources-label"  >
	<h3
		id="p-sidebar-resources-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Resources</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Béluga" class="mw-list-item"><a href="/wiki/B%C3%A9luga/en"><span>Béluga</span></a></li><li id="n-Cedar" class="mw-list-item"><a href="/wiki/Cedar"><span>Cedar</span></a></li><li id="n-Graham" class="mw-list-item"><a href="/wiki/Graham"><span>Graham</span></a></li><li id="n-Narval" class="mw-list-item"><a href="/wiki/Narval/en"><span>Narval</span></a></li><li id="n-Niagara" class="mw-list-item"><a href="/wiki/Niagara"><span>Niagara</span></a></li><li id="n-sidebar-cloud" class="mw-list-item"><a href="/wiki/CC-Cloud"><span>Cloud</span></a></li><li id="n-tamIA" class="mw-list-item"><a href="/wiki/TamIA/en"><span>tamIA</span></a></li><li id="n-Killarney" class="mw-list-item"><a href="/wiki/Killarney"><span>Killarney</span></a></li><li id="n-sidebar-quantum-computing" class="mw-list-item"><a href="/wiki/Services_d%27informatique_quantique/en"><span>Quantum computing</span></a></li><li id="n-sidebar-available-software" class="mw-list-item"><a href="/wiki/Available_software"><span>Available software</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-alliance" class="mw-portlet mw-portlet-sidebar-alliance vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-alliance-label"  >
	<h3
		id="p-sidebar-alliance-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">The Alliance</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-alliance-main-page" class="mw-list-item"><a href="https://alliancecan.ca/en" rel="nofollow"><span>Alliance main page</span></a></li><li id="n-sidebar-ccdb" class="mw-list-item"><a href="https://ccdb.computecanada.ca/security/login" rel="nofollow"><span>CCDB</span></a></li><li id="n-sidebar-getting-an-account" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/apply-account" rel="nofollow"><span>Getting An Account</span></a></li><li id="n-sidebar-acknowledging-alliance" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/research-portal/acknowledging-alliance" rel="nofollow"><span>Acknowledging the Alliance</span></a></li><li id="n-sidebar-aup" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/policies" rel="nofollow"><span>Acceptable Use Policy</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-authoring" class="mw-portlet mw-portlet-sidebar-authoring vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-authoring-label"  >
	<h3
		id="p-sidebar-authoring-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Authoring</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-guidelines" class="mw-list-item"><a href="/wiki/Authoring_guidelines"><span>Guidelines</span></a></li><li id="n-sidebar-mediawiki-help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu-portal portal vector-menu" aria-labelledby="p-tb-label"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/OpenACC_Tutorial_-_Adding_directives/fr" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/OpenACC_Tutorial_-_Adding_directives/fr" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;oldid=138004" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
		</ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 8 June 2023, at 19:37.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="/wiki/CCWiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/CCWiki:About">About Alliance Doc</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/CCWiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives/fr&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/mediawiki/resources/assets/poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.log.warn("This page is using the deprecated ResourceLoader module \"codex-search-styles\".\n[1.43] Use a CodexModule with codexComponents to set your specific components used: https://www.mediawiki.org/wiki/Codex#Using_a_limited_subset_of_components");});</script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-TVBPRD78K4" async=""></script><script>
window.dataLayer = window.dataLayer || [];

function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TVBPRD78K4', {});
</script>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":182,"wgPageParseReport":{"limitreport":{"cputime":"0.065","walltime":"0.067","ppvisitednodes":{"value":366,"limit":1000000},"postexpandincludesize":{"value":9652,"limit":2097152},"templateargumentsize":{"value":9186,"limit":2097152},"expansiondepth":{"value":6,"limit":100},"expensivefunctioncount":{"value":19,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":40584,"limit":5000000},"timingprofile":["100.00%    4.663      1 -total"," 29.65%    1.383      7 Template:Command"," 18.62%    0.868      1 Template:Objectives"," 12.18%    0.568      4 Template:Panel"," 10.89%    0.508      2 Template:Callout","  8.84%    0.412      1 Template:Challenge"]},"loops":{"limitreport-count-limited":{"value":0,"limit":100}},"cachereport":{"timestamp":"20250530235254","ttl":86400,"transientcontent":false}}});});</script>
</body>
</html>