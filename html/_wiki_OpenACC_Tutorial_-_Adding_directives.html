<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>OpenACC Tutorial - Adding directives - Alliance Doc</title>
<script>(function(){var className="client-js";var cookie=document.cookie.match(/(?:^|; )ccwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"aDpE1e3hIy4PhCb@BtLJYAAAAtA","wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"OpenACC_Tutorial_-_Adding_directives","wgTitle":"OpenACC Tutorial - Adding directives","wgCurRevisionId":137964,"wgRevisionId":137964,"wgArticleId":179,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":
["*"],"wgCategories":[],"wgPageViewLanguage":"en","wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"OpenACC_Tutorial_-_Adding_directives","wgRelevantArticleId":179,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgULSAcceptLanguageList":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"watchlist":false,"tagline":false},"wgCiteReferencePreviewsActive":true,"wgTranslatePageTranslation":"source","wgULSPosition":"personal","wgULSisCompactLinksEnabled":true,"wgVector2022LanguageInHeader":false,"wgULSisLanguageSelectorEmpty":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.translate.tag.languages":"ready","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.translate.edit.documentation.styles":"ready","ext.translate":"ready","codex-search-styles":"ready","ext.uls.pt":"ready"};RLPAGEMODULES=["ext.pygments.view",
"mediawiki.page.media","site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.languageSelector","ext.translate.pagetranslation.uls","ext.uls.compactlinks","ext.uls.geoclient","ext.uls.interface","ext.moderation.notify","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=codex-search-styles%7Cext.pygments%2Ctranslate%7Cext.translate.edit.documentation.styles%7Cext.translate.tag.languages%7Cext.uls.pt%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector">
<script async="" src="/mediawiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<link rel="icon" href="/mediawiki/resources/assets/Alliance_favicon.png">
<link rel="search" type="application/opensearchdescription+xml" href="/mediawiki/rest.php/v1/search" title="Alliance Doc (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://docs.alliancecan.ca/mediawiki/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="Alliance Doc Atom feed" href="/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector-legacy mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-OpenACC_Tutorial_-_Adding_directives rootpage-OpenACC_Tutorial_-_Adding_directives skin-vector action-view"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	<div id="mw-indicator-languageselector" class="mw-indicator"><span id="languageselector-box-1" class="languageselector " style=""><form name="languageselector-form-1" id="languageselector-form-1" method="get" action="/mediawiki/index.php" style="display:inline;"><input type="hidden" value="OpenACC_Tutorial_-_Adding_directives" name="title"><select name="setlang" id="languageselector-select-1" style=""><option value="aae">Arbërisht</option><option value="ab">аԥсшәа</option><option value="abs">bahasa ambon</option><option value="ace">Acèh</option><option value="acf">Kwéyòl Sent Lisi</option><option value="acm">عراقي</option><option value="ady">адыгабзэ</option><option value="ady-cyrl">адыгабзэ</option><option value="aeb">تونسي / Tûnsî</option><option value="aeb-arab">تونسي</option><option value="aeb-latn">Tûnsî</option><option value="af">Afrikaans</option><option value="aln">Gegë</option><option value="alt">алтай тил</option><option value="am">አማርኛ</option><option value="ami">Pangcah</option><option value="an">aragonés</option><option value="ang">Ænglisc</option><option value="ann">Obolo</option><option value="anp">अंगिका</option><option value="apc">شامي</option><option value="ar">العربية</option><option value="arc">ܐܪܡܝܐ</option><option value="arn">mapudungun</option><option value="arq">جازايرية</option><option value="ary">الدارجة</option><option value="arz">مصرى</option><option value="as">অসমীয়া</option><option value="ase">American sign language</option><option value="ast">asturianu</option><option value="atj">Atikamekw</option><option value="av">авар</option><option value="avk">Kotava</option><option value="awa">अवधी</option><option value="ay">Aymar aru</option><option value="az">azərbaycanca</option><option value="azb">تۆرکجه</option><option value="ba">башҡортса</option><option value="ban">Basa Bali</option><option value="ban-bali">ᬩᬲᬩᬮᬶ</option><option value="bar">Boarisch</option><option value="bbc">Batak Toba</option><option value="bbc-latn">Batak Toba</option><option value="bcc">جهلسری بلوچی</option><option value="bci">wawle</option><option value="bcl">Bikol Central</option><option value="bdr">Bajau Sama</option><option value="be">беларуская</option><option value="be-tarask">беларуская (тарашкевіца)</option><option value="bew">Betawi</option><option value="bg">български</option><option value="bgc">हरियाणवी</option><option value="bgn">روچ کپتین بلوچی</option><option value="bh">भोजपुरी</option><option value="bho">भोजपुरी</option><option value="bi">Bislama</option><option value="bjn">Banjar</option><option value="blk">ပအိုဝ်ႏဘာႏသာႏ</option><option value="bm">bamanankan</option><option value="bn">বাংলা</option><option value="bo">བོད་ཡིག</option><option value="bpy">বিষ্ণুপ্রিয়া মণিপুরী</option><option value="bqi">بختیاری</option><option value="br">brezhoneg</option><option value="brh">Bráhuí</option><option value="bs">bosanski</option><option value="btm">Batak Mandailing</option><option value="bto">Iriga Bicolano</option><option value="bug">Basa Ugi</option><option value="bxr">буряад</option><option value="ca">català</option><option value="cbk-zam">Chavacano de Zamboanga</option><option value="ccp">𑄌𑄋𑄴𑄟𑄳𑄦</option><option value="cdo">閩東語 / Mìng-dĕ̤ng-ngṳ̄</option><option value="ce">нохчийн</option><option value="ceb">Cebuano</option><option value="ch">Chamoru</option><option value="chn">chinuk wawa</option><option value="chr">ᏣᎳᎩ</option><option value="chy">Tsetsêhestâhese</option><option value="ckb">کوردی</option><option value="co">corsu</option><option value="cps">Capiceño</option><option value="cpx">莆仙語 / Pó-sing-gṳ̂</option><option value="cpx-hans">莆仙语（简体）</option><option value="cpx-hant">莆仙語（繁體）</option><option value="cr">Nēhiyawēwin / ᓀᐦᐃᔭᐍᐏᐣ</option><option value="crh">qırımtatarca</option><option value="crh-cyrl">къырымтатарджа (Кирилл)</option><option value="crh-latn">qırımtatarca (Latin)</option><option value="crh-ro">tatarşa</option><option value="cs">čeština</option><option value="csb">kaszëbsczi</option><option value="cu">словѣньскъ / ⰔⰎⰑⰂⰡⰐⰠⰔⰍⰟ</option><option value="cv">чӑвашла</option><option value="cy">Cymraeg</option><option value="da">dansk</option><option value="dag">dagbanli</option><option value="de">Deutsch</option><option value="de-at">Österreichisches Deutsch</option><option value="de-ch">Schweizer Hochdeutsch</option><option value="de-formal">Deutsch (Sie-Form)</option><option value="dga">Dagaare</option><option value="din">Thuɔŋjäŋ</option><option value="diq">Zazaki</option><option value="dsb">dolnoserbski</option><option value="dtp">Kadazandusun</option><option value="dty">डोटेली</option><option value="dua">Duálá</option><option value="dv">ދިވެހިބަސް</option><option value="dz">ཇོང་ཁ</option><option value="ee">eʋegbe</option><option value="efi">Efịk</option><option value="egl">emiliàn e rumagnòl</option><option value="el">Ελληνικά</option><option value="eml">emiliàn e rumagnòl</option><option value="en" selected="">English</option><option value="en-ca">Canadian English</option><option value="en-gb">British English</option><option value="eo">Esperanto</option><option value="es">español</option><option value="es-formal">español (formal)</option><option value="et">eesti</option><option value="eu">euskara</option><option value="ext">estremeñu</option><option value="fa">فارسی</option><option value="fat">mfantse</option><option value="ff">Fulfulde</option><option value="fi">suomi</option><option value="fit">meänkieli</option><option value="fj">Na Vosa Vakaviti</option><option value="fo">føroyskt</option><option value="fon">fɔ̀ngbè</option><option value="fr">français</option><option value="frc">français cadien</option><option value="frp">arpetan</option><option value="frr">Nordfriisk</option><option value="fur">furlan</option><option value="fy">Frysk</option><option value="ga">Gaeilge</option><option value="gaa">Ga</option><option value="gag">Gagauz</option><option value="gan">贛語</option><option value="gan-hans">赣语（简体）</option><option value="gan-hant">贛語（繁體）</option><option value="gcf">kréyòl Gwadloup</option><option value="gcr">kriyòl gwiyannen</option><option value="gd">Gàidhlig</option><option value="gl">galego</option><option value="gld">на̄ни</option><option value="glk">گیلکی</option><option value="gn">Avañe'ẽ</option><option value="gom">गोंयची कोंकणी / Gõychi Konknni</option><option value="gom-deva">गोंयची कोंकणी</option><option value="gom-latn">Gõychi Konknni</option><option value="gor">Bahasa Hulontalo</option><option value="got">𐌲𐌿𐍄𐌹𐍃𐌺</option><option value="gpe">Ghanaian Pidgin</option><option value="grc">Ἀρχαία ἑλληνικὴ</option><option value="gsw">Alemannisch</option><option value="gu">ગુજરાતી</option><option value="guc">wayuunaiki</option><option value="gur">farefare</option><option value="guw">gungbe</option><option value="gv">Gaelg</option><option value="ha">Hausa</option><option value="hak">客家語 / Hak-kâ-ngî</option><option value="haw">Hawaiʻi</option><option value="he">עברית</option><option value="hi">हिन्दी</option><option value="hif">Fiji Hindi</option><option value="hif-latn">Fiji Hindi</option><option value="hil">Ilonggo</option><option value="hno">ہندکو</option><option value="hr">hrvatski</option><option value="hrx">Hunsrik</option><option value="hsb">hornjoserbsce</option><option value="hsn">湘語</option><option value="ht">Kreyòl ayisyen</option><option value="hu">magyar</option><option value="hu-formal">magyar (formal)</option><option value="hy">հայերեն</option><option value="hyw">Արեւմտահայերէն</option><option value="ia">interlingua</option><option value="iba">Jaku Iban</option><option value="ibb">ibibio</option><option value="id">Bahasa Indonesia</option><option value="ie">Interlingue</option><option value="ig">Igbo</option><option value="igl">Igala</option><option value="ii">ꆇꉙ</option><option value="ik">Iñupiatun</option><option value="ike-cans">ᐃᓄᒃᑎᑐᑦ</option><option value="ike-latn">inuktitut</option><option value="ilo">Ilokano</option><option value="inh">гӀалгӀай</option><option value="io">Ido</option><option value="is">íslenska</option><option value="isv-cyrl">меджусловјанскы</option><option value="isv-latn">medžuslovjansky</option><option value="it">italiano</option><option value="iu">ᐃᓄᒃᑎᑐᑦ / inuktitut</option><option value="ja">日本語</option><option value="jam">Patois</option><option value="jbo">la .lojban.</option><option value="jut">jysk</option><option value="jv">Jawa</option><option value="ka">ქართული</option><option value="kaa">Qaraqalpaqsha</option><option value="kab">Taqbaylit</option><option value="kai">Karai-karai</option><option value="kbd">адыгэбзэ</option><option value="kbd-cyrl">адыгэбзэ</option><option value="kbp">Kabɩyɛ</option><option value="kcg">Tyap</option><option value="kea">kabuverdianu</option><option value="kg">Kongo</option><option value="kge">Kumoring</option><option value="khw">کھوار</option><option value="ki">Gĩkũyũ</option><option value="kiu">Kırmancki</option><option value="kjh">хакас</option><option value="kjp">ဖၠုံလိက်</option><option value="kk">қазақша</option><option value="kk-arab">قازاقشا (تٴوتە)</option><option value="kk-cn">قازاقشا (جۇنگو)</option><option value="kk-cyrl">қазақша (кирил)</option><option value="kk-kz">қазақша (Қазақстан)</option><option value="kk-latn">qazaqşa (latın)</option><option value="kk-tr">qazaqşa (Türkïya)</option><option value="kl">kalaallisut</option><option value="km">ភាសាខ្មែរ</option><option value="kn">ಕನ್ನಡ</option><option value="knc">Yerwa Kanuri</option><option value="ko">한국어</option><option value="ko-kp">조선말</option><option value="koi">перем коми</option><option value="kr">kanuri</option><option value="krc">къарачай-малкъар</option><option value="kri">Krio</option><option value="krj">Kinaray-a</option><option value="krl">karjal</option><option value="ks">कॉशुर / کٲشُر</option><option value="ks-arab">کٲشُر</option><option value="ks-deva">कॉशुर</option><option value="ksh">Ripoarisch</option><option value="ksw">စှီၤ</option><option value="ku">kurdî</option><option value="ku-arab">کوردی (عەرەبی)</option><option value="ku-latn">kurdî (latînî)</option><option value="kum">къумукъ</option><option value="kus">Kʋsaal</option><option value="kv">коми</option><option value="kw">kernowek</option><option value="ky">кыргызча</option><option value="la">Latina</option><option value="lad">Ladino</option><option value="lb">Lëtzebuergesch</option><option value="lbe">лакку</option><option value="lez">лезги</option><option value="lfn">Lingua Franca Nova</option><option value="lg">Luganda</option><option value="li">Limburgs</option><option value="lij">Ligure</option><option value="liv">Līvõ kēļ</option><option value="lki">لەکی</option><option value="lld">Ladin</option><option value="lmo">lombard</option><option value="ln">lingála</option><option value="lo">ລາວ</option><option value="loz">Silozi</option><option value="lrc">لۊری شومالی</option><option value="lt">lietuvių</option><option value="ltg">latgaļu</option><option value="lua">ciluba</option><option value="lus">Mizo ţawng</option><option value="luz">لئری دوٙمینی</option><option value="lv">latviešu</option><option value="lzh">文言</option><option value="lzz">Lazuri</option><option value="mad">Madhurâ</option><option value="mag">मगही</option><option value="mai">मैथिली</option><option value="map-bms">Basa Banyumasan</option><option value="mdf">мокшень</option><option value="mg">Malagasy</option><option value="mhr">олык марий</option><option value="mi">Māori</option><option value="min">Minangkabau</option><option value="mk">македонски</option><option value="ml">മലയാളം</option><option value="mn">монгол</option><option value="mnc">manju gisun</option><option value="mnc-latn">manju gisun</option><option value="mnc-mong">ᠮᠠᠨᠵᡠ ᡤᡳᠰᡠᠨ</option><option value="mni">ꯃꯤꯇꯩ ꯂꯣꯟ</option><option value="mnw">ဘာသာမန်</option><option value="mo">молдовеняскэ</option><option value="mos">moore</option><option value="mr">मराठी</option><option value="mrh">Mara</option><option value="mrj">кырык мары</option><option value="ms">Bahasa Melayu</option><option value="ms-arab">بهاس ملايو</option><option value="mt">Malti</option><option value="mui">Baso Palembang</option><option value="mwl">Mirandés</option><option value="my">မြန်မာဘာသာ</option><option value="myv">эрзянь</option><option value="mzn">مازِرونی</option><option value="na">Dorerin Naoero</option><option value="nah">Nāhuatl</option><option value="nan">閩南語 / Bân-lâm-gú</option><option value="nan-hant">閩南語（傳統漢字）</option><option value="nan-latn-pehoeji">Bân-lâm-gú (Pe̍h-ōe-jī)</option><option value="nan-latn-tailo">Bân-lâm-gú (Tâi-lô)</option><option value="nap">Napulitano</option><option value="nb">norsk bokmål</option><option value="nds">Plattdüütsch</option><option value="nds-nl">Nedersaksies</option><option value="ne">नेपाली</option><option value="new">नेपाल भाषा</option><option value="nia">Li Niha</option><option value="nit">కొలామి</option><option value="niu">Niuē</option><option value="nl">Nederlands</option><option value="nl-informal">Nederlands (informeel)</option><option value="nmz">nawdm</option><option value="nn">norsk nynorsk</option><option value="nod">ᨣᩤᩴᨾᩮᩬᩥᨦ</option><option value="nog">ногайша</option><option value="nov">Novial</option><option value="nqo">ߒߞߏ</option><option value="nr">isiNdebele seSewula</option><option value="nrm">Nouormand</option><option value="nso">Sesotho sa Leboa</option><option value="nup">Nupe</option><option value="nv">Diné bizaad</option><option value="ny">Chi-Chewa</option><option value="nyn">runyankore</option><option value="nyo">Orunyoro</option><option value="nys">Nyunga</option><option value="oc">occitan</option><option value="ojb">Ojibwemowin</option><option value="olo">livvinkarjala</option><option value="om">Oromoo</option><option value="or">ଓଡ଼ିଆ</option><option value="os">ирон</option><option value="pa">ਪੰਜਾਬੀ</option><option value="pag">Pangasinan</option><option value="pam">Kapampangan</option><option value="pap">Papiamentu</option><option value="pcd">Picard</option><option value="pcm">Naijá</option><option value="pdc">Deitsch</option><option value="pdt">Plautdietsch</option><option value="pfl">Pälzisch</option><option value="pi">पालि</option><option value="pih">Norfuk / Pitkern</option><option value="pl">polski</option><option value="pms">Piemontèis</option><option value="pnb">پنجابی</option><option value="pnt">Ποντιακά</option><option value="prg">prūsiskan</option><option value="ps">پښتو</option><option value="pt">português</option><option value="pt-br">português do Brasil</option><option value="pwn">pinayuanan</option><option value="qqq">Message documentation</option><option value="qu">Runa Simi</option><option value="qug">Runa shimi</option><option value="rgn">Rumagnôl</option><option value="rif">Tarifit</option><option value="rki">ရခိုင်</option><option value="rm">rumantsch</option><option value="rmc">romaňi čhib</option><option value="rmy">romani čhib</option><option value="rn">ikirundi</option><option value="ro">română</option><option value="roa-tara">tarandíne</option><option value="rsk">руски</option><option value="ru">русский</option><option value="rue">русиньскый</option><option value="rup">armãneashti</option><option value="ruq">Vlăheşte</option><option value="ruq-cyrl">Влахесте</option><option value="ruq-latn">Vlăheşte</option><option value="rut">мыхаӀбишды</option><option value="rw">Ikinyarwanda</option><option value="ryu">うちなーぐち</option><option value="sa">संस्कृतम्</option><option value="sah">саха тыла</option><option value="sat">ᱥᱟᱱᱛᱟᱲᱤ</option><option value="sc">sardu</option><option value="scn">sicilianu</option><option value="sco">Scots</option><option value="sd">سنڌي</option><option value="sdc">Sassaresu</option><option value="sdh">کوردی خوارگ</option><option value="se">davvisámegiella</option><option value="se-fi">davvisámegiella (Suoma bealde)</option><option value="se-no">davvisámegiella (Norgga bealde)</option><option value="se-se">davvisámegiella (Ruoŧa bealde)</option><option value="sei">Cmique Itom</option><option value="ses">Koyraboro Senni</option><option value="sg">Sängö</option><option value="sgs">žemaitėška</option><option value="sh">srpskohrvatski / српскохрватски</option><option value="sh-cyrl">српскохрватски (ћирилица)</option><option value="sh-latn">srpskohrvatski (latinica)</option><option value="shi">Taclḥit</option><option value="shn">ၽႃႇသႃႇတႆး </option><option value="shy">tacawit</option><option value="shy-latn">tacawit</option><option value="si">සිංහල</option><option value="sjd">кӣллт са̄мь кӣлл</option><option value="sje">bidumsámegiella</option><option value="sk">slovenčina</option><option value="skr">سرائیکی</option><option value="skr-arab">سرائیکی</option><option value="sl">slovenščina</option><option value="sli">Schläsch</option><option value="sm">Gagana Samoa</option><option value="sma">åarjelsaemien</option><option value="smn">anarâškielâ</option><option value="sms">nuõrttsääʹmǩiõll</option><option value="sn">chiShona</option><option value="so">Soomaaliga</option><option value="sq">shqip</option><option value="sr">српски / srpski</option><option value="sr-ec">српски (ћирилица)</option><option value="sr-el">srpski (latinica)</option><option value="srn">Sranantongo</option><option value="sro">sardu campidanesu</option><option value="ss">SiSwati</option><option value="st">Sesotho</option><option value="stq">Seeltersk</option><option value="sty">себертатар</option><option value="su">Sunda</option><option value="sv">svenska</option><option value="sw">Kiswahili</option><option value="syl">ꠍꠤꠟꠐꠤ</option><option value="szl">ślůnski</option><option value="szy">Sakizaya</option><option value="ta">தமிழ்</option><option value="tay">Tayal</option><option value="tcy">ತುಳು</option><option value="tdd">ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ</option><option value="te">తెలుగు</option><option value="tet">tetun</option><option value="tg">тоҷикӣ</option><option value="tg-cyrl">тоҷикӣ</option><option value="tg-latn">tojikī</option><option value="th">ไทย</option><option value="ti">ትግርኛ</option><option value="tig">ትግሬ</option><option value="tk">Türkmençe</option><option value="tl">Tagalog</option><option value="tly">tolışi</option><option value="tn">Setswana</option><option value="to">lea faka-Tonga</option><option value="tok">toki pona</option><option value="tpi">Tok Pisin</option><option value="tr">Türkçe</option><option value="tru">Ṫuroyo</option><option value="trv">Seediq</option><option value="ts">Xitsonga</option><option value="tt">татарча / tatarça</option><option value="tt-cyrl">татарча</option><option value="tt-latn">tatarça</option><option value="ttj">Orutooro</option><option value="tum">chiTumbuka</option><option value="tw">Twi</option><option value="ty">reo tahiti</option><option value="tyv">тыва дыл</option><option value="tzm">ⵜⴰⵎⴰⵣⵉⵖⵜ</option><option value="udm">удмурт</option><option value="ug">ئۇيغۇرچە / Uyghurche</option><option value="ug-arab">ئۇيغۇرچە</option><option value="ug-latn">Uyghurche</option><option value="uk">українська</option><option value="ur">اردو</option><option value="uz">oʻzbekcha / ўзбекча</option><option value="ve">Tshivenda</option><option value="vec">vèneto</option><option value="vep">vepsän kel’</option><option value="vi">Tiếng Việt</option><option value="vls">West-Vlams</option><option value="vmf">Mainfränkisch</option><option value="vmw">emakhuwa</option><option value="vo">Volapük</option><option value="vot">Vaďďa</option><option value="vro">võro</option><option value="wa">walon</option><option value="wal">wolaytta</option><option value="war">Winaray</option><option value="wls">Fakaʻuvea</option><option value="wo">Wolof</option><option value="wuu">吴语</option><option value="wuu-hans">吴语（简体）</option><option value="wuu-hant">吳語（正體）</option><option value="xal">хальмг</option><option value="xh">isiXhosa</option><option value="xmf">მარგალური</option><option value="xsy">saisiyat</option><option value="yi">ייִדיש</option><option value="yo">Yorùbá</option><option value="yrl">Nhẽẽgatú</option><option value="yue">粵語</option><option value="yue-hans">粵语（简体）</option><option value="yue-hant">粵語（繁體）</option><option value="za">Vahcuengh</option><option value="zea">Zeêuws</option><option value="zgh">ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ</option><option value="zh">中文</option><option value="zh-cn">中文（中国大陆）</option><option value="zh-hans">中文（简体）</option><option value="zh-hant">中文（繁體）</option><option value="zh-hk">中文（香港）</option><option value="zh-mo">中文（澳門）</option><option value="zh-my">中文（马来西亚）</option><option value="zh-sg">中文（新加坡）</option><option value="zh-tw">中文（臺灣）</option><option value="zu">isiZulu</option></select><input id="languageselector-commit-1" style="" type="submit" value="set"></form></span></div>
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">OpenACC Tutorial - Adding directives</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Alliance Doc</div>
		<div id="contentSub"><div id="mw-content-subtitle"></div></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="en" dir="ltr">English</span></li>
<li><a href="/wiki/OpenACC_Tutorial_-_Adding_directives/fr" class="mw-pt-progress mw-pt-progress--complete" title="Tutoriel OpenACC : Ajouter des directives (100% translated)" lang="fr" dir="ltr">français</a></li></ul></div>
<p><br />
</p>
<div class="panel objectives"><div class="panel-heading objectives"><div class="panel-heading-icon objectives"></div><div class="panel-heading-title">Learning objectives</div></div>
<div class="panel-body objectives">
<ul><li>Understand the process of <i>offloading</i></li>
<li>Understand what is an OpenACC directive</li>
<li>Understand what is the difference between the <tt>loop</tt> and <tt>kernels</tt> directive</li>
<li>Understand how to build a program with OpenACC</li>
<li>Understand what <i>aliasing</i> is in C/C++</li>
<li>Learn how to use compiler feedback and how fix false aliasing</li></ul>
</div></div>
<p><br />
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Offloading_to_a_GPU"><span class="tocnumber">1</span> <span class="toctext">Offloading to a GPU</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#OpenACC_directives"><span class="tocnumber">2</span> <span class="toctext">OpenACC directives</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Loops_vs_Kernels"><span class="tocnumber">2.1</span> <span class="toctext">Loops vs Kernels</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#The_kernels_directive"><span class="tocnumber">3</span> <span class="toctext">The kernels directive</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Example:_porting_a_matrix-vector_product"><span class="tocnumber">3.1</span> <span class="toctext">Example: porting a matrix-vector product</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Building_with_OpenACC"><span class="tocnumber">3.1.1</span> <span class="toctext">Building with OpenACC</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Fixing_false_loop_dependencies"><span class="tocnumber">4</span> <span class="toctext">Fixing false loop dependencies</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#restrict_keyword"><span class="tocnumber">4.1</span> <span class="toctext">restrict keyword</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Loop_directive_with_independent_clause"><span class="tocnumber">4.2</span> <span class="toctext">Loop directive with independent clause</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Back_to_the_example"><span class="tocnumber">4.3</span> <span class="toctext">Back to the example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#How_is_ported_code_performing_?"><span class="tocnumber">5</span> <span class="toctext">How is ported code performing&#160;?</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#NVIDIA_Visual_Profiler"><span class="tocnumber">5.1</span> <span class="toctext">NVIDIA Visual Profiler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#The_parallel_loop_directive"><span class="tocnumber">6</span> <span class="toctext">The parallel loop directive</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Parallel_loop_vs_kernel"><span class="tocnumber">7</span> <span class="toctext">Parallel loop vs kernel</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Offloading_to_a_GPU">Offloading to a GPU</span></h2>
<p>The first thing to realize when trying to port a code to a GPU is that both the CPU located in the host and the GPU do not share the same memory:
</p>
<ul><li>The host memory is generally larger, but slower than the GPU memory;</li>
<li>A GPU does not have direct access to the host memory;</li>
<li>To use a GPU, data must therefore be transferred from the main program to the GPU through the PCI bus, which has a much lower bandwidth than either memories.</li></ul>
<p>This means that managing data transfers between the host and the GPU will be of paramount importance. Transferring the data and the code onto the device is called <i>offloading</i>.
</p>
<h2><span class="mw-headline" id="OpenACC_directives">OpenACC directives</span></h2>
<p>OpenACC directives are much like <a href="/wiki/OpenMP" title="OpenMP">OpenMP</a> directives.
They take the form of <tt>pragma</tt> statements in C/C++, and comments in Fortran.
There are several advantages to using directives:
</p>
<ul><li>First, since it involves very minor modifications to the code, changes can be done <i>incrementally</i>, one <tt>pragma</tt> at a time. This is especially useful for debugging purpose, since making a single change at a time allows one to quickly identify which change created a bug.</li>
<li>Second, OpenACC support can be disabled at compile time. When OpenACC support is disabled, the <tt>pragma</tt> are considered comments, and ignored by the compiler. This means that a single source code can be used to compile both an accelerated version and a normal version.</li>
<li>Third, since all of the offloading work is done by the compiler, the same code can be compiled for various accelerator types: GPUs or SIMD instructions on CPUs. It also means that a new generation of devices only requires one to update the compiler, not to change the code.</li></ul>
<p>In the following example, we take a code comprised of two loops.
The first one initializes two vectors, and the second performs a <tt><a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms#Level_1">SAXPY</a></tt>, a basic vector addition operation. 
</p>
<table class="wikitable" width="100%">

<tbody><tr>
<th>C/C++</th>
<th>FORTRAN
</th></tr>
<tr>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="2"></span><span class="p">{</span>
</span><span class="linenos" data-line="3"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos" data-line="6"></span><span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="linenos" data-line="7"></span><span class="w">  </span><span class="p">}</span>
<span class="linenos" data-line="8"></span>
<span class="linenos" data-line="9"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="10"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="11"></span><span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="12"></span><span class="w">  </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="13"></span><span class="p">}</span>
</span></pre></div></td>
<td><div class="mw-highlight mw-highlight-lang-fortran mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="c">!$acc kernels</span>
</span><span class="linenos" data-line="2"></span><span class="w">  </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span>
<span class="linenos" data-line="3"></span><span class="w">    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos" data-line="4"></span><span class="w">    </span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos" data-line="5"></span><span class="w">  </span><span class="k">end do</span>
<span class="linenos" data-line="6"></span><span class="k">  </span>
<span class="hll"><span class="linenos" data-line="7"></span><span class="k">  </span><span class="n">y</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">(:)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">(:)</span>
</span><span class="linenos" data-line="8"></span><span class="c">!$acc end kernels</span>
</pre></div>
</td></tr></tbody></table>
<p>Both in the C/C++ and the Fortran cases, the compiler will identify <b>two</b> kernels:
</p>
<ul><li>In C/C++, the two kernels will correspond to the inside of each loops.</li>
<li>In Fortran, the kernels will be the inside of the first loop, as well as the inside of the implicit loop that Fortran performs when it does an array operation.</li></ul>
<p>Note that in C/C++, the OpenACC block is delimited using curly brackets,
while in Fortran, the same comment needs to be repeated, with the <tt>end</tt> keyword added.
</p>
<h3><span class="mw-headline" id="Loops_vs_Kernels">Loops vs Kernels</span></h3>
<p>When the compiler reaches an OpenACC <tt>kernels</tt> directive, it will analyze the code in order to identify sections that can be parallelized.
This often corresponds to the body of a loop that has independent iterations.
When such a case is identified, the compiler will first wrap the body of the loop into a special function called a <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Compute_kernel"><i>kernel</i></a>.
This internal code refactoring makes sure that each call to the kernel is independent from any other call.
The kernel is then compiled to enable it to run on an accelerator.
Since each call is independent, each one of the hundreds of cores of the accelerator can run the function for one specific index in parallel.
</p>
<table class="wikitable" width="100%">

<tbody><tr>
<th>LOOP</th>
<th>KERNEL
</th></tr>
<tr>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="4"></span><span class="p">}</span>
</pre></div></td>
<td><div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="kt">void</span><span class="w"> </span><span class="nf">kernelName</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="4"></span><span class="p">}</span>
</pre></div>
</td></tr>
<tr>
<td>Calculates sequentially from index <tt>i=0</tt> to <tt>i=N-1</tt>, inclusive.</td>
<td>Each compute core calculates for one value of <tt>i</tt>.
</td></tr></tbody></table>
<h2><span class="mw-headline" id="The_kernels_directive">The <code>kernels</code> directive</span></h2>
<p>The <code>kernels</code> directive is what we call a <i>descriptive</i> directive.
It is used to tell the compiler that the programmer <i>thinks</i> this region can be made parallel.
At this point, the compiler is free to do whatever it wants with this information.
It can use whichever strategy it thinks is best to run the code, <i>including</i> running it sequentially.
Typically, it will:
</p>
<ol><li>Analyze the code in order to identify any parallelism</li>
<li>If found, identify which data must be transferred and when</li>
<li>Create a kernel</li>
<li>Offload the kernel to the GPU</li></ol>
<p>One example of this directive is the following code:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="2"></span><span class="p">{</span>
</span><span class="linenos" data-line="3"></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="6"></span><span class="w">  </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="7"></span><span class="p">}</span>
</span></pre></div> 
<p>The above example is very simple. However, code is often not that simple,
and we then need to rely on <a href="/wiki/OpenACC_Tutorial_-_Profiling#Compiler_Feedback" title="OpenACC Tutorial - Profiling">compiler feedback</a>
in order to identify regions it failed to parallelize. 
</p><p><br />
</p>
<div class="panel callout"><div class="panel-heading callout"><div class="panel-heading-icon callout"></div><div class="panel-heading-title">Descriptive vs prescriptive</div></div>
<div class="panel-body callout">
<p>Those who have used <a href="/wiki/OpenMP" title="OpenMP">OpenMP</a> before will be familiar with the directive based nature of OpenACC.
There is however one major difference between OpenMP and OpenACC directives:
</p>
<ul><li>OpenMP directives are by design <i>prescriptive</i> in nature. This means that the compiler is required to perform the requested parallelization, no matter whether this is good from a performance stand point or not. This yields very reproducible results from one compiler to the next. This also means that parallelization will be performed the same way, whatever the hardware the code runs on. However, not every architecture performs best with code written the same way. Sometimes, it may be beneficial to switch the order of loops for example. If one were to parallelize a code with OpenMP and wanted it to perform optimally on multiple different architectures, they would have to write different sets of directives for different architectures.</li></ul>
<ul><li>In contrast, many of OpenACC's directives are <i>descriptive</i> in nature. This means that the compiler is free to compile the code whichever way it thinks is best for the target architecture. This may even imply that the code is not parallelized at all. The <b>same code</b>, compiled to run on GPU or on CPU may therefore yield different binary code. This, of course, means that different compilers may yield different performance. It also means that new generations of compilers will do better than previous generations, especially with new hardware.</li></ul>
</div></div>
<p><br />
</p>
<h3><span class="mw-headline" id="Example:_porting_a_matrix-vector_product">Example: porting a matrix-vector product</span></h3>
<p>For this example, we use the code from the <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc">exercises repository</a>.
More precisely, we will use a portion of the code from the <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/cpp/matrix_functions.h#L20"><code>cpp/matrix_functions.h</code> file</a>.
The equivalent Fortran code can be found in the subroutine <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/f90/matrix.F90#L101"><code>matvec</code> contained in the <code>matrix.F90</code> file</a>.
The C++ code is the following:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="29"></span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="30"></span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="31"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="32"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="linenos" data-line="33"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="34"></span><span class="w">      </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="35"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="36"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="37"></span><span class="w">      </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="38"></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-line="39"></span><span class="w">    </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="40"></span><span class="w">  </span><span class="p">}</span>
</pre></div> 
<p>The <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc/blob/main/cpp/step1.kernels/matrix_functions.h#L29">first change</a> we make to this code in order to try to run it on the GPU is to add the <code>kernels</code> directive.
At this stage, we don't worry about data transfer, or about giving more information to the compiler.
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="29"></span><span class="cp">#pragma acc kernels</span>
</span><span class="hll"><span class="linenos" data-line="30"></span><span class="w">  </span><span class="p">{</span>
</span><span class="linenos" data-line="31"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="32"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="33"></span><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="34"></span><span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="linenos" data-line="35"></span><span class="w">      </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="36"></span><span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="37"></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="38"></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="39"></span><span class="w">        </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="40"></span><span class="w">      </span><span class="p">}</span>
<span class="linenos" data-line="41"></span><span class="w">      </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="42"></span><span class="w">    </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-line="43"></span><span class="w">  </span><span class="p">}</span>
</span></pre></div> 
<h4><span class="mw-headline" id="Building_with_OpenACC">Building with OpenACC</span></h4>
<p>The NVidia compilers use the <code>-acc</code> (target accelerator) option to enable compilation for an accelerator.
We use the sub-option <code>-gpu=managed</code> to tell the compiler that we want to use <a rel="nofollow" class="external text" href="https://developer.nvidia.com/blog/unified-memory-cuda-beginners/">managed memory</a>.
This <i>managed memory</i> simplifies the process of transferring data to and from the device.
We will remove this option in a later example.
We also use the option <code>-fast</code>, which is an optimization option.
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
...
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">30</span>,<span class="w"> </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>cols<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">          </span><span class="m">31</span>,<span class="w"> </span>Loop<span class="w"> </span>carried<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>ycoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>parallelization
<span class="w">              </span>Loop<span class="w"> </span>carried<span class="w"> </span>backward<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>ycoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>vectorization
<span class="w">              </span>Complex<span class="w"> </span>loop<span class="w"> </span>carried<span class="w"> </span>dependence<span class="w"> </span>of<span class="w"> </span>Acoefs-&gt;,xcoefs-&gt;<span class="w"> </span>prevents<span class="w"> </span>parallelization
<span class="w">              </span>Generating<span class="w"> </span>NVIDIA<span class="w"> </span>GPU<span class="w"> </span>code
<span class="w">              </span><span class="m">31</span>,<span class="w"> </span><span class="c1">#pragma acc loop seq</span>
<span class="w">              </span><span class="m">35</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Generating<span class="w"> </span>implicit<span class="w"> </span>reduction<span class="o">(</span>+:sum<span class="o">)</span>
<span class="w">          </span><span class="m">35</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<p>As we can see in the compiler output, the compiler could not parallelize the outer loop on line 31.
We will see in the following sections how to deal with those dependencies.
</p>
<h2><span class="mw-headline" id="Fixing_false_loop_dependencies">Fixing false loop dependencies</span></h2>
<p>Sometimes, the compiler believes that loops cannot be parallelized despite being obvious to the programmer. One common case, in C and C++, is what is called <i><a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Pointer_aliasing">pointer aliasing</a></i>. Contrary to Fortran arrays, C and C++ do not formally have arrays. They have what is called pointers. Two pointers are said to be <i>aliased</i> if they point to the same memory. If the compiler does not know that pointers are not aliased, it must assume that they are. Going back to the previous example, it becomes obvious why the compiler could not parallelize the loop. If we assume that each pointer is the same, then there is an obvious dependence between loop iterations. 
</p>
<h3><span class="mw-headline" id="restrict_keyword"><tt>restrict</tt> keyword</span></h3>
<p>One way to tell the compiler that pointers are <b>not</b> going to be aliased, is by using a special keyword. In C, the keyword <tt>restrict</tt> was introduced in C99 for this purpose.  In C++, there is no standard way yet, but each compiler typically has its own keyword. Either <tt>__restrict</tt> or <tt>__restrict__</tt> can be used depending on the compiler. For Portland Group and NVidia compilers, the keyword is <tt>__restrict</tt>. For an explanation as to why there is no standard way to do this in C++, you can read <a rel="nofollow" class="external text" href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3988.pdf">this paper</a>. This concept is important not only for OpenACC, but for any C/C++ programming, since many more optimizations can be done by compilers when pointers are guaranteed not to be aliased. Note that the keyword goes <i>after</i> the pointer, since it refers to the pointer, and not to the type. In other words, you would declare <code>float * __restrict A;</code> rather than <code>float __restrict * A;</code>. 
</p><p><br />
</p>
<div class="panel callout"><div class="panel-heading callout"><div class="panel-heading-icon callout"></div><div class="panel-heading-title">What does <tt>restrict</tt> really mean&#160;?</div></div>
<div class="panel-body callout">
<p>Declaring a pointer as restricted formally means that for "the lifetime of the pointer, only it or a value derived from it (such as <tt>ptr +1</tt>) will be used to access the object to which it points". This is a guarantee that the <i>programmer</i> gives to the <i>compiler</i>. If the programmer violates this guarantee, behaviour is undefined. For more information on this concept, see this <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Restrict">Wikipedia article</a>.
</p>
</div></div>
<p><br />
</p><p><br />
</p>
<h3><span class="mw-headline" id="Loop_directive_with_independent_clause">Loop directive with independent clause</span></h3>
<p>Another way to tell the compiler that loops iterations are independent is to specify it explicitly by using a different directive: <tt>loop</tt>, with the clause <tt>independent</tt>. This is a <i>prescriptive</i> directive. Like any prescriptive directive, this tells the compiler what to do, and overrides any compiler analysis. The initial example above would become: 
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="cp">#pragma acc kernels</span>
<span class="linenos" data-line="2"></span><span class="p">{</span>
<span class="hll"><span class="linenos" data-line="3"></span><span class="cp">#pragma acc loop independent</span>
</span><span class="linenos" data-line="4"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="5"></span><span class="p">{</span>
<span class="linenos" data-line="6"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="7"></span><span class="p">}</span>
<span class="linenos" data-line="8"></span><span class="p">}</span>
</pre></div> 
<h3><span class="mw-headline" id="Back_to_the_example">Back to the example</span></h3>
<p>Going back to the matrix-vector product above, the way that we recommend fixing false aliasing is by declaring the pointers as restricted. This is done by changing the following code in <tt>matrix_functions.h</tt>: 
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">Acoefs</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">xcoefs</span><span class="o">=</span><span class="n">x</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">ycoefs</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
</pre></div> 
<p>by this code: 
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">Acoefs</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">xcoefs</span><span class="o">=</span><span class="n">x</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
<span class="linenos" data-line="3"></span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="k">__restrict</span><span class="w"> </span><span class="n">ycoefs</span><span class="o">=</span><span class="n">y</span><span class="p">.</span><span class="n">coefs</span><span class="p">;</span>
</pre></div> 
<p>We note that we do not need to declare the other pointers as restricted, since they are not reported as problematic by the compiler. With the above changes, recompiling gives the following compiler messages: 
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">              </span>Generating<span class="w"> </span>implicit<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">]</span>,cols<span class="o">[</span>:<span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="k">if</span><span class="w"> </span>not<span class="w"> </span>already<span class="w"> </span>present<span class="o">]</span>
<span class="w">          </span><span class="m">30</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
<span class="w">              </span>Generating<span class="w"> </span>Tesla<span class="w"> </span>code
<span class="w">              </span><span class="m">30</span>,<span class="w"> </span><span class="c1">#pragma acc loop gang /* blockIdx.x */</span>
<span class="w">              </span><span class="m">34</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Generating<span class="w"> </span>implicit<span class="w"> </span>reduction<span class="o">(</span>+:sum<span class="o">)</span>
<span class="w">          </span><span class="m">34</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<h2><span id="How_is_ported_code_performing_.3F"></span><span class="mw-headline" id="How_is_ported_code_performing_?">How is ported code performing&#160;?</span></h2>
<p>Since we have completed a first step to porting the code to GPU, we need to analyze how the code is performing, and whether it gives the correct results. Running the original version of the code yields the following (performed on one GPU node):
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=.%2Fcg.x" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>./cg.x<span class="w"> </span>
Rows:<span class="w"> </span><span class="m">8120601</span>,<span class="w"> </span>nnz:<span class="w"> </span><span class="m">218535025</span>
Iteration:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.0067e+08
Iteration:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.8772e+07
Iteration:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">6</span>.4359e+05
Iteration:<span class="w"> </span><span class="m">30</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">2</span>.3202e+04
Iteration:<span class="w"> </span><span class="m">40</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">8</span>.3565e+02
Iteration:<span class="w"> </span><span class="m">50</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.0039e+01
Iteration:<span class="w"> </span><span class="m">60</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.0764e+00
Iteration:<span class="w"> </span><span class="m">70</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.8360e-02
Iteration:<span class="w"> </span><span class="m">80</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.3515e-03
Iteration:<span class="w"> </span><span class="m">90</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.6209e-05
Total<span class="w"> </span>Iterations:<span class="w"> </span><span class="m">100</span><span class="w"> </span>Total<span class="w"> </span>Time:<span class="w"> </span><span class="m">29</span>.894881s
</pre></div>
</div>
</div>
<p>Running the OpenACC version yields the following:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=.%2Fchallenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>./challenge<span class="w"> </span>
Rows:<span class="w"> </span><span class="m">8120601</span>,<span class="w"> </span>nnz:<span class="w"> </span><span class="m">218535025</span>
Iteration:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.0067e+08
Iteration:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.8772e+07
Iteration:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">6</span>.4359e+05
Iteration:<span class="w"> </span><span class="m">30</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">2</span>.3202e+04
Iteration:<span class="w"> </span><span class="m">40</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">8</span>.3565e+02
Iteration:<span class="w"> </span><span class="m">50</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.0039e+01
Iteration:<span class="w"> </span><span class="m">60</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.0764e+00
Iteration:<span class="w"> </span><span class="m">70</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">3</span>.8360e-02
Iteration:<span class="w"> </span><span class="m">80</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">1</span>.3515e-03
Iteration:<span class="w"> </span><span class="m">90</span>,<span class="w"> </span>Tolerance:<span class="w"> </span><span class="m">4</span>.6209e-05
Total<span class="w"> </span>Iterations:<span class="w"> </span><span class="m">100</span><span class="w"> </span>Total<span class="w"> </span>Time:<span class="w"> </span><span class="m">115</span>.068931s
</pre></div>
</div>
</div>
<figure class="mw-default-size" typeof="mw:File/Thumb"><a href="/wiki/File:Openacc_profiling1.png" class="mw-file-description"><img src="/mediawiki/images/thumb/3/36/Openacc_profiling1.png/300px-Openacc_profiling1.png" decoding="async" width="300" height="101" class="mw-file-element" srcset="/mediawiki/images/thumb/3/36/Openacc_profiling1.png/450px-Openacc_profiling1.png 1.5x, /mediawiki/images/thumb/3/36/Openacc_profiling1.png/600px-Openacc_profiling1.png 2x" /></a><figcaption>Click to enlarge</figcaption></figure>
<p>The results are correct. However, not only do we not get any speed up, but we rather get a slow down by a factor of almost 4! Let's profile the code again using NVidia's visual profiler (<tt>nvvp</tt>).
</p>
<h3><span class="mw-headline" id="NVIDIA_Visual_Profiler">NVIDIA Visual Profiler</span></h3>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Nvvp-pic0.png" class="mw-file-description"><img src="/mediawiki/images/thumb/6/66/Nvvp-pic0.png/300px-Nvvp-pic0.png" decoding="async" width="300" height="170" class="mw-file-element" srcset="/mediawiki/images/thumb/6/66/Nvvp-pic0.png/450px-Nvvp-pic0.png 1.5x, /mediawiki/images/thumb/6/66/Nvvp-pic0.png/600px-Nvvp-pic0.png 2x" /></a><figcaption>NVVP profiler</figcaption></figure>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Nvvp-pic1.png" class="mw-file-description"><img src="/mediawiki/images/thumb/7/79/Nvvp-pic1.png/300px-Nvvp-pic1.png" decoding="async" width="300" height="170" class="mw-file-element" srcset="/mediawiki/images/thumb/7/79/Nvvp-pic1.png/450px-Nvvp-pic1.png 1.5x, /mediawiki/images/thumb/7/79/Nvvp-pic1.png/600px-Nvvp-pic1.png 2x" /></a><figcaption>Browse for the executable you want to profile</figcaption></figure>
<p>One graphical profiler available for OpenACC applications is the
<a rel="nofollow" class="external text" href="https://developer.nvidia.com/nvidia-visual-profiler">NVIDIA Visual Profiler (NVVP)</a>.
It's a cross-platform analyzing tool <b>for codes written with OpenACC and CUDA C/C++ instructions</b>.
Consequently, if the executable is not using the GPU, you will get no result from this profiler.
</p><p>When <a href="/wiki/Visualization/en#Remote_windows_with_X11-forwarding" title="Visualization/en">X11 is forwarded to an X-Server</a>, or when using a <a href="/wiki/VNC" title="VNC">Linux desktop environment</a> (also via <a href="/wiki/JupyterHub#Desktop" title="JupyterHub">JupyterHub</a> with two (2) CPU cores, 5000M of memory and one (1) GPU),
it is possible to launch the NVVP from a terminal:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=module+load+cuda%2F11.7+java%2F1.8" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>module<span class="w"> </span>load<span class="w"> </span>cuda/11.7<span class="w"> </span>java/1.8
</pre></div>
</div>
</div>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvvp" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvvp
</pre></div>
</div>
</div>
<ol><li>After the NVVP startup window, you get prompted for a <i>Workspace</i> directory, which will be used for temporary files. Replace <code>home</code> with <code>scratch</code> in the suggested path. Then click <i>OK</i>.</li>
<li>Select <i>File &gt; New Session</i>, or click on the corresponding button in the toolbar.</li>
<li>Click on the <i>Browse</i> button at the right of the <i>File</i> path editor.
<ol><li>Change directory if needed.</li>
<li>Select an executable built from codes written with OpenACC and CUDA C/C++ instructions.</li></ol></li>
<li>Below the <i>Arguments</i> editor, select the profiling option <i>Profile current process only</i>.</li>
<li>Click <i>Next &gt;</i> to review additional profiling options.</li>
<li>Click <i>Finish</i> to start profiling the executable.</li></ol>
<p>This can be done with the following steps: 
</p>
<ol><li>Start <tt>nvvp</tt> with the command <tt>nvvp &amp;</tt>   (the <tt>&amp;</tt> sign is to start it in the background)</li>
<li>Go in File -&gt; New Session</li>
<li>In the "File:" field, search for the executable (named <tt>challenge</tt> in our example).</li>
<li>Click "Next" until you can click "Finish".</li></ol>
<p>This will run the program and generate a timeline of the execution. The resulting timeline is illustrated on the image on the right side. As we can see, almost all of the run time is being spent transferring data between the host and the device. This is very often the case when one ports a code from CPU to GPU. We will look at how to optimize this in the <a href="/wiki/OpenACC_Tutorial_-_Data_movement" title="OpenACC Tutorial - Data movement">next part of the tutorial</a>.
</p>
<h2><span class="mw-headline" id="The_parallel_loop_directive">The <tt>parallel loop</tt> directive</span></h2>
<p>With the <tt>kernels</tt> directive, we let the compiler do all of the analysis. This is the <i>descriptive</i> approach to porting a code. OpenACC supports a <i>prescriptive</i> approach through a different directive, called the <tt>parallel</tt> directive. This can be combined with the <tt>loop</tt> directive, to form the <tt>parallel loop</tt> directive. An example would be the following code:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="hll"><span class="linenos" data-line="1"></span><span class="cp">#pragma acc parallel loop</span>
</span><span class="linenos" data-line="2"></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-line="3"></span><span class="p">{</span>
<span class="linenos" data-line="4"></span><span class="w">  </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="5"></span><span class="p">}</span>
</pre></div> 
<p>Since <tt>parallel loop</tt> is a <i>prescriptive</i> directive, it forces the compiler to perform the loop in parallel. This means that the <tt>independent</tt> clause introduced above is implicit within a parallel region. 
</p><p>For reasons that we explain below, in order to use this directive in the matrix-vector product example, we need to introduce additional clauses used to manage the scope of data. The <tt>private</tt> and <tt>reduction</tt> clauses control how the data flows through a parallel region. 
</p>
<ul><li>With the <tt>private</tt> clause, a copy of the variable is made for each loop iteration, making the value of the variable independent from other iterations.</li>
<li>With the <tt>reduction</tt> clause, the values of a variable in each iteration will be <i>reduced</i> to a single value. It supports addition (+), multiplication (*), maximum (max), minimum (min), among other operations.</li></ul>
<p>These clauses were not required with the <tt>kernels</tt> directive, because the <tt>kernels</tt> directive handles this for you. 
</p><p>Going back to the matrix-vector multiplication example, the corresponding code with the <tt>parallel loop</tt> directive would look like this:
</p>
<div class="mw-highlight mw-highlight-lang-cpp mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span class="linenos" data-line="1"></span><span class="cp">#pragma acc parallel loop</span>
<span class="linenos" data-line="2"></span><span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num_rows</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="3"></span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-line="4"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_start</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="linenos" data-line="5"></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_end</span><span class="o">=</span><span class="n">row_offsets</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="hll"><span class="linenos" data-line="6"></span><span class="cp">#pragma acc loop reduction(+:sum)</span>
</span><span class="linenos" data-line="7"></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">row_start</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">row_end</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-line="8"></span><span class="w">      </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Acol</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="9"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">Acoef</span><span class="o">=</span><span class="n">Acoefs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="linenos" data-line="10"></span><span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">xcoef</span><span class="o">=</span><span class="n">xcoefs</span><span class="p">[</span><span class="n">Acol</span><span class="p">];</span>
<span class="linenos" data-line="11"></span><span class="w">      </span><span class="n">sum</span><span class="o">+=</span><span class="n">Acoef</span><span class="o">*</span><span class="n">xcoef</span><span class="p">;</span>
<span class="linenos" data-line="12"></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-line="13"></span><span class="w">    </span><span class="n">ycoefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
<span class="linenos" data-line="14"></span><span class="w">  </span><span class="p">}</span>
</pre></div>
<p>Compiling this code yields the following compiler feedback:
</p>
<div>
<div style="float:right; margin-left:8px">
<p><span typeof="mw:File"><a href="https://explainshell.com/explain?cmd=nvc%2B%2B+-fast+-Minfo%3Daccel+-acc+-gpu%3Dmanaged+main.cpp+-o+challenge" rel="nofollow"><img src="/mediawiki/images/thumb/3/30/Question.png/40px-Question.png" decoding="async" width="40" height="40" class="mw-file-element" srcset="/mediawiki/images/thumb/3/30/Question.png/60px-Question.png 1.5x, /mediawiki/images/thumb/3/30/Question.png/80px-Question.png 2x" /></a></span>
</p>
</div>
<div class="command">
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>name@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>nvc++<span class="w"> </span>-fast<span class="w"> </span>-Minfo<span class="o">=</span>accel<span class="w"> </span>-acc<span class="w"> </span>-gpu<span class="o">=</span>managed<span class="w"> </span>main.cpp<span class="w"> </span>-o<span class="w"> </span>challenge
matvec<span class="o">(</span>const<span class="w"> </span>matrix<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span>,<span class="w"> </span>const<span class="w"> </span>vector<span class="w"> </span><span class="p">&amp;</span><span class="o">)</span>:
<span class="w">     </span><span class="m">23</span>,<span class="w"> </span>include<span class="w"> </span><span class="s2">&quot;matrix_functions.h&quot;</span>
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Accelerator<span class="w"> </span>kernel<span class="w"> </span>generated
<span class="w">              </span>Generating<span class="w"> </span>Tesla<span class="w"> </span>code
<span class="w">              </span><span class="m">29</span>,<span class="w"> </span><span class="c1">#pragma acc loop gang /* blockIdx.x */</span>
<span class="w">              </span><span class="m">34</span>,<span class="w"> </span><span class="c1">#pragma acc loop vector(128) /* threadIdx.x */</span>
<span class="w">                  </span>Sum<span class="w"> </span>reduction<span class="w"> </span>generated<span class="w"> </span><span class="k">for</span><span class="w"> </span>sum
<span class="w">          </span><span class="m">27</span>,<span class="w"> </span>Generating<span class="w"> </span>copyout<span class="o">(</span>ycoefs<span class="o">[</span>:num_rows<span class="o">])</span>
<span class="w">              </span>Generating<span class="w"> </span>copyin<span class="o">(</span>xcoefs<span class="o">[</span>:<span class="o">]</span>,Acoefs<span class="o">[</span>:<span class="o">]</span>,cols<span class="o">[</span>:<span class="o">]</span>,row_offsets<span class="o">[</span>:num_rows+1<span class="o">])</span>
<span class="w">          </span><span class="m">34</span>,<span class="w"> </span>Loop<span class="w"> </span>is<span class="w"> </span>parallelizable
</pre></div>
</div>
</div>
<h2><span class="mw-headline" id="Parallel_loop_vs_kernel">Parallel loop vs kernel</span></h2>
<table class="wikitable" width="100%">

<tbody><tr>
<th>PARALLEL LOOP</th>
<th>KERNEL
</th></tr>
<tr>
<td>
<ul><li>It is the programmer's responsibility to ensure that parallelism is safe</li>
<li>Enables parallelization of sections that the compiler may miss</li>
<li>Straightforward path from OpenMP</li></ul>
</td>
<td>
<ul><li>It is the compiler's responsibility to analyze the code and determine what is safe to parallelize.</li>
<li>A single directive can cover a large area of code</li>
<li>The compiler has more room to optimize</li></ul>
</td></tr></tbody></table>
<p>Both approaches are equally valid and can perform equally well.
</p><p><br /> 
</p>
<div class="panel challenge"><div class="panel-heading challenge"><div class="panel-heading-icon challenge"></div><div class="panel-heading-title">Challenge: Add OpenACC directives <tt>kernels</tt> or <tt>parallel loop</tt></div></div>
<div class="panel-body challenge">
<ol><li>Modify the functions <tt>matvec</tt>, <tt>waxpby</tt> and <tt>dot</tt> to use OpenACC. You may use either the <tt>kernels</tt> or the <tt>parallel loop</tt> directives. The directories step1.* from the <a rel="nofollow" class="external text" href="https://github.com/calculquebec/cq-formation-openacc">Github repository</a> contain solutions.</li>
<li>Modify the Makefile to add <tt>-acc -gpu=managed</tt> and <tt>-Minfo=accel</tt> to your compiler flags.</li></ol>
</div></div>
<p><br />
</p><p><a href="/wiki/OpenACC_Tutorial_-_Profiling" title="OpenACC Tutorial - Profiling">&lt;- Previous unit: <i>Profiling</i></a> | <a href="/wiki/OpenACC_Tutorial" title="OpenACC Tutorial">^- Back to the lesson plan</a> | <a href="/wiki/OpenACC_Tutorial_-_Data_movement" title="OpenACC Tutorial - Data movement">Onward to the next unit: <i>Data movement</i> -&gt;</a>
</p>
<!-- 
NewPP limit report
Cached time: 20250530235155
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.131 seconds
Real time usage: 2.164 seconds
Preprocessor visited node count: 415/1000000
Post‐expand include size: 9592/2097152 bytes
Template argument size: 9126/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 19/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 40592/5000000 bytes
ExtLoops count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 2091.328      1 -total
 34.96%  731.230      7 Template:Command
  0.14%    3.020      2 Template:Callout
  0.13%    2.656      1 Template:Challenge
  0.12%    2.502      1 Template:Objectives
  0.03%    0.690      4 Template:Panel
-->

<!-- Saved in parser cache with key ccwiki:pcache:idhash:179-0!canonical and timestamp 20250530235155 and revision id 137964. Rendering was triggered because: diff-page
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;oldid=137964">https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;oldid=137964</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-login" class="mw-list-item"><a href="/mediawiki/index.php?title=Special:UserLogin&amp;returnto=OpenACC+Tutorial+-+Adding+directives" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li>
		</ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-namespaces-label"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/OpenACC_Tutorial_-_Adding_directives" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="mw-list-item"><a href="/wiki/Talk:OpenACC_Tutorial_-_Adding_directives" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-variants-label"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	>
	<label
		id="p-variants-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-views-label"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected mw-list-item"><a href="/wiki/OpenACC_Tutorial_-_Adding_directives"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-cactions-label"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<h3 >Search</h3>
	<form action="/mediawiki/index.php" id="searchform" class="vector-search-box-form">
		<div id="simpleSearch"
			class="vector-search-box-inner"
			 data-search-loc="header-navigation">
			<input class="vector-search-box-input"
				 type="search" name="search" placeholder="Search Alliance Doc" aria-label="Search Alliance Doc" autocapitalize="sentences" title="Search Alliance Doc [f]" accesskey="f" id="searchInput"
			>
			<input type="hidden" name="title" value="Special:Search">
			<input id="mw-searchButton"
				 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
			<input id="searchButton"
				 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel" class="vector-legacy-sidebar">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Technical_documentation"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu-portal portal vector-menu" aria-labelledby="p-navigation-label"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-wiki-main-page" class="mw-list-item"><a href="/wiki/Technical_documentation"><span>Wiki Main Page</span></a></li>
		</ul>
		
	</div>
</nav>

	
<nav id="p-sidebar-support" class="mw-portlet mw-portlet-sidebar-support vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-support-label"  >
	<h3
		id="p-sidebar-support-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Support</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-getting-started" class="mw-list-item"><a href="/wiki/Getting_started"><span>Getting started</span></a></li><li id="n-sidebar-technical-support" class="mw-list-item"><a href="/wiki/Technical_support"><span>Getting help</span></a></li><li id="n-sidebar-running-jobs" class="mw-list-item"><a href="/wiki/Running_jobs"><span>Running jobs</span></a></li><li id="n-sidebar-known-issues" class="mw-list-item"><a href="/wiki/Known_issues"><span>Known issues</span></a></li><li id="n-sidebar-system-status" class="mw-list-item"><a href="http://status.computecanada.ca" rel="nofollow"><span>System status</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-resources" class="mw-portlet mw-portlet-sidebar-resources vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-resources-label"  >
	<h3
		id="p-sidebar-resources-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Resources</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Béluga" class="mw-list-item"><a href="/wiki/B%C3%A9luga/en"><span>Béluga</span></a></li><li id="n-Cedar" class="mw-list-item"><a href="/wiki/Cedar"><span>Cedar</span></a></li><li id="n-Graham" class="mw-list-item"><a href="/wiki/Graham"><span>Graham</span></a></li><li id="n-Narval" class="mw-list-item"><a href="/wiki/Narval/en"><span>Narval</span></a></li><li id="n-Niagara" class="mw-list-item"><a href="/wiki/Niagara"><span>Niagara</span></a></li><li id="n-sidebar-cloud" class="mw-list-item"><a href="/wiki/CC-Cloud"><span>Cloud</span></a></li><li id="n-tamIA" class="mw-list-item"><a href="/wiki/TamIA/en"><span>tamIA</span></a></li><li id="n-Killarney" class="mw-list-item"><a href="/wiki/Killarney"><span>Killarney</span></a></li><li id="n-sidebar-quantum-computing" class="mw-list-item"><a href="/wiki/Services_d%27informatique_quantique/en"><span>Quantum computing</span></a></li><li id="n-sidebar-available-software" class="mw-list-item"><a href="/wiki/Available_software"><span>Available software</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-alliance" class="mw-portlet mw-portlet-sidebar-alliance vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-alliance-label"  >
	<h3
		id="p-sidebar-alliance-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">The Alliance</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-alliance-main-page" class="mw-list-item"><a href="https://alliancecan.ca/en" rel="nofollow"><span>Alliance main page</span></a></li><li id="n-sidebar-ccdb" class="mw-list-item"><a href="https://ccdb.computecanada.ca/security/login" rel="nofollow"><span>CCDB</span></a></li><li id="n-sidebar-getting-an-account" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/apply-account" rel="nofollow"><span>Getting An Account</span></a></li><li id="n-sidebar-acknowledging-alliance" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/research-portal/acknowledging-alliance" rel="nofollow"><span>Acknowledging the Alliance</span></a></li><li id="n-sidebar-aup" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/policies" rel="nofollow"><span>Acceptable Use Policy</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-authoring" class="mw-portlet mw-portlet-sidebar-authoring vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-authoring-label"  >
	<h3
		id="p-sidebar-authoring-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Authoring</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-guidelines" class="mw-list-item"><a href="/wiki/Authoring_guidelines"><span>Guidelines</span></a></li><li id="n-sidebar-mediawiki-help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu-portal portal vector-menu" aria-labelledby="p-tb-label"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/OpenACC_Tutorial_-_Adding_directives" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/OpenACC_Tutorial_-_Adding_directives" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;oldid=137964" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
		</ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 8 June 2023, at 18:50.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="/wiki/CCWiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/CCWiki:About">About Alliance Doc</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/CCWiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://docs.alliancecan.ca/mediawiki/index.php?title=OpenACC_Tutorial_-_Adding_directives&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/mediawiki/resources/assets/poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.log.warn("This page is using the deprecated ResourceLoader module \"codex-search-styles\".\n[1.43] Use a CodexModule with codexComponents to set your specific components used: https://www.mediawiki.org/wiki/Codex#Using_a_limited_subset_of_components");});</script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-TVBPRD78K4" async=""></script><script>
window.dataLayer = window.dataLayer || [];

function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TVBPRD78K4', {});
</script>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":96,"wgPageParseReport":{"limitreport":{"cputime":"0.131","walltime":"2.164","ppvisitednodes":{"value":415,"limit":1000000},"postexpandincludesize":{"value":9592,"limit":2097152},"templateargumentsize":{"value":9126,"limit":2097152},"expansiondepth":{"value":6,"limit":100},"expensivefunctioncount":{"value":19,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":40592,"limit":5000000},"timingprofile":["100.00% 2091.328      1 -total"," 34.96%  731.230      7 Template:Command","  0.14%    3.020      2 Template:Callout","  0.13%    2.656      1 Template:Challenge","  0.12%    2.502      1 Template:Objectives","  0.03%    0.690      4 Template:Panel"]},"loops":{"limitreport-count-limited":{"value":0,"limit":100}},"cachereport":{"timestamp":"20250530235155","ttl":86400,"transientcontent":false}}});});</script>
</body>
</html>