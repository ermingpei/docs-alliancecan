<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ansys - Alliance Doc</title>
<script>(function(){var className="client-js";var cookie=document.cookie.match(/(?:^|; )ccwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],"wgRequestId":"aDpFPqdG8FmGoo1wBErE@AAAAww","wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Ansys/fr","wgTitle":"Ansys/fr","wgCurRevisionId":173818,"wgRevisionId":173818,"wgArticleId":4960,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[
"Pages using deprecated source tags","Software"],"wgPageViewLanguage":"fr","wgPageContentLanguage":"fr","wgPageContentModel":"wikitext","wgRelevantPageName":"Ansys/fr","wgRelevantArticleId":4960,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgULSAcceptLanguageList":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"watchlist":false,"tagline":false},"wgCiteReferencePreviewsActive":true,"wgTranslatePageTranslation":"translation","wgULSPosition":"personal","wgULSisCompactLinksEnabled":true,"wgVector2022LanguageInHeader":false,"wgULSisLanguageSelectorEmpty":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.translate.tag.languages":"ready","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.translate":"ready","codex-search-styles":"ready","ext.uls.pt":"ready"};RLPAGEMODULES=["ext.pygments.view","ext.tabs","site","mediawiki.page.ready","mediawiki.toc",
"skins.vector.legacy.js","ext.languageSelector","ext.translate.pagetranslation.uls","ext.uls.compactlinks","ext.uls.geoclient","ext.uls.interface","ext.moderation.notify","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=codex-search-styles%7Cext.pygments%2Ctranslate%7Cext.translate.tag.languages%7Cext.uls.pt%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector">
<script async="" src="/mediawiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<link rel="icon" href="/mediawiki/resources/assets/Alliance_favicon.png">
<link rel="search" type="application/opensearchdescription+xml" href="/mediawiki/rest.php/v1/search" title="Alliance Doc (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://docs.alliancecan.ca/mediawiki/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="Alliance Doc Atom feed" href="/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<style type="text/css" id="tabs-dynamic-styles">/*<![CDATA[*/
/* Dynamically generated tabs styles */
.tabs-input-1:checked ~ .tabs-container .tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-content-1 {display:inline-block;}
.tabs-input-1:checked ~ .tabs-container .tabs-inline.tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-inline.tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-inline.tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-inline.tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-inline.tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-inline.tabs-content-1 {display:inline;}
.tabs-input-1:checked ~ .tabs-container .tabs-block.tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-block.tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-block.tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-block.tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-block.tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-block.tabs-content-1 {display:block;}
/* The same styles, but with .checked instead of :checked, for browsers that rely on the JavaScript fallback */
.tabs-input-1.checked ~ .tabs-container .tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-content-1 {display:inline-block;}
.tabs-input-1.checked ~ .tabs-container .tabs-inline.tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-inline.tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-inline.tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-inline.tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-inline.tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-inline.tabs-content-1 {display:inline;}
.tabs-input-1.checked ~ .tabs-container .tabs-block.tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-block.tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-block.tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-block.tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-block.tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-block.tabs-content-1 {display:block;}
.tabs-dropdown .tabs-content,.tabs-dropdown .tabs-container,.tabs-dropdown li,.tabs-dropdown ul,.tabs-dropdown ol {background-color: white /* Malicious data in tabs-dropdown-bgcolor */}
/*]]>*/</style>
</head>
<body class="skin-vector-legacy mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ansys_fr rootpage-Ansys_fr skin-vector action-view"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	<div id="mw-indicator-languageselector" class="mw-indicator"><span id="languageselector-box-1" class="languageselector " style=""><form name="languageselector-form-1" id="languageselector-form-1" method="get" action="/mediawiki/index.php" style="display:inline;"><input type="hidden" value="Ansys/fr" name="title"><select name="setlang" id="languageselector-select-1" style=""><option value="aae">Arbërisht</option><option value="ab">аԥсшәа</option><option value="abs">bahasa ambon</option><option value="ace">Acèh</option><option value="acf">Kwéyòl Sent Lisi</option><option value="acm">عراقي</option><option value="ady">адыгабзэ</option><option value="ady-cyrl">адыгабзэ</option><option value="aeb">تونسي / Tûnsî</option><option value="aeb-arab">تونسي</option><option value="aeb-latn">Tûnsî</option><option value="af">Afrikaans</option><option value="aln">Gegë</option><option value="alt">алтай тил</option><option value="am">አማርኛ</option><option value="ami">Pangcah</option><option value="an">aragonés</option><option value="ang">Ænglisc</option><option value="ann">Obolo</option><option value="anp">अंगिका</option><option value="apc">شامي</option><option value="ar">العربية</option><option value="arc">ܐܪܡܝܐ</option><option value="arn">mapudungun</option><option value="arq">جازايرية</option><option value="ary">الدارجة</option><option value="arz">مصرى</option><option value="as">অসমীয়া</option><option value="ase">American sign language</option><option value="ast">asturianu</option><option value="atj">Atikamekw</option><option value="av">авар</option><option value="avk">Kotava</option><option value="awa">अवधी</option><option value="ay">Aymar aru</option><option value="az">azərbaycanca</option><option value="azb">تۆرکجه</option><option value="ba">башҡортса</option><option value="ban">Basa Bali</option><option value="ban-bali">ᬩᬲᬩᬮᬶ</option><option value="bar">Boarisch</option><option value="bbc">Batak Toba</option><option value="bbc-latn">Batak Toba</option><option value="bcc">جهلسری بلوچی</option><option value="bci">wawle</option><option value="bcl">Bikol Central</option><option value="bdr">Bajau Sama</option><option value="be">беларуская</option><option value="be-tarask">беларуская (тарашкевіца)</option><option value="bew">Betawi</option><option value="bg">български</option><option value="bgc">हरियाणवी</option><option value="bgn">روچ کپتین بلوچی</option><option value="bh">भोजपुरी</option><option value="bho">भोजपुरी</option><option value="bi">Bislama</option><option value="bjn">Banjar</option><option value="blk">ပအိုဝ်ႏဘာႏသာႏ</option><option value="bm">bamanankan</option><option value="bn">বাংলা</option><option value="bo">བོད་ཡིག</option><option value="bpy">বিষ্ণুপ্রিয়া মণিপুরী</option><option value="bqi">بختیاری</option><option value="br">brezhoneg</option><option value="brh">Bráhuí</option><option value="bs">bosanski</option><option value="btm">Batak Mandailing</option><option value="bto">Iriga Bicolano</option><option value="bug">Basa Ugi</option><option value="bxr">буряад</option><option value="ca">català</option><option value="cbk-zam">Chavacano de Zamboanga</option><option value="ccp">𑄌𑄋𑄴𑄟𑄳𑄦</option><option value="cdo">閩東語 / Mìng-dĕ̤ng-ngṳ̄</option><option value="ce">нохчийн</option><option value="ceb">Cebuano</option><option value="ch">Chamoru</option><option value="chn">chinuk wawa</option><option value="chr">ᏣᎳᎩ</option><option value="chy">Tsetsêhestâhese</option><option value="ckb">کوردی</option><option value="co">corsu</option><option value="cps">Capiceño</option><option value="cpx">莆仙語 / Pó-sing-gṳ̂</option><option value="cpx-hans">莆仙语（简体）</option><option value="cpx-hant">莆仙語（繁體）</option><option value="cr">Nēhiyawēwin / ᓀᐦᐃᔭᐍᐏᐣ</option><option value="crh">qırımtatarca</option><option value="crh-cyrl">къырымтатарджа (Кирилл)</option><option value="crh-latn">qırımtatarca (Latin)</option><option value="crh-ro">tatarşa</option><option value="cs">čeština</option><option value="csb">kaszëbsczi</option><option value="cu">словѣньскъ / ⰔⰎⰑⰂⰡⰐⰠⰔⰍⰟ</option><option value="cv">чӑвашла</option><option value="cy">Cymraeg</option><option value="da">dansk</option><option value="dag">dagbanli</option><option value="de">Deutsch</option><option value="de-at">Österreichisches Deutsch</option><option value="de-ch">Schweizer Hochdeutsch</option><option value="de-formal">Deutsch (Sie-Form)</option><option value="dga">Dagaare</option><option value="din">Thuɔŋjäŋ</option><option value="diq">Zazaki</option><option value="dsb">dolnoserbski</option><option value="dtp">Kadazandusun</option><option value="dty">डोटेली</option><option value="dua">Duálá</option><option value="dv">ދިވެހިބަސް</option><option value="dz">ཇོང་ཁ</option><option value="ee">eʋegbe</option><option value="efi">Efịk</option><option value="egl">emiliàn e rumagnòl</option><option value="el">Ελληνικά</option><option value="eml">emiliàn e rumagnòl</option><option value="en" selected="">English</option><option value="en-ca">Canadian English</option><option value="en-gb">British English</option><option value="eo">Esperanto</option><option value="es">español</option><option value="es-formal">español (formal)</option><option value="et">eesti</option><option value="eu">euskara</option><option value="ext">estremeñu</option><option value="fa">فارسی</option><option value="fat">mfantse</option><option value="ff">Fulfulde</option><option value="fi">suomi</option><option value="fit">meänkieli</option><option value="fj">Na Vosa Vakaviti</option><option value="fo">føroyskt</option><option value="fon">fɔ̀ngbè</option><option value="fr">français</option><option value="frc">français cadien</option><option value="frp">arpetan</option><option value="frr">Nordfriisk</option><option value="fur">furlan</option><option value="fy">Frysk</option><option value="ga">Gaeilge</option><option value="gaa">Ga</option><option value="gag">Gagauz</option><option value="gan">贛語</option><option value="gan-hans">赣语（简体）</option><option value="gan-hant">贛語（繁體）</option><option value="gcf">kréyòl Gwadloup</option><option value="gcr">kriyòl gwiyannen</option><option value="gd">Gàidhlig</option><option value="gl">galego</option><option value="gld">на̄ни</option><option value="glk">گیلکی</option><option value="gn">Avañe'ẽ</option><option value="gom">गोंयची कोंकणी / Gõychi Konknni</option><option value="gom-deva">गोंयची कोंकणी</option><option value="gom-latn">Gõychi Konknni</option><option value="gor">Bahasa Hulontalo</option><option value="got">𐌲𐌿𐍄𐌹𐍃𐌺</option><option value="gpe">Ghanaian Pidgin</option><option value="grc">Ἀρχαία ἑλληνικὴ</option><option value="gsw">Alemannisch</option><option value="gu">ગુજરાતી</option><option value="guc">wayuunaiki</option><option value="gur">farefare</option><option value="guw">gungbe</option><option value="gv">Gaelg</option><option value="ha">Hausa</option><option value="hak">客家語 / Hak-kâ-ngî</option><option value="haw">Hawaiʻi</option><option value="he">עברית</option><option value="hi">हिन्दी</option><option value="hif">Fiji Hindi</option><option value="hif-latn">Fiji Hindi</option><option value="hil">Ilonggo</option><option value="hno">ہندکو</option><option value="hr">hrvatski</option><option value="hrx">Hunsrik</option><option value="hsb">hornjoserbsce</option><option value="hsn">湘語</option><option value="ht">Kreyòl ayisyen</option><option value="hu">magyar</option><option value="hu-formal">magyar (formal)</option><option value="hy">հայերեն</option><option value="hyw">Արեւմտահայերէն</option><option value="ia">interlingua</option><option value="iba">Jaku Iban</option><option value="ibb">ibibio</option><option value="id">Bahasa Indonesia</option><option value="ie">Interlingue</option><option value="ig">Igbo</option><option value="igl">Igala</option><option value="ii">ꆇꉙ</option><option value="ik">Iñupiatun</option><option value="ike-cans">ᐃᓄᒃᑎᑐᑦ</option><option value="ike-latn">inuktitut</option><option value="ilo">Ilokano</option><option value="inh">гӀалгӀай</option><option value="io">Ido</option><option value="is">íslenska</option><option value="isv-cyrl">меджусловјанскы</option><option value="isv-latn">medžuslovjansky</option><option value="it">italiano</option><option value="iu">ᐃᓄᒃᑎᑐᑦ / inuktitut</option><option value="ja">日本語</option><option value="jam">Patois</option><option value="jbo">la .lojban.</option><option value="jut">jysk</option><option value="jv">Jawa</option><option value="ka">ქართული</option><option value="kaa">Qaraqalpaqsha</option><option value="kab">Taqbaylit</option><option value="kai">Karai-karai</option><option value="kbd">адыгэбзэ</option><option value="kbd-cyrl">адыгэбзэ</option><option value="kbp">Kabɩyɛ</option><option value="kcg">Tyap</option><option value="kea">kabuverdianu</option><option value="kg">Kongo</option><option value="kge">Kumoring</option><option value="khw">کھوار</option><option value="ki">Gĩkũyũ</option><option value="kiu">Kırmancki</option><option value="kjh">хакас</option><option value="kjp">ဖၠုံလိက်</option><option value="kk">қазақша</option><option value="kk-arab">قازاقشا (تٴوتە)</option><option value="kk-cn">قازاقشا (جۇنگو)</option><option value="kk-cyrl">қазақша (кирил)</option><option value="kk-kz">қазақша (Қазақстан)</option><option value="kk-latn">qazaqşa (latın)</option><option value="kk-tr">qazaqşa (Türkïya)</option><option value="kl">kalaallisut</option><option value="km">ភាសាខ្មែរ</option><option value="kn">ಕನ್ನಡ</option><option value="knc">Yerwa Kanuri</option><option value="ko">한국어</option><option value="ko-kp">조선말</option><option value="koi">перем коми</option><option value="kr">kanuri</option><option value="krc">къарачай-малкъар</option><option value="kri">Krio</option><option value="krj">Kinaray-a</option><option value="krl">karjal</option><option value="ks">कॉशुर / کٲشُر</option><option value="ks-arab">کٲشُر</option><option value="ks-deva">कॉशुर</option><option value="ksh">Ripoarisch</option><option value="ksw">စှီၤ</option><option value="ku">kurdî</option><option value="ku-arab">کوردی (عەرەبی)</option><option value="ku-latn">kurdî (latînî)</option><option value="kum">къумукъ</option><option value="kus">Kʋsaal</option><option value="kv">коми</option><option value="kw">kernowek</option><option value="ky">кыргызча</option><option value="la">Latina</option><option value="lad">Ladino</option><option value="lb">Lëtzebuergesch</option><option value="lbe">лакку</option><option value="lez">лезги</option><option value="lfn">Lingua Franca Nova</option><option value="lg">Luganda</option><option value="li">Limburgs</option><option value="lij">Ligure</option><option value="liv">Līvõ kēļ</option><option value="lki">لەکی</option><option value="lld">Ladin</option><option value="lmo">lombard</option><option value="ln">lingála</option><option value="lo">ລາວ</option><option value="loz">Silozi</option><option value="lrc">لۊری شومالی</option><option value="lt">lietuvių</option><option value="ltg">latgaļu</option><option value="lua">ciluba</option><option value="lus">Mizo ţawng</option><option value="luz">لئری دوٙمینی</option><option value="lv">latviešu</option><option value="lzh">文言</option><option value="lzz">Lazuri</option><option value="mad">Madhurâ</option><option value="mag">मगही</option><option value="mai">मैथिली</option><option value="map-bms">Basa Banyumasan</option><option value="mdf">мокшень</option><option value="mg">Malagasy</option><option value="mhr">олык марий</option><option value="mi">Māori</option><option value="min">Minangkabau</option><option value="mk">македонски</option><option value="ml">മലയാളം</option><option value="mn">монгол</option><option value="mnc">manju gisun</option><option value="mnc-latn">manju gisun</option><option value="mnc-mong">ᠮᠠᠨᠵᡠ ᡤᡳᠰᡠᠨ</option><option value="mni">ꯃꯤꯇꯩ ꯂꯣꯟ</option><option value="mnw">ဘာသာမန်</option><option value="mo">молдовеняскэ</option><option value="mos">moore</option><option value="mr">मराठी</option><option value="mrh">Mara</option><option value="mrj">кырык мары</option><option value="ms">Bahasa Melayu</option><option value="ms-arab">بهاس ملايو</option><option value="mt">Malti</option><option value="mui">Baso Palembang</option><option value="mwl">Mirandés</option><option value="my">မြန်မာဘာသာ</option><option value="myv">эрзянь</option><option value="mzn">مازِرونی</option><option value="na">Dorerin Naoero</option><option value="nah">Nāhuatl</option><option value="nan">閩南語 / Bân-lâm-gú</option><option value="nan-hant">閩南語（傳統漢字）</option><option value="nan-latn-pehoeji">Bân-lâm-gú (Pe̍h-ōe-jī)</option><option value="nan-latn-tailo">Bân-lâm-gú (Tâi-lô)</option><option value="nap">Napulitano</option><option value="nb">norsk bokmål</option><option value="nds">Plattdüütsch</option><option value="nds-nl">Nedersaksies</option><option value="ne">नेपाली</option><option value="new">नेपाल भाषा</option><option value="nia">Li Niha</option><option value="nit">కొలామి</option><option value="niu">Niuē</option><option value="nl">Nederlands</option><option value="nl-informal">Nederlands (informeel)</option><option value="nmz">nawdm</option><option value="nn">norsk nynorsk</option><option value="nod">ᨣᩤᩴᨾᩮᩬᩥᨦ</option><option value="nog">ногайша</option><option value="nov">Novial</option><option value="nqo">ߒߞߏ</option><option value="nr">isiNdebele seSewula</option><option value="nrm">Nouormand</option><option value="nso">Sesotho sa Leboa</option><option value="nup">Nupe</option><option value="nv">Diné bizaad</option><option value="ny">Chi-Chewa</option><option value="nyn">runyankore</option><option value="nyo">Orunyoro</option><option value="nys">Nyunga</option><option value="oc">occitan</option><option value="ojb">Ojibwemowin</option><option value="olo">livvinkarjala</option><option value="om">Oromoo</option><option value="or">ଓଡ଼ିଆ</option><option value="os">ирон</option><option value="pa">ਪੰਜਾਬੀ</option><option value="pag">Pangasinan</option><option value="pam">Kapampangan</option><option value="pap">Papiamentu</option><option value="pcd">Picard</option><option value="pcm">Naijá</option><option value="pdc">Deitsch</option><option value="pdt">Plautdietsch</option><option value="pfl">Pälzisch</option><option value="pi">पालि</option><option value="pih">Norfuk / Pitkern</option><option value="pl">polski</option><option value="pms">Piemontèis</option><option value="pnb">پنجابی</option><option value="pnt">Ποντιακά</option><option value="prg">prūsiskan</option><option value="ps">پښتو</option><option value="pt">português</option><option value="pt-br">português do Brasil</option><option value="pwn">pinayuanan</option><option value="qqq">Message documentation</option><option value="qu">Runa Simi</option><option value="qug">Runa shimi</option><option value="rgn">Rumagnôl</option><option value="rif">Tarifit</option><option value="rki">ရခိုင်</option><option value="rm">rumantsch</option><option value="rmc">romaňi čhib</option><option value="rmy">romani čhib</option><option value="rn">ikirundi</option><option value="ro">română</option><option value="roa-tara">tarandíne</option><option value="rsk">руски</option><option value="ru">русский</option><option value="rue">русиньскый</option><option value="rup">armãneashti</option><option value="ruq">Vlăheşte</option><option value="ruq-cyrl">Влахесте</option><option value="ruq-latn">Vlăheşte</option><option value="rut">мыхаӀбишды</option><option value="rw">Ikinyarwanda</option><option value="ryu">うちなーぐち</option><option value="sa">संस्कृतम्</option><option value="sah">саха тыла</option><option value="sat">ᱥᱟᱱᱛᱟᱲᱤ</option><option value="sc">sardu</option><option value="scn">sicilianu</option><option value="sco">Scots</option><option value="sd">سنڌي</option><option value="sdc">Sassaresu</option><option value="sdh">کوردی خوارگ</option><option value="se">davvisámegiella</option><option value="se-fi">davvisámegiella (Suoma bealde)</option><option value="se-no">davvisámegiella (Norgga bealde)</option><option value="se-se">davvisámegiella (Ruoŧa bealde)</option><option value="sei">Cmique Itom</option><option value="ses">Koyraboro Senni</option><option value="sg">Sängö</option><option value="sgs">žemaitėška</option><option value="sh">srpskohrvatski / српскохрватски</option><option value="sh-cyrl">српскохрватски (ћирилица)</option><option value="sh-latn">srpskohrvatski (latinica)</option><option value="shi">Taclḥit</option><option value="shn">ၽႃႇသႃႇတႆး </option><option value="shy">tacawit</option><option value="shy-latn">tacawit</option><option value="si">සිංහල</option><option value="sjd">кӣллт са̄мь кӣлл</option><option value="sje">bidumsámegiella</option><option value="sk">slovenčina</option><option value="skr">سرائیکی</option><option value="skr-arab">سرائیکی</option><option value="sl">slovenščina</option><option value="sli">Schläsch</option><option value="sm">Gagana Samoa</option><option value="sma">åarjelsaemien</option><option value="smn">anarâškielâ</option><option value="sms">nuõrttsääʹmǩiõll</option><option value="sn">chiShona</option><option value="so">Soomaaliga</option><option value="sq">shqip</option><option value="sr">српски / srpski</option><option value="sr-ec">српски (ћирилица)</option><option value="sr-el">srpski (latinica)</option><option value="srn">Sranantongo</option><option value="sro">sardu campidanesu</option><option value="ss">SiSwati</option><option value="st">Sesotho</option><option value="stq">Seeltersk</option><option value="sty">себертатар</option><option value="su">Sunda</option><option value="sv">svenska</option><option value="sw">Kiswahili</option><option value="syl">ꠍꠤꠟꠐꠤ</option><option value="szl">ślůnski</option><option value="szy">Sakizaya</option><option value="ta">தமிழ்</option><option value="tay">Tayal</option><option value="tcy">ತುಳು</option><option value="tdd">ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ</option><option value="te">తెలుగు</option><option value="tet">tetun</option><option value="tg">тоҷикӣ</option><option value="tg-cyrl">тоҷикӣ</option><option value="tg-latn">tojikī</option><option value="th">ไทย</option><option value="ti">ትግርኛ</option><option value="tig">ትግሬ</option><option value="tk">Türkmençe</option><option value="tl">Tagalog</option><option value="tly">tolışi</option><option value="tn">Setswana</option><option value="to">lea faka-Tonga</option><option value="tok">toki pona</option><option value="tpi">Tok Pisin</option><option value="tr">Türkçe</option><option value="tru">Ṫuroyo</option><option value="trv">Seediq</option><option value="ts">Xitsonga</option><option value="tt">татарча / tatarça</option><option value="tt-cyrl">татарча</option><option value="tt-latn">tatarça</option><option value="ttj">Orutooro</option><option value="tum">chiTumbuka</option><option value="tw">Twi</option><option value="ty">reo tahiti</option><option value="tyv">тыва дыл</option><option value="tzm">ⵜⴰⵎⴰⵣⵉⵖⵜ</option><option value="udm">удмурт</option><option value="ug">ئۇيغۇرچە / Uyghurche</option><option value="ug-arab">ئۇيغۇرچە</option><option value="ug-latn">Uyghurche</option><option value="uk">українська</option><option value="ur">اردو</option><option value="uz">oʻzbekcha / ўзбекча</option><option value="ve">Tshivenda</option><option value="vec">vèneto</option><option value="vep">vepsän kel’</option><option value="vi">Tiếng Việt</option><option value="vls">West-Vlams</option><option value="vmf">Mainfränkisch</option><option value="vmw">emakhuwa</option><option value="vo">Volapük</option><option value="vot">Vaďďa</option><option value="vro">võro</option><option value="wa">walon</option><option value="wal">wolaytta</option><option value="war">Winaray</option><option value="wls">Fakaʻuvea</option><option value="wo">Wolof</option><option value="wuu">吴语</option><option value="wuu-hans">吴语（简体）</option><option value="wuu-hant">吳語（正體）</option><option value="xal">хальмг</option><option value="xh">isiXhosa</option><option value="xmf">მარგალური</option><option value="xsy">saisiyat</option><option value="yi">ייִדיש</option><option value="yo">Yorùbá</option><option value="yrl">Nhẽẽgatú</option><option value="yue">粵語</option><option value="yue-hans">粵语（简体）</option><option value="yue-hant">粵語（繁體）</option><option value="za">Vahcuengh</option><option value="zea">Zeêuws</option><option value="zgh">ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ</option><option value="zh">中文</option><option value="zh-cn">中文（中国大陆）</option><option value="zh-hans">中文（简体）</option><option value="zh-hant">中文（繁體）</option><option value="zh-hk">中文（香港）</option><option value="zh-mo">中文（澳門）</option><option value="zh-my">中文（马来西亚）</option><option value="zh-sg">中文（新加坡）</option><option value="zh-tw">中文（臺灣）</option><option value="zu">isiZulu</option></select><input id="languageselector-commit-1" style="" type="submit" value="set"></form></span></div>
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">Ansys</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Alliance Doc</div>
		<div id="contentSub"><div id="mw-content-subtitle"></div></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content"><div class="mw-pt-translate-header noprint" dir="ltr" lang="en">This page is a <span class="plainlinks"><a rel="nofollow" class="external text" href="https://docs.alliancecan.ca/mediawiki/index.php?title=Special:Translate&amp;group=page-Ansys&amp;action=page&amp;filter=&amp;language=fr">translated version</a></span> of the page <a href="/wiki/Ansys" title="Ansys">Ansys</a> and the translation is 100% complete.</div><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="/wiki/Ansys" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Ansys (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">français</span></li></ul></div>
<p><a rel="nofollow" class="external text" href="http://www.ansys.com/">Ansys</a> est une suite logicielle pour la conception 3D et la simulation. La suite comprend des applications comme <a rel="nofollow" class="external text" href="http://www.ansys.com/Products/Fluids/ANSYS-Fluent">Ansys Fluent</a> et <a rel="nofollow" class="external text" href="http://www.ansys.com/products/fluids/ansys-cfx">Ansys CFX</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Licence"><span class="tocnumber">1</span> <span class="toctext">Licence</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Configurer_votre_propre_fichier_de_licence"><span class="tocnumber">1.1</span> <span class="toctext">Configurer votre propre fichier de licence</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Serveurs_de_licence_locaux"><span class="tocnumber">1.1.1</span> <span class="toctext">Serveurs de licence locaux</span></a>
<ul>
<li class="toclevel-4 tocsection-4"><a href="#Prêt_à_utiliser"><span class="tocnumber">1.1.1.1</span> <span class="toctext">Prêt à utiliser</span></a></li>
<li class="toclevel-4 tocsection-5"><a href="#Configuration_requise"><span class="tocnumber">1.1.1.2</span> <span class="toctext">Configuration requise</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Vérifier_la_licence"><span class="tocnumber">1.2</span> <span class="toctext">Vérifier la licence</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Compatibilité_des_versions"><span class="tocnumber">2</span> <span class="toctext">Compatibilité des versions</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Plateformes_supportées"><span class="tocnumber">2.1</span> <span class="toctext">Plateformes supportées</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Nouveautés"><span class="tocnumber">2.2</span> <span class="toctext">Nouveautés</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Correctifs"><span class="tocnumber">2.3</span> <span class="toctext">Correctifs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Soumettre_des_tâches_en_lot_sur_nos_grappes"><span class="tocnumber">3</span> <span class="toctext">Soumettre des tâches en lot sur nos grappes</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Ansys_Fluent"><span class="tocnumber">3.1</span> <span class="toctext">Ansys Fluent</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm"><span class="tocnumber">3.1.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#Utilisation_générale"><span class="tocnumber">3.1.1.1</span> <span class="toctext">Utilisation générale</span></a></li>
<li class="toclevel-4 tocsection-15"><a href="#Remise_en_file_d&#39;attente_pour_obtenir_la_licence"><span class="tocnumber">3.1.1.2</span> <span class="toctext">Remise en file d'attente pour obtenir la licence</span></a></li>
<li class="toclevel-4 tocsection-16"><a href="#Redémarrage"><span class="tocnumber">3.1.1.3</span> <span class="toctext">Redémarrage</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-17"><a href="#Fichiers_de_journalisation"><span class="tocnumber">3.1.2</span> <span class="toctext">Fichiers de journalisation</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Fonctions_UDF"><span class="tocnumber">3.1.3</span> <span class="toctext">Fonctions UDF</span></a>
<ul>
<li class="toclevel-4 tocsection-19"><a href="#Interpreté"><span class="tocnumber">3.1.3.1</span> <span class="toctext">Interpreté</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="#Compilé"><span class="tocnumber">3.1.3.2</span> <span class="toctext">Compilé</span></a></li>
<li class="toclevel-4 tocsection-21"><a href="#Parallèle"><span class="tocnumber">3.1.3.3</span> <span class="toctext">Parallèle</span></a></li>
<li class="toclevel-4 tocsection-22"><a href="#DPM"><span class="tocnumber">3.1.3.4</span> <span class="toctext">DPM</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="#Ansys_CFX"><span class="tocnumber">3.2</span> <span class="toctext">Ansys CFX</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Workbench"><span class="tocnumber">3.3</span> <span class="toctext">Workbench</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm_3"><span class="tocnumber">3.3.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#Mechanical"><span class="tocnumber">3.4</span> <span class="toctext">Mechanical</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm_4"><span class="tocnumber">3.4.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#Ansys_EDT"><span class="tocnumber">3.5</span> <span class="toctext">Ansys EDT</span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm_5"><span class="tocnumber">3.5.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#Ansys_ROCKY"><span class="tocnumber">3.6</span> <span class="toctext">Ansys ROCKY</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Scripts_pour_l&#39;ordonnanceur_Slurm_6"><span class="tocnumber">3.6.1</span> <span class="toctext">Scripts pour l'ordonnanceur Slurm</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="#Mode_graphique"><span class="tocnumber">4</span> <span class="toctext">Mode graphique</span></a>
<ul>
<li class="toclevel-2 tocsection-34"><a href="#Nœuds_de_calcul"><span class="tocnumber">4.1</span> <span class="toctext">Nœuds de calcul</span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#Fluids"><span class="tocnumber">4.1.1</span> <span class="toctext">Fluids</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#Mapdl"><span class="tocnumber">4.1.2</span> <span class="toctext">Mapdl</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#Workbench_2"><span class="tocnumber">4.1.3</span> <span class="toctext">Workbench</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Ansys_EDT_2"><span class="tocnumber">4.1.4</span> <span class="toctext">Ansys EDT</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#Ensight"><span class="tocnumber">4.1.5</span> <span class="toctext">Ensight</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="#Rocky"><span class="tocnumber">4.1.6</span> <span class="toctext">Rocky</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#Nœuds_VDI"><span class="tocnumber">4.2</span> <span class="toctext">Nœuds VDI</span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="#Fluids_2"><span class="tocnumber">4.2.1</span> <span class="toctext">Fluids</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#Mapdl_2"><span class="tocnumber">4.2.2</span> <span class="toctext">Mapdl</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Workbench_3"><span class="tocnumber">4.2.3</span> <span class="toctext">Workbench</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#Ansys_EDT_3"><span class="tocnumber">4.2.4</span> <span class="toctext">Ansys EDT</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#Ensight_2"><span class="tocnumber">4.2.5</span> <span class="toctext">Ensight</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#Rocky_2"><span class="tocnumber">4.2.6</span> <span class="toctext">Rocky</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-48"><a href="#Problèmes_avec_SSH"><span class="tocnumber">4.3</span> <span class="toctext">Problèmes avec SSH</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49"><a href="#Particularités_selon_le_site_d&#39;utilisation"><span class="tocnumber">5</span> <span class="toctext">Particularités selon le site d'utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-50"><a href="#Licence_SHARCNET"><span class="tocnumber">5.1</span> <span class="toctext">Licence SHARCNET</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="#Fichier_du_serveur_de_licence"><span class="tocnumber">5.1.1</span> <span class="toctext">Fichier du serveur de licence</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#Interroger_le_serveur_de_licence"><span class="tocnumber">5.1.2</span> <span class="toctext">Interroger le serveur de licence</span></a></li>
<li class="toclevel-3 tocsection-53"><a href="#Modules_VDI_locaux"><span class="tocnumber">5.1.3</span> <span class="toctext">Modules VDI locaux</span></a>
<ul>
<li class="toclevel-4 tocsection-54"><a href="#Modules_Ansys"><span class="tocnumber">5.1.3.1</span> <span class="toctext">Modules Ansys</span></a></li>
<li class="toclevel-4 tocsection-55"><a href="#Modules_ansysedt"><span class="tocnumber">5.1.3.2</span> <span class="toctext">Modules ansysedt</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-56"><a href="#Additive_Manufacturing"><span class="tocnumber">6</span> <span class="toctext">Additive Manufacturing</span></a>
<ul>
<li class="toclevel-2 tocsection-57"><a href="#Activer_Additive"><span class="tocnumber">6.1</span> <span class="toctext">Activer Additive</span></a>
<ul>
<li class="toclevel-3 tocsection-58"><a href="#Télécharger_l&#39;extension"><span class="tocnumber">6.1.1</span> <span class="toctext">Télécharger l'extension</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#Lancer_Workbench"><span class="tocnumber">6.1.2</span> <span class="toctext">Lancer Workbench</span></a></li>
<li class="toclevel-3 tocsection-60"><a href="#Ouvrir_le_gestionnaire_d&#39;extensions"><span class="tocnumber">6.1.3</span> <span class="toctext">Ouvrir le gestionnaire d'extensions</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#Installer_l&#39;extension"><span class="tocnumber">6.1.4</span> <span class="toctext">Installer l'extension</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#Charger_l&#39;extension"><span class="tocnumber">6.1.5</span> <span class="toctext">Charger l'extension</span></a></li>
<li class="toclevel-3 tocsection-63"><a href="#Supprimer_l&#39;extension"><span class="tocnumber">6.1.6</span> <span class="toctext">Supprimer l'extension</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-64"><a href="#Exécuter_Additive"><span class="tocnumber">6.2</span> <span class="toctext">Exécuter Additive</span></a>
<ul>
<li class="toclevel-3 tocsection-65"><a href="#Gra-vdi"><span class="tocnumber">6.2.1</span> <span class="toctext">Gra-vdi</span></a></li>
<li class="toclevel-3 tocsection-66"><a href="#Grappe"><span class="tocnumber">6.2.2</span> <span class="toctext">Grappe</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-67"><a href="#Aide"><span class="tocnumber">7</span> <span class="toctext">Aide</span></a>
<ul>
<li class="toclevel-2 tocsection-68"><a href="#Documentation_en_ligne"><span class="tocnumber">7.1</span> <span class="toctext">Documentation en ligne</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#Vidéos_sur_YouTube"><span class="tocnumber">7.2</span> <span class="toctext">Vidéos sur YouTube</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#Innovation_Space"><span class="tocnumber">7.3</span> <span class="toctext">Innovation Space</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Licence">Licence</span></h1>
<p>La suite Ansys est hébergée sur nos grappes, mais nous n'avons pas une licence qui permet un accès généralisé. Toutefois, plusieurs établissements, facultés et départements possèdent des licences qui peuvent être utilisées sur nos grappes; vérifiez l'aspect légal de son utilisation. En ce qui a trait à l'aspect technique, nos nœuds de calcul doivent pouvoir communiquer avec votre serveur de licence. Si ce n'est pas déjà fait, notre équipe technique coordonnera ceci avec votre gestionnaire de licence. Quand tout sera en place, vous pourrez charger le module Ansys qui localisera de lui-même la licence. En cas de difficulté, communiquez avec le <a href="/wiki/Technical_support/fr" title="Technical support/fr"> soutien technique</a>.
</p>
<h2><span class="mw-headline" id="Configurer_votre_propre_fichier_de_licence">Configurer votre propre fichier de licence</span></h2>
<p>Notre module Ansys cherche l'information sur la licence à différents endroits, dont votre répertoire /home.
Pour indiquer votre propre serveur de licence, créez un fichier nommé <code>$HOME/.licenses/ansys.lic</code> qui contient les deux lignes ci-dessous, où vous remplacez FLEXPORT, INTEPORT et LICSERVER par les valeurs de votre serveur. 
</p>
<table class="wikitable" style="text-align:left; border:1px solid #BBB; background-color:#F9F9F9; width:50%;">
<caption style="text-align:left; background-color:#F2F2F2; font-size:110%">FICHIER&#160;: ansys.lic
</caption>
<tbody><tr>
<td style="border-style: none none none none; font-size: 100%; padding-left:10%; padding-bottom:0;">setenv("ANSYSLMD_LICENSE_FILE", "<b>FLEXPORT@LICSERVER</b>")
</td></tr>
<tr>
<td style="border-style: none none none none; font-size: 100%; padding-left:10%; padding-top:0;">setenv("ANSYSLI_SERVERS", "<b>INTEPORT@LICSERVER</b>")
</td></tr></tbody></table>
<p>Les valeurs correspondant aux serveurs de licence CMC et SHARCNET se trouvent dans le tableau ci-dessous. Pour utiliser un différent serveur, voir <a class="mw-selflink-fragment" href="#Serveurs_de_licence_locaux">Serveurs de licence locaux</a> ci-dessous.
</p>
<table class="wikitable">
<caption style="text-align:left; background-color:#F2F2F2; font-size:110%">TABLEAU&#160;: Serveurs de licence préconfigurés
</caption>
<tbody><tr>
<th>Licence
</th>
<th>Grappe
</th>
<th>LICSERVER
</th>
<th>FLEXPORT
</th>
<th>INTEPORT
</th>
<th>VENDPORT
</th>
<th>NOTES
</th></tr>
<tr>
<td>CMC
</td>
<td>beluga
</td>
<td><code>10.20.73.21</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>s.o.
</td>
<td>aucune
</td></tr>
<tr>
<td>CMC
</td>
<td>cedar
</td>
<td><code>172.16.0.101</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>s.o.
</td>
<td>aucune
</td></tr>
<tr>
<td>CMC
</td>
<td>graham
</td>
<td><code>10.25.1.56</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>s.o.
</td>
<td>nouvelle IP le 21 février 2025
</td></tr>
<tr>
<td>CMC
</td>
<td>narval
</td>
<td><code>10.100.64.10</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>s.o.
</td>
<td>aucune
</td></tr>
<tr>
<td>SHARCNET
</td>
<td>beluga/cedar/graham/gra-vdi/narval
</td>
<td><code>license3.sharcnet.ca</code>
</td>
<td><code>1055</code>
</td>
<td><code>2325</code>
</td>
<td>s.o.
</td>
<td>aucune
</td></tr>
<tr>
<td>SHARCNET
</td>
<td>niagara
</td>
<td><code>localhost</code>
</td>
<td><code>1055</code>
</td>
<td><code>2325</code>
</td>
<td><code>1793</code>
</td>
<td>aucune
</td></tr></tbody></table>
<p>Si vous avez obtenu une licence de CMC, vous devez faire parvenir le nom d'utilisateur associé à votre compte avec l'Alliance à &lt;cmcsupport@cmc.ca&gt;, autrement la licence ne fonctionnera pas. Pour connaître le nombre de cœurs que vous pouvez utiliser avec une licence CMC, voyez les sections <i>Other Tricks and Tips</i> des  <a rel="nofollow" class="external text" href="https://www.cmc.ca/?s=Other+Tricks+and+Tips&amp;lang=en/">guides Ansys Electronics Desktop et Ansys Mechanical/Fluids</a>.
</p>
<h3><span class="mw-headline" id="Serveurs_de_licence_locaux">Serveurs de licence locaux</span></h3>
<p>Avant que le serveur de licence de votre établissement puisse être utilisé, les coupe-feu des deux parties doivent être configurés. Dans plusieurs cas, ce travail est déjà fait; suivez les directives dans le paragraphe <i>Prêt à utiliser</i> ci-dessous. Autrement, référez-vous au paragraphe <i>Configuration requise</i> un peu plus bas.
</p>
<h4><span id="Pr.C3.AAt_.C3.A0_utiliser"></span><span class="mw-headline" id="Prêt_à_utiliser">Prêt à utiliser</span></h4>
<p>Pour utiliser un serveur de licence ANSYS déjà configuré pour être utilisé sur la grappe où vous allez soumettre des tâches, contactez votre administrateur de serveur de licences Ansys et obtenez les trois éléments d'information suivants&#160;:
</p>
<pre>1) le nom d'hôte complet (LICSERVER) du serveur
2) le port flex (FLEXPORT) pour Ansys, habituellement 1055
3) le port d'interconnexion (INTEPORT), habituellement 2325
</pre>
<p>Une fois les trois éléments d'information collectés, configurez votre fichier <code>~/.licenses/ansys.lic</code> en entrant les valeurs de LICSERVER, FLEXPORT et INTEPORT dans le modèle <code>FILE: ansys.lic</code> ci-dessus.
</p>
<h4><span class="mw-headline" id="Configuration_requise">Configuration requise</span></h4>
<p>Si votre serveur de licence Ansys local n'a jamais été configuré pour être utilisé sur la ou les grappes où vous allez soumettre des tâches, en plus des 3 éléments ci-dessus, vous devrez ÉGALEMENT obtenir les éléments suivants auprès de l'administrateur&#160;:
</p>
<pre>4) le numéro de port statique du fournisseur (VENDPORT)
5) confirmation que &lt;servername&gt; se résoudra à la même adresse IP que LICSERVER sur nos grappes
</pre>
<p>où &lt;servername&gt; peut être trouvé dans la première ligne du fichier de licence avec le format <i>SERVER &lt;servername&gt; &lt;host id&gt; &lt;lmgrd port&gt;</i>. L'élément 5 est obligatoire sinon les extractions de licences Ansys ne fonctionneront sur aucune grappe distante. S'il s'avère que &lt;servername&gt; ne répond pas à cette exigence, demandez à votre administrateur de licence de remplacer &lt;servername&gt; par le même nom d'hôte complet que LICSERVER ou au moins par un nom d'hôte qui se résoudra à la même adresse IP que LICSERVER à distance.
</p><p>Envoyez les éléments 1 à 4 par courriel au  <a href="/wiki/Technical_support/fr" title="Technical support/fr">soutien technique</a> et indiquez sur quelles grappes vous souhaitez exécuter les tâches Ansys. Nos administrateurs de système procéderont ensuite à l'ouverture du pare-feu afin que les demandes de retrait de licence puissent atteindre votre serveur de licence à partir des nœuds de calcul du ou des grappes spécifiées. En retour, vous recevrez une plage d'adresses IP à transmettre à votre administrateur de serveur, qui pourra alors ouvrir le pare-feu local pour autoriser les connexions de licence Ansys entrantes à partir de la ou les grappes sur CHACUN des ports définis par FLEXPORT, INTEPORT et VENDPORT.
</p>
<h2><span id="V.C3.A9rifier_la_licence"></span><span class="mw-headline" id="Vérifier_la_licence">Vérifier la licence</span></h2>
<p>Pour vérifier si <code>ansys.lic</code> est bien configuré et fonctionne correctement, exécutez les commandes suivantes sur la grappe où vous voulez soumettre des tâches.
</p>
<div class="command">
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">[name@server ~]$ </span>salloc<span class="w"> </span>--time<span class="o">=</span><span class="m">1</span>:0:0<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--mem<span class="o">=</span>1G<span class="w"> </span>--ntasks<span class="o">=</span><span class="m">1</span><span class="w"> </span>--account<span class="o">=</span>def-youruserid
<span class="gp">[name@server ~]$ </span>module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2
<span class="gp">[name@server ~]$ </span><span class="nv">$EBROOTANSYS</span>/v232/licensingclient/linx64/lmutil<span class="w"> </span>lmstat<span class="w"> </span>-c<span class="w"> </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="w"> </span><span class="m">1</span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Success<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>Fail
<span class="go">Success</span>
</pre></div></div>
<p><br />
Si le résultat est <code>Success</code>, la licence devrait fonctionner quand des tâches sont soumises. Par contre si le résultat est <code>Fail</code>, écrivez au <a href="/wiki/Technical_support/fr" title="Technical support/fr">soutien technique</a> en indiquant les commandes que vous avez utilisées ainsi que le nom du nœud de calcul. Remarque&#160;: Si vous chargez une version autre que celle qui se trouve ci-dessus, il faut modifier le chemin pour <code>lmutil</code> en conséquence.
</p>
<h1><span id="Compatibilit.C3.A9_des_versions"></span><span class="mw-headline" id="Compatibilité_des_versions">Compatibilité des versions</span></h1>
<h2><span id="Plateformes_support.C3.A9es"></span><span class="mw-headline" id="Plateformes_supportées">Plateformes supportées</span></h2>
<p>La page <a rel="nofollow" class="external text" href="https://www.ansys.com/it-solutions/platform-support"><i>Platform Support</i></a> mentionne que la version actuelle a été testée pour lire et ouvrir les bases de données des cinq versions précédentes. Cela signifie que les simulations développées à l'aide d'anciennes versions d'Ansys devraient généralement fonctionner avec des versions de module plus récentes (compatibilité en aval pour 5 versions). L'inverse ne peut cependant pas être présumé. Le lien <i>Platform Support</i> fournit également des informations de compatibilité logicielle et matérielle basées sur la version pour déterminer l'infrastructure de plateforme optimale (prise en charge) sur laquelle Ansys peut être exécuté. Les fonctionnalités prises en charge sous Windows VS Linux peuvent être affichées en cliquant sur <i>Platform Support by Application/Product</i>. Des informations similaires pour toutes les versions ci-dessus peuvent être trouvées en cliquant sur <i>Previous Releases</i> dans le coin inférieur gauche de la page <i>Platform Support</i>.
</p>
<h2><span id="Nouveaut.C3.A9s"></span><span class="mw-headline" id="Nouveautés">Nouveautés</span></h2>
<p>Ansys publie régulièrement des <i>service packs</i> pour regrouper plusieurs mises-à-jour apportant différents correctifs et améliorations à ses versions majeures. Des informations similaires pour les versions précédentes peuvent généralement être trouvées sur <a rel="nofollow" class="external text" href="https://www.ansys.com/blog">le blog Ansys</a>, en utilisant la barre de recherche FILTERS. Par exemple, la recherche de <code>What’s New Fluent 2024 gpu</code> affichera le document <code><a rel="nofollow" class="external text" href="https://www.ansys.com/blog/fluent-2024-r1">What’s New for Ansys Fluent in 2024 R1?</a></code> qui contient une multitude d'informations sur la prise en charge des GPU. Spécifier un numéro de version dans le champ de recherche <a rel="nofollow" class="external text" href="https://www.ansys.com/news-center/press-releases">Press Release</a> est également un bon moyen de trouver des informations sur les nouvelles versions. Depuis janvier 2025, Ansys 2024R2 est la dernière version et sera installée lorsque l'intérêt sera exprimé ou qu'il sera nécessaire de prendre en charge du nouveau matériel ou des fonctionnalités plus récentes. Pour demander l'installation d'une nouvelle version, écrivez au <a href="/wiki/Technical_support/fr" title="Technical support/fr">soutien technique</a>.
</p>
<h2><span class="mw-headline" id="Correctifs">Correctifs</span></h2>
<p>À partir d'Ansys 2024, un module Ansys distinct sera identifié avec une décimale et deux chiffres après le numéro de version, chaque fois qu'un <i>service pack</i> est installé pour la version initiale. Par exemple, la version initiale pour 2024 sans aucun <i>service pack</i> peut être chargée en exécutant <code>module load ansys/2024R1</code> tandis qu'un module avec le <i>service pack</i> 3 peut être chargé avec <code>module load ansys/2024R1.03</code>. Si un <i>service pack</i> est déjà disponible au moment où une nouvelle version doit être installée, il est fort probable que seulement un module pour ce numéro de <i>service pack</i> sera installé, à moins qu'une demande soit faite pour l'installation de la version initiale.
</p><p>La plupart du temps, vous voudrez probablement charger la dernière version du module équipé du dernier <i>service pack</i> installé en exécutant simplement <code>module load ansys</code>. Bien qu'il ne soit pas prévu que les <i>service packs</i> aient un impact sur les résultats numériques, les modifications qu'ils apportent sont importantes et donc si des calculs ont déjà été effectués avec la version initiale ou un <i>service pack</i> antérieur, certains groupes préféreront peut-être continuer à l'utiliser. Le fait d'avoir des modules distincts pour chaque <i>service pack</i> rend cela possible. À partir d'Ansys 2024R1, une description détaillée de ce que fait chaque <i>service pack</i> se trouve dans <a rel="nofollow" class="external text" href="https://storage.ansys.com/staticfiles/cp/Readme/release2024R1/info_combined.pdf">la documentation officielle</a> (les versions futures pourront probablement être consultées de la même manière en modifiant le numéro de version contenu dans le lien).
</p>
<h1><span id="Soumettre_des_t.C3.A2ches_en_lot_sur_nos_grappes"></span><span class="mw-headline" id="Soumettre_des_tâches_en_lot_sur_nos_grappes">Soumettre des tâches en lot sur nos grappes</span></h1>
<p>Plusieurs implémentations MPI incluses dans la suite Ansys permettent le calcul parallèle, mais aucune n'est compatible avec l'ordonnanceur Slurm (voir <a href="/wiki/Running_jobs/fr" title="Running jobs/fr">Exécuter des tâches</a>). Pour cette raison, il faut utiliser des directives particulières à chaque paquet Ansys pour lancer une tâche parallèle. Vous trouverez ci-dessous quelques scripts de soumission pour ce faire. Ils fonctionneront sur toutes les grappes, mais sur Niagara, vous devrez peut-être <a rel="nofollow" class="external text" href="https://docs.scinet.utoronto.ca/index.php">faire certains ajustements</a>.
</p>
<h2><span class="mw-headline" id="Ansys_Fluent">Ansys Fluent</span></h2>
<p>La procédure suivante est habituellement utilisée pour exécuter Fluent sur une de nos grappes&#160;:
</p>
<ol><li>Sur votre ordinateur, préparez votre tâche avec Fluent du Ansys Workbench jusqu'au point où les calculs seraient exécutés.</li>
<li>Exportez le fichier de cas avec <i>File &gt; Export &gt; Case…</i> ou localisez le répertoire dans lequel Fluent enregistre les fichiers pour votre projet. Le nom des fichiers de cas a souvent un format tel que <code>FFF-1.cas.gz</code>.</li>
<li>Si vous voulez poursuivre avec des données d'un calcul effectué précédemment, exportez aussi un fichier de données avec <i>File &gt; Export &gt; Data…</i> ou trouvez-le dans le même répertoire /project (<code>FFF-1.dat.gz</code>).</li>
<li><a href="/wiki/Transferring_data/fr" title="Transferring data/fr">Transférez</a> le fichier de cas (et le fichier de données s'il y a lieu) dans le système de fichiers <a href="/wiki/Project_layout/fr" title="Project layout/fr">/project</a> ou <a href="/wiki/Storage_and_file_management/fr#Types_de_stockage" title="Storage and file management/fr">/scratch</a> de la grappe. Quand les fichiers sont exportés, sauvegardez-les avec des noms plus faciles à repérer que <code>FFF-1.*</code> ou renommez-les au téléversement.</li>
<li>Créez un fichier de journalisation dont le but est de charger les fichiers de cas (et le fichier de données s'il y a lieu), lancez le solveur et enregistrez les résultats. Voyez les exemples ci-dessous et n'oubliez pas d'ajuster les noms des fichiers et le nombre d'itérations.</li>
<li>S'il arrive fréquemment que les tâches ne démarrent pas en raison d'un manque de licence (et que de les soumettre de nouveau manuellement ne convient pas), vous pouvez modifier votre script pour que votre tâche soit remise en file d'attente (au plus 4 fois) comme c'est le cas pour le script sous l'onglet <i>Plusieurs nœuds (par cœur + remise en attente)</i> plus loin. Cependant, ceci remet aussi en attente les simulations qui ont échoué pour d'autres raisons que l'absence de licence (par exemple la divergence), gaspillant ainsi du temps de calcul. Il est donc fortement recommandé de vérifier les fichiers de sortie de l'ordonnanceur pour savoir si chaque tentative de remise en attente est ou non due à un problème de licence. Si vous découvrez que la remise en attente est due à un problème avec la simulation, annulez immédiatement la tâche avec <code>scancel jobid</code> et corrigez le problème.</li>
<li>Lorsque la  <a href="/wiki/Running_jobs/fr" title="Running jobs/fr">tâche est terminée</a>, vous pouvez télécharger le fichier de données et le retourner dans Fluent avec <i>File &gt; Import &gt; Data…</i>.</li></ol>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm">Scripts pour l'ordonnanceur Slurm</span></h3>
<h4><span id="Utilisation_g.C3.A9n.C3.A9rale"></span><span class="mw-headline" id="Utilisation_générale">Utilisation générale</span></h4>
<p>La plupart des tâches Fluent devraient utiliser le script <i>par nœud</i> ci-dessous pour minimiser le temps d'attente et maximiser la performance en utilisant le moins de nœuds possible. Les tâches demandant beaucoup de cœurs CPU pourraient attendre moins longtemps dans la queue avec le script <i>par cœur</i>, mais le démarrage d’une tâche utilisant plusieurs nœuds peut prendre beaucoup plus de temps, ce qui en diminue l'intérêt. Il faut aussi tenir compte du fait qu'exécuter des tâches intensives sur un nombre indéterminé de nœuds pouvant être très élevé fait en sorte que ces tâches seront beaucoup plus susceptibles de planter si un des nœuds de calcul fait défaut pendant la simulation. Les scripts suivants utilisent la mémoire partagée pour les tâches utilisant un seul nœud et la mémoire distribuée (avec MPI et l’interconnexion CHP appropriée) pour les tâches en utilisant plusieurs.
</p><p>Les deux onglets pour Narval peuvent fournir une alternative plus robuste si Fluent plante pendant la phase initiale de partitionnement automatique du maillage lors de l'utilisation des scripts Intel standards avec le solveur parallèle. L'autre option serait d'effectuer manuellement le partitionnement du maillage dans l'interface graphique de Fluent, puis d'essayer d'exécuter à nouveau la tâche sur la grappe avec les scripts Intel. Ainsi, vous pouvez inspecter les statistiques de partitionnement et spécifier la méthode pour obtenir un résultat optimal. Le nombre de partitions de maillage doit être un multiple entier du nombre de cœurs; pour une efficacité optimale, assurez-vous d'avoir au moins 10&#160;000 cellules par cœur.
</p>
<form id="tabs-inputform" class="tabs tabs-inputform" action="#"></form><div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-1-0" name="tabs-1" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-1-1" name="tabs-1" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-1-1" data-tabpos="1">Plusieurs nœuds (par nœud)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-2" name="tabs-1" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-1-2" data-tabpos="2">Plusieurs nœuds (par cœur)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-3" name="tabs-1" class="tabs-input tabs-input-3" /><label class="tabs-label" for="tabs-input-1-3" data-tabpos="3">Plusieurs nœuds (par nœud, Narval)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-4" name="tabs-1" class="tabs-input tabs-input-4" /><label class="tabs-label" for="tabs-input-1-4" data-tabpos="4">Plusieurs nœuds (par cœur, Narval)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-5" name="tabs-1" class="tabs-input tabs-input-5" /><label class="tabs-label" for="tabs-input-1-5" data-tabpos="5">Plusieurs nœuds (par nœud, Niagara)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-intel.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+narval+64%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-intel.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, narval 64, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore-intel.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore-intel.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-3">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-openmpi.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes%0A%23SBATCH+--ntasks-per-node%3D64++%23+Specify+number+of+cores+per+node+%28narval+64+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28narval+only%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aexport+OPENMPI_ROOT%3D%24EBROOTOPENMPI%0Aexport+OMPI_MCA_hwloc_base_binding_policy%3Dcore%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmf-%24SLURM_JOB_ID%0Afor+i+in+%60cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+uniq%60%3B+do+echo+%22%24%7Bi%7D%3A%24%28cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+grep+%24i+%7C+wc+-l%29%22+%3E%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%3B+done%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-openmpi.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes</span>
<span class="c1">#SBATCH --ntasks-per-node=64  # Specify number of cores per node (narval 64 or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (narval only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">OPENMPI_ROOT</span><span class="o">=</span><span class="nv">$EBROOTOPENMPI</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_hwloc_base_binding_policy</span><span class="o">=</span>core
slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">:</span><span class="k">$(</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-4">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore-openmpi.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+number+of+compute+nodes+%28optional%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change+++++%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28narval+only%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aexport+OPENMPI_ROOT%3D%24EBROOTOPENMPI%0Aexport+OMPI_MCA_hwloc_base_binding_policy%3Dcore%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmf-%24SLURM_JOB_ID%0Afor+i+in+%60cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+uniq%60%3B+do+echo+%22%24%7Bi%7D%3A%24%28cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+grep+%24i+%7C+wc+-l%29%22+%3E%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%3B+done%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore-openmpi.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify number of compute nodes (optional)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change     </span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (narval only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">OPENMPI_ROOT</span><span class="o">=</span><span class="nv">$EBROOTOPENMPI</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_hwloc_base_binding_policy</span><span class="o">=</span>core
slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">:</span><span class="k">$(</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-5">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-intel-nia.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group++++++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00++++++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D2++++++++++++++++%23+Specify+number+of+compute+nodes%0A%23SBATCH+--ntasks-per-node%3D80+++++%23+Specify+number+cores+per+node+%28niagara+80+or+less%29%0A%23SBATCH+--mem%3D0++++++++++++++++++%23+Do+not+change+%28allocate+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1++++++++%23+Do+not+change+%28required+parameter%29%0A%0Amodule+load+CCEnv+StdEnv%2F2023++++%23+Do+not+change%0Amodule+load+arch%2Favx512%0Amodule+load+ansys%2F2023R2+++++++++%23+or+newer+versions+%28niagara+only%29%0A%0AMYJOURNALFILE%3Dsample.jou+++++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d+++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+These+settings+are+used+instead+of+your+%7E%2F.licenses%2Fansys.lic%0ALICSERVER%3Dlicense3.sharcnet.ca+++%23+Specify+license+server+hostname%0AFLEXPORT%3D1055++++++++++++++++++++%23+Specify+server+flex+port%0AINTEPORT%3D2325++++++++++++++++++++%23+Specify+server+interconnect+port%0AVENDPORT%3D1793++++++++++++++++++++%23+Specify+server+vendor+port%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Assh+nia-gw+-fNL+%24FLEXPORT%3A%24LICSERVER%3A%24FLEXPORT++++++%23+Do+not+change%0Assh+nia-gw+-fNL+%24INTEPORT%3A%24LICSERVER%3A%24INTEPORT++++++%23+Do+not+change%0Assh+nia-gw+-fNL+%24VENDPORT%3A%24LICSERVER%3A%24VENDPORT++++++%23+Do+not+change%0Aexport+ANSYSLMD_LICENSE_FILE%3D%24FLEXPORT%40localhost++++%23+Do+not+change%0Aexport+ANSYSLI_SERVERS%3D%24INTEPORT%40localhost++++++++++%23+Do+not+change%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%24SLURM_SUBMIT_DIR%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%21+-L+%22%24HOME%2F.ansys%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.ansys+directory+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.ansys+if+one+exists+and+then+run%3A+ln+-s+%24SCRATCH%2F.ansys+%7E%2F.ansys%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelif+%5B+%21+-L+%22%24HOME%2F.fluentconf%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.fluentconf+directory+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.fluentconf+if+one+exists+and+run%3A+ln+-s+%24SCRATCH%2F.fluentconf+%7E%2F.fluentconf%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelif+%5B+%21+-L+%22%24HOME%2F.flrecent%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.flrecent+file+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.flrecent+if+one+exists+and+then+run%3A+ln+-s+%24SCRATCH%2F.flrecent+%7E%2F.flrecent%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelse%0A++mkdir+-pv+%24SCRATCH%2F.ansys%0A++mkdir+-pv+%24SCRATCH%2F.fluentconf%0A++touch+%24SCRATCH%2F.flrecent%0A++if+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0A++else%0A+++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-ssh+-pib+-cnf%3D%24SLURM_SUBMIT_DIR%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0A++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-intel-nia.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group      # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00          # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=2                # Specify number of compute nodes</span>
<span class="c1">#SBATCH --ntasks-per-node=80     # Specify number cores per node (niagara 80 or less)</span>
<span class="c1">#SBATCH --mem=0                  # Do not change (allocate all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1        # Do not change (required parameter)</span>

module<span class="w"> </span>load<span class="w"> </span>CCEnv<span class="w"> </span>StdEnv/2023<span class="w">    </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>arch/avx512
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">         </span><span class="c1"># or newer versions (niagara only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">         </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                     </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># These settings are used instead of your ~/.licenses/ansys.lic</span>
<span class="nv">LICSERVER</span><span class="o">=</span>license3.sharcnet.ca<span class="w">   </span><span class="c1"># Specify license server hostname</span>
<span class="nv">FLEXPORT</span><span class="o">=</span><span class="m">1055</span><span class="w">                    </span><span class="c1"># Specify server flex port</span>
<span class="nv">INTEPORT</span><span class="o">=</span><span class="m">2325</span><span class="w">                    </span><span class="c1"># Specify server interconnect port</span>
<span class="nv">VENDPORT</span><span class="o">=</span><span class="m">1793</span><span class="w">                    </span><span class="c1"># Specify server vendor port</span>

<span class="c1"># ------- do not change any lines below --------</span>

ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$FLEXPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$FLEXPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$INTEPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$INTEPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$VENDPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$VENDPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ANSYSLMD_LICENSE_FILE</span><span class="o">=</span><span class="nv">$FLEXPORT</span>@localhost<span class="w">    </span><span class="c1"># Do not change</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ANSYSLI_SERVERS</span><span class="o">=</span><span class="nv">$INTEPORT</span>@localhost<span class="w">          </span><span class="c1"># Do not change</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$SLURM_SUBMIT_DIR</span>/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.ansys&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .ansys directory does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.ansys if one exists and then run: ln -s $SCRATCH/.ansys ~/.ansys&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.fluentconf&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .fluentconf directory does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.fluentconf if one exists and run: ln -s $SCRATCH/.fluentconf ~/.fluentconf&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.flrecent&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .flrecent file does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.flrecent if one exists and then run: ln -s $SCRATCH/.flrecent ~/.flrecent&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">else</span>
<span class="w">  </span>mkdir<span class="w"> </span>-pv<span class="w"> </span><span class="nv">$SCRATCH</span>/.ansys
<span class="w">  </span>mkdir<span class="w"> </span>-pv<span class="w"> </span><span class="nv">$SCRATCH</span>/.fluentconf
<span class="w">  </span>touch<span class="w"> </span><span class="nv">$SCRATCH</span>/.flrecent
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">   </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span><span class="nv">$SLURM_SUBMIT_DIR</span>/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h4><span id="Remise_en_file_d.27attente_pour_obtenir_la_licence"></span><span class="mw-headline" id="Remise_en_file_d'attente_pour_obtenir_la_licence">Remise en file d'attente pour obtenir la licence</span></h4>
<p>Les scripts suivants ne doivent être utilisés qu'avec des tâches Fluent qui sont connues pour se terminer normalement sans générer d'erreurs en sortie, mais qui nécessitent généralement plusieurs tentatives de remise en file d'attente pour obtenir les licences. Ils ne sont pas recommandés pour les tâches Fluent qui peuvent 1) s'exécuter pendant une longue période avant de planter 2) s'exécuter jusqu'à la fin mais contenir des avertissements de journalisation; dans les deux cas, les simulations seront répétées depuis le début jusqu'à ce que le nombre maximal de tentatives de remise en file d'attente spécifié par la valeur <code>array</code> soit atteint. Pour ces types de tâches, les scripts à usage général (ci-dessus) doivent être utilisés.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-2-0" name="tabs-2" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-2-1" name="tabs-2" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-2-1" data-tabpos="1">Plusieurs nœuds (par nœud + remise en attente)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-2-2" name="tabs-2" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-2-2" data-tabpos="2">Plusieurs nœuds (par cœur + remise en attente)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode+requeue.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+requeue+attempts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++scancel+%24SLURM_ARRAY_JOB_ID%0Aelse%0A++++echo+%22Job+attempt+%24SLURM_ARRAY_TASK_ID+of+%24SLURM_ARRAY_TASK_COUNT+failed+due+to+license+or+simulation+issue%21%22%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A+++++++echo+%22Resubmitting+job+now+%E2%80%A6%22%0A++++else%0A+++++++echo+%22All+job+attempts+failed+exiting+now.%22%0A++++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode+requeue.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of requeue attempts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">    </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job attempt </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2"> of </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2"> failed due to license or simulation issue!&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Resubmitting job now …&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All job attempts failed exiting now.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore+requeue.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29+%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+requeue+attempts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++scancel+%24SLURM_ARRAY_JOB_ID%0Aelse%0A++++echo+%22Job+attempt+%24SLURM_ARRAY_TASK_ID+of+%24SLURM_ARRAY_TASK_COUNT+failed+due+to+license+or+simulation+issue%21%22%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A+++++++echo+%22Resubmitting+job+now+%E2%80%A6%22%0A++++else%0A+++++++echo+%22All+job+attempts+failed+exiting+now.%22%0A++++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore+requeue.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max) </span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of requeue attempts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">    </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job attempt </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2"> of </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2"> failed due to license or simulation issue!&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Resubmitting job now …&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All job attempts failed exiting now.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h4><span id="Red.C3.A9marrage"></span><span class="mw-headline" id="Redémarrage">Redémarrage</span></h4>
<p>Les deux scripts suivants automatisent le redémarrage de tâches intensives qui exigent plus que le maximum de sept jours d'exécution permis sur la plupart des grappes. Le redémarrage se fait à partir des fichiers de valeur de pas de temps les plus récemment sauvegardés. Une exigence de base est que le premier pas puisse être terminé avant la fin du temps demandé dans le vecteur de tâches (défini dans le haut du script) quand une simulation est lancée à partir d'un champ initialisé. Nous supposons que la valeur du pas est fixe. Pour commencer, un groupe de <i>sample.cas</i>, <i>sample.dat</i> et <i>sample.jou</i> doit être présent. Modifiez le fichier <i>sample.jou</i> pour qu'il contienne <code>/solve/dual-time-iterate 1</code> et <code>/file/auto-save/data-frequency 1</code>. Créez ensuite un fichier de journalisation avec <code>cp sample.jou sample-restart.jou</code> et modifiez le fichier <i>sample-restart.jou</i> pour qu'il contienne <code>/file/read-cas-data sample-restart</code> plutôt que <code>/file/read-cas-data sample</code> et mettez en commentaire la ligne pour l'initialisation en la précédant d’un point-virgule, par exemple <code>;/solve/initialize/initialize-flow</code>. Si votre deuxième pas et les pas qui suivent sont exécutés deux fois plus vite que le pas initial, modifiez <i>sample-restart.jou</i> en spécifiant <code>/solve/dual-time-iterate 2</code>. De cette façon, la solution ne sera redémarrée qu'après que les deux pas suivant le pas initial soient terminés. Un fichier de résultats pour chaque pas sera enregistré dans le sous-répertoire de sortie. La valeur 2 est arbitraire, mais elle devrait être utilisée pour que la durée de deux pas soit moindre que la durée allouée au vecteur de tâches. Ceci limitera le nombre de redémarrages, ce qui consomme beaucoup de ressources. Si le premier pas de <i>sample.jou</i> est fait à partir d'une solution précédente, choisissez 1 plutôt que 2 puisque tous les pas auront probablement besoin du même temps d'exécution. En supposant que 2 est choisi, la durée totale de la simulation sera 1*Dt+2*Nrestart*Dt où Nrestart est le nombre de redémarrages défini dans le script Slurm. Le nombre total de pas (de même que le nombre de fichiers de résultats générés) sera ainsi 1+2*Nrestart. La valeur pour le temps demandé devrait être choisie afin que le pas initial et les pas suivants se terminent dans la fenêtre de temps de Slurm, qui peut aller jusqu'à <code>#SBATCH --time=07-00:00</code> jours.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-3-0" name="tabs-3" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-3-1" name="tabs-3" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-3-1" data-tabpos="1">Plusieurs nœuds (par nœud + redémarrage)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-3-2" name="tabs-3" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-3-2" data-tabpos="2">Plusieurs nœuds (par cœur + redémarrage)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode+restart.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D07-00%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+narval+64%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+solution+restarts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0AMYVERSION%3D3d++++++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0AMYJOUFILE%3Dsample.jou++++++++++++++++%23+Specify+your+journal+filename%0AMYJOUFILERES%3Dsample-restart.jou+++++%23+Specify+journal+restart+filename%0AMYCASFILERES%3Dsample-restart.cas.h5++%23+Specify+cas+restart+filename%0AMYDATFILERES%3Dsample-restart.dat.h5++%23+Specify+dat+restart+filename%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0A%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp+and+replace+sample+with+your+journal+filename+%E2%80%A6%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-i+%24MYJOUFILERES%0A++fi%0Aelse+%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-mpi%3Dintel+-ssh+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-mpi%3Dintel+-ssh+-i+%24MYJOUFILERES%0A++fi%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo%0A++++echo+%22SLURM_ARRAY_TASK_ID++%3D+%24SLURM_ARRAY_TASK_ID%22%0A++++echo+%22SLURM_ARRAY_TASK_COUNT+%3D+%24SLURM_ARRAY_TASK_COUNT%22%0A++++echo%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A++++++echo+%22Restarting+job+with+the+most+recent+output+dat+file+%E2%80%A6%22%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.cas+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYCASFILERES%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.dat+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYDATFILERES%0A++++++ls+-lh+cavity%2A+output%2F%2A%0A++++else%0A++++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++++scancel+%24SLURM_ARRAY_JOB_ID%0A+++++fi%0Aelse%0A+++++echo+%22Simulation+failed.+Exiting+%E2%80%A6%22%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode+restart.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=07-00:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, narval 64, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of solution restarts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                        </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>
<span class="nv">MYJOUFILE</span><span class="o">=</span>sample.jou<span class="w">                </span><span class="c1"># Specify your journal filename</span>
<span class="nv">MYJOUFILERES</span><span class="o">=</span>sample-restart.jou<span class="w">     </span><span class="c1"># Specify journal restart filename</span>
<span class="nv">MYCASFILERES</span><span class="o">=</span>sample-restart.cas.h5<span class="w">  </span><span class="c1"># Specify cas restart filename</span>
<span class="nv">MYDATFILERES</span><span class="o">=</span>sample-restart.dat.h5<span class="w">  </span><span class="c1"># Specify dat restart filename</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="c1"># Specify 2d, 2ddp, 3d or 3ddp and replace sample with your journal filename …</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_ID  = </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_COUNT = </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restarting job with the most recent output dat file …&quot;</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.cas<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYCASFILERES</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.dat<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYDATFILERES</span>
<span class="w">      </span>ls<span class="w"> </span>-lh<span class="w"> </span>cavity*<span class="w"> </span>output/*
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">      </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="w">     </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">     </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Simulation failed. Exiting …&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore+restart.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+restart+aka+time+steps+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYVERSION%3D3d++++++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0AMYJOUFILE%3Dsample.jou++++++++++++++++%23+Specify+your+journal+filename%0AMYJOUFILERES%3Dsample-restart.jou+++++%23+Specify+journal+restart+filename%0AMYCASFILERES%3Dsample-restart.cas.h5++%23+Specify+cas+restart+filename%0AMYDATFILERES%3Dsample-restart.dat.h5++%23+Specify+dat+restart+filename%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-I+%24MYFILEJOU%0A++else%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-I+%24MYFILEJOURES%0A++fi%0Aelse+%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOUFILERES%0A++fi%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo%0A++++echo+%22SLURM_ARRAY_TASK_ID++%3D+%24SLURM_ARRAY_TASK_ID%22%0A++++echo+%22SLURM_ARRAY_TASK_COUNT+%3D+%24SLURM_ARRAY_TASK_COUNT%22%0A++++echo%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A++++++echo+%22Restarting+job+with+the+most+recent+output+dat+file%22%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.cas+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYCASFILERES%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.dat+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYDATFILERES%0A++++++ls+-lh+cavity%2A+output%2F%2A%0A++++else%0A++++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++++scancel+%24SLURM_ARRAY_JOB_ID%0A+++++fi%0Aelse%0A+++++echo+%22Simulation+failed.+Exiting+now.%22%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore+restart.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of restart aka time steps (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                        </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>
<span class="nv">MYJOUFILE</span><span class="o">=</span>sample.jou<span class="w">                </span><span class="c1"># Specify your journal filename</span>
<span class="nv">MYJOUFILERES</span><span class="o">=</span>sample-restart.jou<span class="w">     </span><span class="c1"># Specify journal restart filename</span>
<span class="nv">MYCASFILERES</span><span class="o">=</span>sample-restart.cas.h5<span class="w">  </span><span class="c1"># Specify cas restart filename</span>
<span class="nv">MYDATFILERES</span><span class="o">=</span>sample-restart.dat.h5<span class="w">  </span><span class="c1"># Specify dat restart filename</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-I<span class="w"> </span><span class="nv">$MYFILEJOU</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-I<span class="w"> </span><span class="nv">$MYFILEJOURES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_ID  = </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_COUNT = </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restarting job with the most recent output dat file&quot;</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.cas<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYCASFILERES</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.dat<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYDATFILERES</span>
<span class="w">      </span>ls<span class="w"> </span>-lh<span class="w"> </span>cavity*<span class="w"> </span>output/*
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">      </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="w">     </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">     </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Simulation failed. Exiting now.&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h3><span class="mw-headline" id="Fichiers_de_journalisation">Fichiers de journalisation</span></h3>
<p>Les fichiers de journalisation peuvent contenir toutes les commandes de l'interface TUI (<i>Text User Interface</i>) de Fluent; elles peuvent être utilisées pour modifier des paramètres de simulation comme la température, la pression ou la vitesse du flux. Vous pouvez ainsi effectuer une série de simulations sous différentes conditions simplement en modifiant les paramètres du fichier de journalisation. Consultez le guide d'utilisation de Fluent pour plus d'information ainsi que pour connaître la liste des commandes. Les fichiers qui suivent sont configurés avec <code>/file/cff-file no</code> pour utiliser les formats de fichiers .cas/.dat qui sont les formats par défaut pour les modules jusqu'à 2019R3. Pour utiliser les formats .cas.h5/.dat.h5 plus efficaces des versions à partir de 2020R1, la configuration est 
<code>/file/cff-files yes</code>.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-4-0" name="tabs-4" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-4-1" name="tabs-4" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-4-1" data-tabpos="1">Fichier de journalisation (stable, cas)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-4-2" name="tabs-4" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-4-2" data-tabpos="2">Fichier de journalisation (stable, cas + données)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-4-3" name="tabs-4" class="tabs-input tabs-input-3" /><label class="tabs-label" for="tabs-input-4-3" data-tabpos="3">Fichier de journalisation (temporaire)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample1.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+SAMPLE+FLUENT+JOURNAL+FILE+-+STEADY+SIMULATION%0A%3B+----------------------------------------------%0A%3B+lines+beginning+with+a+semicolon+are+comments%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+input+case+and+data+files%0A%2Ffile%2Fread-case-data+FFF-in%0A%0A%3B+Run+the+solver+for+this+many+iterations%0A%2Fsolve%2Fiterate+1000%0A%0A%3B+Overwrite+output+files+by+default%0A%2Ffile%2Fconfirm-overwrite+n%0A%0A%3B+Write+final+output+data+file%0A%2Ffile%2Fwrite-case-data+FFF-out%0A%0A%3B+Write+simulation+report+to+file+%28optional%29%0A%2Freport%2Fsummary+y+%22My_Simulation_Report.txt%22%0A%0A%3B+Cleanly+shutdown+fluent%0A%2Fexit" />
<input type="hidden" name="filename" value="sample1.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>SAMPLE<span class="w"> </span>FLUENT<span class="w"> </span>JOURNAL<span class="w"> </span>FILE<span class="w"> </span>-<span class="w"> </span>STEADY<span class="w"> </span>SIMULATION
<span class="p">;</span><span class="w"> </span>----------------------------------------------
<span class="p">;</span><span class="w"> </span>lines<span class="w"> </span>beginning<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>semicolon<span class="w"> </span>are<span class="w"> </span>comments

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>input<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>files
/file/read-case-data<span class="w"> </span>FFF-in

<span class="p">;</span><span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>solver<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>many<span class="w"> </span>iterations
/solve/iterate<span class="w"> </span><span class="m">1000</span>

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>output<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>n

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>final<span class="w"> </span>output<span class="w"> </span>data<span class="w"> </span>file
/file/write-case-data<span class="w"> </span>FFF-out

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>simulation<span class="w"> </span>report<span class="w"> </span>to<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span><span class="s2">&quot;My_Simulation_Report.txt&quot;</span>

<span class="p">;</span><span class="w"> </span>Cleanly<span class="w"> </span>shutdown<span class="w"> </span>fluent
/exit
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample2.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+EXEMPLE+DE+FICHIER+DE+JOURNALISATION+-+SIMULATION+STABLE%0A%3B+----------------------------------------------%0A%3B+le+point-virgule+en+d%C3%A9but+de+ligne+signale+un+commentaire%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+input+files%0A%2Ffile%2Fread-case-data+FFF-in%0A%0A%3B+Write+a+data+file+every+100+iterations%0A%2Ffile%2Fauto-save%2Fdata-frequency+100%0A%0A%3B+Retain+data+files+from+5+most+recent+iterations%0A%2Ffile%2Fauto-save%2Fretain-most-recent-files+y%0A%0A%3B+Write+data+files+to+output+sub-directory+%28appends+iteration%29%0A%2Ffile%2Fauto-save%2Froot-name+output%2FFFF-out%0A%0A%3B+Run+the+solver+for+this+many+iterations%0A%2Fsolve%2Fiterate+1000%0A%0A%3B+%C3%A9crire+le+dernier+fichier+de+cas+et+de+donn%C3%A9es+en+sortie%0A%2Ffile%2Fwrite-case-data+FFF-out%0A%0A%3B+enregistrer+le+rapport+de+la+simulation+%28optionnel%29%0A%2Freport%2Fsummary+y+%22My_Simulation_Report.txt%22%0A%0A%3B+fermez+correctement+Fluent%0Aexit" />
<input type="hidden" name="filename" value="sample2.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>EXEMPLE<span class="w"> </span>DE<span class="w"> </span>FICHIER<span class="w"> </span>DE<span class="w"> </span>JOURNALISATION<span class="w"> </span>-<span class="w"> </span>SIMULATION<span class="w"> </span>STABLE
<span class="p">;</span><span class="w"> </span>----------------------------------------------
<span class="p">;</span><span class="w"> </span>le<span class="w"> </span>point-virgule<span class="w"> </span>en<span class="w"> </span>début<span class="w"> </span>de<span class="w"> </span>ligne<span class="w"> </span>signale<span class="w"> </span>un<span class="w"> </span>commentaire

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>input<span class="w"> </span>files
/file/read-case-data<span class="w"> </span>FFF-in

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>a<span class="w"> </span>data<span class="w"> </span>file<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span>iterations
/file/auto-save/data-frequency<span class="w"> </span><span class="m">100</span>

<span class="p">;</span><span class="w"> </span>Retain<span class="w"> </span>data<span class="w"> </span>files<span class="w"> </span>from<span class="w"> </span><span class="m">5</span><span class="w"> </span>most<span class="w"> </span>recent<span class="w"> </span>iterations
/file/auto-save/retain-most-recent-files<span class="w"> </span>y

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>data<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>output<span class="w"> </span>sub-directory<span class="w"> </span><span class="o">(</span>appends<span class="w"> </span>iteration<span class="o">)</span>
/file/auto-save/root-name<span class="w"> </span>output/FFF-out

<span class="p">;</span><span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>solver<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>many<span class="w"> </span>iterations
/solve/iterate<span class="w"> </span><span class="m">1000</span>

<span class="p">;</span><span class="w"> </span>écrire<span class="w"> </span>le<span class="w"> </span>dernier<span class="w"> </span>fichier<span class="w"> </span>de<span class="w"> </span>cas<span class="w"> </span>et<span class="w"> </span>de<span class="w"> </span>données<span class="w"> </span>en<span class="w"> </span>sortie
/file/write-case-data<span class="w"> </span>FFF-out

<span class="p">;</span><span class="w"> </span>enregistrer<span class="w"> </span>le<span class="w"> </span>rapport<span class="w"> </span>de<span class="w"> </span>la<span class="w"> </span>simulation<span class="w"> </span><span class="o">(</span>optionnel<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span><span class="s2">&quot;My_Simulation_Report.txt&quot;</span>

<span class="p">;</span><span class="w"> </span>fermez<span class="w"> </span>correctement<span class="w"> </span>Fluent
<span class="nb">exit</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-3">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample3.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+EXEMPLE+DE+FICHIER+DE+JOURNALISATION+-+SIMULATION+TEMPORAIRE%0A%3B+----------------------------------------------%0A%3B+le+point-virgule+en+d%C3%A9but+de+ligne+signale+un+commentaire%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+the+input+case+file%0A%2Ffile%2Fread-case+FFF-transient-inp%0A%0A%3B+For+continuation+%28restart%29+read+in+both+case+and+data+input+files%0A%3B%2Ffile%2Fread-case-data+FFF-transient-inp%0A%0A%3B+Write+a+data+%28and+maybe+case%29+file+every+100+time+steps%0A%2Ffile%2Fauto-save%2Fdata-frequency+100%0A%2Ffile%2Fauto-save%2Fcase-frequency+if-case-is-modified%0A%0A%3B+Retain+only+the+most+recent+5+data+%28and+maybe+case%29+files%0A%2Ffile%2Fauto-save%2Fretain-most-recent-files+y%0A%0A%3B+Write+to+output+sub-directory+%28appends+flowtime+and+timestep%29%0A%2Ffile%2Fauto-save%2Froot-name+output%2FFFF-transient-out-%2510.6f%0A%0A%3B+%23%23%23%23%23+Settings+for+Transient+simulation+%3A++%23%23%23%23%23%0A%0A%3B+Set+the+physical+time+step+size%0A%2Fsolve%2Fset%2Ftime-step+0.0001%0A%0A%3B+Set+the+number+of+iterations+for+which+convergence+monitors+are+reported%0A%2Fsolve%2Fset%2Freporting-interval+1%0A%0A%3B+%23%23%23%23%23+Fin+des+param%C3%A8tres+%23%23%23%23%23%0A%0A%3B+initialiser+avec+la+m%C3%A9thode+hybride%0A%2Fsolve%2Finitialize%2Fhyb-initialization%0A%0A%3B+indiquer+le+nombre+maximal+d%27it%C3%A9rations+par+pas+et+le+nombre+de+pas%0A%3B%2Fsolve%2Fset%2Fmax-iterations-per-time-step+75%0A%3B%2Fsolve%2Fdual-time-iterate+1000+%2C%0A%2Fsolve%2Fdual-time-iterate+1000+75%0A%0A%3B+enregistrer+les+derniers+fichiers+en+sortie+pour+les+cas+et+les+donn%C3%A9es%0A%2Ffile%2Fwrite-case-data+FFF-transient-out%0A%0A%3B+enregistrer+le+rapport+de+la+simulation+%28optionnel%29%0A%2Freport%2Fsummary+y+Report_Transient_Simulation.txt%0A%0A%3B+Cleanly+shutdown+fluent%0A%2Fexit" />
<input type="hidden" name="filename" value="sample3.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>EXEMPLE<span class="w"> </span>DE<span class="w"> </span>FICHIER<span class="w"> </span>DE<span class="w"> </span>JOURNALISATION<span class="w"> </span>-<span class="w"> </span>SIMULATION<span class="w"> </span>TEMPORAIRE
<span class="p">;</span><span class="w"> </span>----------------------------------------------
<span class="p">;</span><span class="w"> </span>le<span class="w"> </span>point-virgule<span class="w"> </span>en<span class="w"> </span>début<span class="w"> </span>de<span class="w"> </span>ligne<span class="w"> </span>signale<span class="w"> </span>un<span class="w"> </span>commentaire

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>the<span class="w"> </span>input<span class="w"> </span><span class="k">case</span><span class="w"> </span>file
/file/read-case<span class="w"> </span>FFF-transient-inp

<span class="p">;</span><span class="w"> </span>For<span class="w"> </span>continuation<span class="w"> </span><span class="o">(</span>restart<span class="o">)</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>both<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>input<span class="w"> </span>files
<span class="p">;</span>/file/read-case-data<span class="w"> </span>FFF-transient-inp

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>a<span class="w"> </span>data<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>maybe<span class="w"> </span><span class="k">case</span><span class="o">)</span><span class="w"> </span>file<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="nb">time</span><span class="w"> </span>steps
/file/auto-save/data-frequency<span class="w"> </span><span class="m">100</span>
/file/auto-save/case-frequency<span class="w"> </span><span class="k">if</span>-case-is-modified

<span class="p">;</span><span class="w"> </span>Retain<span class="w"> </span>only<span class="w"> </span>the<span class="w"> </span>most<span class="w"> </span>recent<span class="w"> </span><span class="m">5</span><span class="w"> </span>data<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>maybe<span class="w"> </span><span class="k">case</span><span class="o">)</span><span class="w"> </span>files
/file/auto-save/retain-most-recent-files<span class="w"> </span>y

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>to<span class="w"> </span>output<span class="w"> </span>sub-directory<span class="w"> </span><span class="o">(</span>appends<span class="w"> </span>flowtime<span class="w"> </span>and<span class="w"> </span>timestep<span class="o">)</span>
/file/auto-save/root-name<span class="w"> </span>output/FFF-transient-out-%10.6f

<span class="p">;</span><span class="w"> </span><span class="c1">##### Settings for Transient simulation&#160;:  #####</span>

<span class="p">;</span><span class="w"> </span>Set<span class="w"> </span>the<span class="w"> </span>physical<span class="w"> </span><span class="nb">time</span><span class="w"> </span>step<span class="w"> </span>size
/solve/set/time-step<span class="w"> </span><span class="m">0</span>.0001

<span class="p">;</span><span class="w"> </span>Set<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>iterations<span class="w"> </span><span class="k">for</span><span class="w"> </span>which<span class="w"> </span>convergence<span class="w"> </span>monitors<span class="w"> </span>are<span class="w"> </span>reported
/solve/set/reporting-interval<span class="w"> </span><span class="m">1</span>

<span class="p">;</span><span class="w"> </span><span class="c1">##### Fin des paramètres #####</span>

<span class="p">;</span><span class="w"> </span>initialiser<span class="w"> </span>avec<span class="w"> </span>la<span class="w"> </span>méthode<span class="w"> </span>hybride
/solve/initialize/hyb-initialization

<span class="p">;</span><span class="w"> </span>indiquer<span class="w"> </span>le<span class="w"> </span>nombre<span class="w"> </span>maximal<span class="w"> </span>d<span class="err">&#39;</span>itérations<span class="w"> </span>par<span class="w"> </span>pas<span class="w"> </span>et<span class="w"> </span>le<span class="w"> </span>nombre<span class="w"> </span>de<span class="w"> </span>pas
<span class="p">;</span>/solve/set/max-iterations-per-time-step<span class="w"> </span><span class="m">75</span>
<span class="p">;</span>/solve/dual-time-iterate<span class="w"> </span><span class="m">1000</span><span class="w"> </span>,
/solve/dual-time-iterate<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">75</span>

<span class="p">;</span><span class="w"> </span>enregistrer<span class="w"> </span>les<span class="w"> </span>derniers<span class="w"> </span>fichiers<span class="w"> </span>en<span class="w"> </span>sortie<span class="w"> </span>pour<span class="w"> </span>les<span class="w"> </span>cas<span class="w"> </span>et<span class="w"> </span>les<span class="w"> </span>données
/file/write-case-data<span class="w"> </span>FFF-transient-out

<span class="p">;</span><span class="w"> </span>enregistrer<span class="w"> </span>le<span class="w"> </span>rapport<span class="w"> </span>de<span class="w"> </span>la<span class="w"> </span>simulation<span class="w"> </span><span class="o">(</span>optionnel<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span>Report_Transient_Simulation.txt

<span class="p">;</span><span class="w"> </span>Cleanly<span class="w"> </span>shutdown<span class="w"> </span>fluent
/exit
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h3><span class="mw-headline" id="Fonctions_UDF">Fonctions UDF</span></h3>
<p>La première étape est de transférer vers la grappe votre UDF (<i> User-Defined Function</i>), soit le fichier source sampleudf.c et tous les fichiers de dépendance supplémentaires. Lors du téléchargement à partir d'une machine Windows, assurez-vous que le mode texte de votre client de transfert est utilisé, sinon Fluent ne pourra pas lire correctement le fichier sur la grappe qui elle exécute Linux. L'UDF doit être placée dans le répertoire où résident vos fichiers de journalisation, cas et dat. Ajoutez ensuite l'une des commandes suivantes dans votre fichier de journalisation avant les commandes qui lisent vos fichiers de simulation cas/dat. Que vous utilisiez l'approche UDF interprétée ou compilée, avant de télécharger votre fichier de cas, vérifiez que les boîtes de dialogue <i>Interpreted UDFs</i> et <i>UDF Library Manager</i> ne sont pas configurées pour utiliser un UDF; ceci garantira que lorsque les tâches sont soumises, seules les commandes du fichier de journalisation auront le contrôle.
</p>
<h4><span id="Interpret.C3.A9"></span><span class="mw-headline" id="Interpreté">Interpreté</span></h4>
<p>Pour indiquer à Fluent d'interpréter votre UDF au moment de l'exécution, ajoutez la ligne de commande suivante dans votre fichier journal avant que les fichiers cas/dat ne soient lus ou initialisés. Remplacez le nom de fichier sampleudf.c par le nom de votre fichier source. La commande reste la même, que la simulation soit exécutée séquentiellement ou en parallèle. Pour vous assurer que l'UDF se trouve dans le même répertoire que le fichier de journalisation, ouvrez votre fichier cas dans l'interface graphique Fluent, supprimez toutes les définitions gérées et réenregistrez-le. Cela garantira que seule la commande/méthode suivante est en contrôle lors de l'exécution de Fluent. Pour utiliser une UDF interprétée avec des tâches parallèles, elle devra être parallélisée comme décrit dans la section ci-dessous.
</p>
<pre>define/user-defined/interpreted-functions "sampleudf.c" "cpp" 10000 no
</pre>
<h4><span id="Compil.C3.A9"></span><span class="mw-headline" id="Compilé">Compilé</span></h4>
<p>Pour utiliser cette approche, votre UDF doit être compilée sur une de nos grappes au moins une fois. Cela créera une structure de sous-répertoire libudf contenant la bibliothèque partagée <code>libudf.so</code> requise. Le répertoire libudf ne peut pas être simplement copié d'un système distant (comme votre ordinateur portable) vers l'Alliance car les dépendances de la bibliothèque partagée ne seront pas satisfaites, ce qui fera planter Fluent au démarrage. Cela dit, une fois que vous avez compilé votre UDF sur une de nos grappes, vous pouvez transférer la libudf nouvellement créée vers n'importe quel autre de nos grappes, à condition que votre compte charge la même version du module d'environnement StdEnv. Une fois copiée, l'UDF peut être utilisée en supprimant le commentaire de la deuxième ligne (load) libudf ci-dessous dans votre fichier de journalisation quand une tâche est soumise. Les deux lignes libudf (compile et load) ne doivent pas être laissées sans commentaire lors de la soumission de tâches, sinon votre UDF sera automatiquement (re)compilée pour chaque tâche. Non seulement cette méthode est très inefficace, mais elle peut également entraîner des conflits de build de type «&#160;racetime&#160;» si plusieurs tâches sont exécutées à partir du même répertoire. Outre la configuration de votre fichier de journalisation pour construire votre UDF, l'interface graphique de Fluent (exécutée sur n'importe quel nœud de calcul ou sur gra-vdi) peut également être utilisée. Pour ce faire, ajoutez le fichier source UDF dans la boîte de dialogue <i>Compiled UDFs</i>, et cliquez sur <i>Build</i>. Lorsque vous utilisez une UDF compilée avec des tâches parallèles, votre fichier source doit être parallélisé comme indiqué dans la section ci-dessous.
</p>
<pre>define/user-defined/compiled-functions compile libudf yes sampleudf.c "" ""
</pre>
<p>et/ou
</p>
<pre>define/user-defined/compiled-functions load libudf
</pre>
<h4><span id="Parall.C3.A8le"></span><span class="mw-headline" id="Parallèle">Parallèle</span></h4>
<p>Avant qu'une UDF puisse être utilisée avec une tâche parallèle Fluent (SMP à nœud unique et MPI à nœuds multiples), elle doit être parallélisée. En procédant ainsi, nous contrôlons comment/quels processus (hôte et/ou calcul) exécutent des parties spécifiques du code UDF lorsque Fluent est exécuté en parallèle sur la grappe. La procédure d'instrumentation consiste à ajouter des directives de compilation, des prédicats et des macros de réduction dans votre UDF séquentielle. Si vous ne le faites pas, Fluent fonctionnera lentement au mieux ou plantera immédiatement au pire. Le résultat final sera une UDF unique qui s'exécute efficacement lorsque Fluent est utilisé à la fois en mode séquentiel et en mode parallèle. Le sujet est décrit en détail dans <i>Fluent Customization Manual, Part I: Chapter 7: Parallel Considerations</i> qui se trouve dans la <a class="mw-selflink-fragment" href="#Documentation_en_ligne">Documentation en ligne</a>.
</p>
<h4><span class="mw-headline" id="DPM">DPM</span></h4>
<p>Les UDF peuvent être utilisées pour personnaliser les modèles de phase discrète (DPM pour <i>Discrete Phase Models</i>) comme décrit dans <i>2024R2 Fluent Users Guide, Part III: Solution Mode, Chapter 24: Modeling Discrete Phase, 24.2 Steps for Using the Discrete Phase Models,</i> et dans <i>2024R2 Fluent Customization Manual, Part I: Creating and Using User Defined Functions, Chapter 2: DEFINE Macros, 2.5 Discrete Phase Model (DPM) DEFINE Macros</i>. Avant qu'une UDF basée sur DMP puisse être utilisée dans une simulation, l'injection d'un ensemble de particules doit être définie en spécifiant des <i>Point Properties</i> avec des variables telles que la position de la source, la trajectoire initiale, le débit massique, la durée, la température, etc., en fonction du type d'injection. Cela peut être fait dans l'interface graphique en cliquant sur le panneau <i>Physics--&gt; Discrete Phase</i>, puis en cliquant sur le bouton <i>Injections</i>. Cela ouvrira la boîte de dialogue <i>Injections</i> dans laquelle une ou plusieurs injections peuvent être créées en cliquant sur le bouton <i>Create</i>. La boîte de dialogue <i>Set Injection Properties</i> contient le menu déroulant <i>Injection Type</i> avec les quatre premiers types disponibles (<i>single, group, surface, flat-fan-atomizer</i>). Si vous sélectionnez l'un de ces types, vous pouvez alors sélectionner l'onglet <i>Point Properties</i> pour saisir les champs de valeurs correspondants. Une autre façon de spécifier les <i>Point Properties</i> serait de lire un fichier texte d'injection. Pour ce faire, sélectionnez <i>File</i> dans le menu déroulant <i>Injection Type</i>, spécifiez le nom de l'injection à créer, puis cliquez sur le bouton <i>File</i> (situé à côté du bouton <i>OK</i> en bas de la boîte de dialogue <i>Set Injection Properties</i>). Ici, vous pouvez sélectionner un fichier d'échantillon d'injection (avec l'extension .dpm) ou un fichier texte d'injection créé manuellement. Pour ce faire, dans la boîte de dialogue <i>Select File</i>, sélectionnez <i>All Files (*)</i>, puis mettez en surbrillance le fichier qui pourrait avoir n'importe quel nom arbitraire mais qui a généralement une extension .inj; cliquez sur le bouton OK. En supposant qu'il n'y ait aucun problème avec le fichier, aucun message d'erreur ou d'avertissement de la console n'apparaîtra dans Fluent. Lorsque vous serez retourné à la boîte de dialogue  <i>Injection</i>, vous devriez voir le même nom d'injection que celui que vous avez spécifié dans la boîte de dialogue <i>Set Injection Properties</i> et pouvoir répertorier ses particules et propriétés dans la console. Ouvrez ensuite la boîte de dialogue <i>Discrete Phase Model</i> et sélectionnez <i>Interaction with Continuous Phase</i> qui permettra de mettre à jour les termes sources DPM à chaque itération de flux. Ce paramètre peut être enregistré dans votre fichier cas ou ajouté via le fichier de journalisation comme indiqué. Une fois que l'injection est confirmée comme fonctionnant dans l'interface graphique, les étapes peuvent être automatisées en ajoutant des commandes au fichier de journalisation après l'initialisation de la solution, par exemple&#160;:
/define/models/dpm/interaction/coupled-calculations yes
/define/models/dpm/injections/delete-injection injection-0:1
/define/models/dpm/injections/create injection-0:1 no yes file no zinjection01.inj no no no no
/define/models/dpm/injections/list-particles injection-0:1
/define/models/dpm/injections/list-injection-properties injection-0:1
où un format de fichier stable d'injection de base créé manuellement pourrait ressembler à&#160;:
$ cat zinjection01.inj
(z=4 12)
( x y z u v w diamètre t débit massique fréquence massique temps nom )
(( 2.90e-02 5.00e-03 0.0 -1,00e-03 0,0 0,0 1,00e-04 2,93e+02 1,00e-06 0,0 0,0 0,0 ) injection-0:1 )
notant que les fichiers d'injection pour les simulations DPM sont généralement configurés pour un suivi stationnaire ou instable de particules, le format du premier étant décrit dans <i>2024R2 Fluent Customization Manual, Part III: Solution Mode | Chapter 24: Modeling Discrete Phase | 24.3. Setting Initial Conditions for the Discrete Phase | 24.3.13 Point Properties for File Injections | 24.3.13.1 Steady File Format</i>.
</p>
<h2><span class="mw-headline" id="Ansys_CFX">Ansys CFX</span></h2>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm_2"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm_2">Scripts pour l'ordonnanceur Slurm</span></h3>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-5-0" name="tabs-5" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-5-1" name="tabs-5" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-5-1" data-tabpos="1">Nœud simple</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-5-2" name="tabs-5" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-5-2" data-tabpos="2">Plusieurs nœuds</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-local.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+single+compute+node+%28do+not+change%29%0A%23SBATCH+--ntasks-per-node%3D4+++%23+Specify+number+cores+%28maximum+values%3A+graham+32+or+44%2C+cedar+32+or+48%2C+beluga+40%2C+narval+64%29%0A%23SBATCH+--mem%3D16G+++++++++++++%23+Specify+node+memory+%28optionally+set+to+0+to+allocate+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Applies+to%3A+beluga%2C+cedar%2C+graham%2C+narval%0Amodule+load+ansys%2F2023R2++++++%23+Specify+2021R1+or+newer+module+versions%0A%0A%23+append+additional+cfx5solve+command+line+options+as+required%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+narval+%5D%5D%3B+then%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Open+MPI+Local+Parallel%22+-part+%24SLURM_CPUS_ON_NODE%0Aelse%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Intel+MPI+Local+Parallel%22+-part+%24SLURM_CPUS_ON_NODE%0Afi" />
<input type="hidden" name="filename" value="script-local.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify single compute node (do not change)</span>
<span class="c1">#SBATCH --ntasks-per-node=4   # Specify number cores (maximum values: graham 32 or 44, cedar 32 or 48, beluga 40, narval 64)</span>
<span class="c1">#SBATCH --mem=16G             # Specify node memory (optionally set to 0 to allocate all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Applies to: beluga, cedar, graham, narval</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify 2021R1 or newer module versions</span>

<span class="c1"># append additional cfx5solve command line options as required</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Open MPI Local Parallel&quot;</span><span class="w"> </span>-part<span class="w"> </span><span class="nv">$SLURM_CPUS_ON_NODE</span>
<span class="k">else</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Intel MPI Local Parallel&quot;</span><span class="w"> </span>-part<span class="w"> </span><span class="nv">$SLURM_CPUS_ON_NODE</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-cfx-multiple.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D2+++++++++++++%23+Specify+multiple+compute+nodes+%282+or+more%29%0A%23SBATCH+--ntasks-per-node%3D64++%23+Specify+all+cores+per+node+%28graham+32+or+44%2C+cedar+32+or+48%2C+beluga+40%2C+narval+64%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Use+all+memory+per+compute+node+%28do+not+change%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Applies+to%3A+beluga%2C+cedar%2C+graham%2C+narval%0Amodule+load+ansys%2F2023R2++++++%23+Specify+2021R1+or+newer+module+versions%0A%0ANNODES%3D%24%28slurm_hl2hl.py+--format+ANSYS-CFX%29%0A%0A%23+append+additional+cfx5solve+command+line+options+as+required%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+narval+%5D%5D%3B+then%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Open+MPI+Distributed+Parallel%22+-par-dist+%24NNODES%0Aelse%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Intel+MPI+Distributed+Parallel%22+-par-dist+%24NNODES%0Afi" />
<input type="hidden" name="filename" value="script-cfx-multiple.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=2             # Specify multiple compute nodes (2 or more)</span>
<span class="c1">#SBATCH --ntasks-per-node=64  # Specify all cores per node (graham 32 or 44, cedar 32 or 48, beluga 40, narval 64)</span>
<span class="c1">#SBATCH --mem=0               # Use all memory per compute node (do not change)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Applies to: beluga, cedar, graham, narval</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify 2021R1 or newer module versions</span>

<span class="nv">NNODES</span><span class="o">=</span><span class="k">$(</span>slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-CFX<span class="k">)</span>

<span class="c1"># append additional cfx5solve command line options as required</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Open MPI Distributed Parallel&quot;</span><span class="w"> </span>-par-dist<span class="w"> </span><span class="nv">$NNODES</span>
<span class="k">else</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Intel MPI Distributed Parallel&quot;</span><span class="w"> </span>-par-dist<span class="w"> </span><span class="nv">$NNODES</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
</div></div>
<h2><span class="mw-headline" id="Workbench">Workbench</span></h2>
<p>Initialisez le fichier de projet avant de le soumettre pour la première fois.<br />
</p>
<ol><li>Connectez-vous à la grappe avec <a href="/wiki/VNC/fr#Nœuds_de_calcul" title="VNC/fr">TigerVNC</a>.</li>
<li>Dans le même répertoire où se trouve le fichier de projet (YOURPROJECT.wbpj), <a class="mw-selflink-fragment" href="#Workbench_3">lancez Workbench</a> avec la même version du module Ansys qui a servi à créer le projet.</li>
<li>Dans Workbench, ouvrez le projet avec <i>File -&gt; Open</i>.</li>
<li>Dans la fenêtre principale, faites un clic droit sur <i>Setup</i> et sélectionnez <i>Clear All Generated Data</i>.</li>
<li>Dans la liste déroulante de la barre de menus du haut, cliquez sur <i>File -&gt; Exit</i> pour sortir de Workbench.</li>
<li>Dans la fenêtre contextuelle Ansys Workbench qui affiche <i>The current project has been modified. Do you want to save it&#160;?</i> cliquez sur le bouton <i>No</i>.</li>
<li>Quittez Workbench et soumettez la tâche avec un des scripts ci-dessous.</li></ol>
<p>Pour ne pas écrire la solution quand une tâche en cours se termine avec succès sur une grappe,  enlevez <code>;Save(Overwrite=True)</code> de la dernière ligne du script Slurm. Il sera ainsi plus facile d'effectuer plusieurs tâches de test (pour une mise à l'échelle quand vous changez ntasks) puisque la solution initialisée ne sera pas écrasée à chaque fois et donc n'aura pas besoin d'être réinitialisée entre les tâches. Ou encore, vous pouvez sauvegarder une copie du fichier initialisé YOURPROJECT.wbpj et du sous-répertoire YOURPROJECT_files avant que chaque tâche soit soumise et les restaurer ensuite une fois que la solution est écrite.
</p>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm_3"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm_3">Scripts pour l'ordonnanceur Slurm</span></h3>
<p>Pour soumettre un fichier de projet à la queue, personnaliser les scripts suivants et lancer la commande <code>sbatch script-wbpj.sh</code>.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-6-0" name="tabs-6" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-6-1" name="tabs-6" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-6-1" data-tabpos="1">Nœud simple (StdEnv/2020)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-wbpj-2020.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-account%0A%23SBATCH+--time%3D00-03%3A00++++++++++++++++%23+Time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++++++++++%23+Total+Memory+%28set+to+0+for+all+node+memory%29%0A%23SBATCH+--ntasks%3D4+++++++++++++++++++++%23+Number+of+cores%0A%23SBATCH+--nodes%3D1++++++++++++++++++++++%23+Do+not+change+%28multi-node+not+supported%29%0A%23%23SBATCH+--exclusive+++++++++++++++++++%23+Uncomment+for+scaling+testing%0A%23%23SBATCH+--constraint%3Dbroadwell++++++++%23+Applicable+to+graham+or+cedar%0A%0Amodule+load+StdEnv%2F2020+ansys%2F2021R2+++%23+OR+newer+Ansys+modules%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++MEMPAR%3D0+++++++++++++++++++++++++++++++%23+Set+to+0+for+SMP+%28shared+memory+parallel%29%0Aelse%0A++MEMPAR%3D1+++++++++++++++++++++++++++++++%23+Set+to+1+for+DMP+%28distributed+memory+parallel%29%0Afi%0A%0Arm+-fv+%2A_files%2F.lock%0AMWFILE%3D%7E%2F.mw%2FApplication%5C+Data%2FAnsys%2F%60basename+%24%28find+%24EBROOTANSYS%2Fv%2A+-maxdepth+0+-type+d%29%60%2FSolveHandlers.xml%0Ased+-re+%22s%2F%28.AnsysSolution%3E%2B%29%5Ba-zA-Z0-9%5D%2A%28%3C%5C%2FDistribute.%29%2F%5C1%24MEMPAR%5C2%2F%22+-i+%22%24MWFILE%22%0Ased+-re+%22s%2F%28.Processors%3E%2B%29%5Ba-zA-Z0-9%5D%2A%28%3C%5C%2FMaxNumber.%29%2F%5C1%24SLURM_NTASKS%5C2%2F%22+-i+%22%24MWFILE%22%0Ased+-i+%22s%21UserConfigured%3D%5C%220%5C%22%21UserConfigured%3D%5C%221%5C%22%21g%22+%22%24MWFILE%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aexport+I_MPI_HYDRA_BOOTSTRAP%3Dssh%0A%0Arunwb2+-B+-E+%22Update%28%29%3BSave%28Overwrite%3DTrue%29%22+-F+YOURPROJECT.wbpj" />
<input type="hidden" name="filename" value="script-wbpj-2020.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-account</span>
<span class="c1">#SBATCH --time=00-03:00                # Time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G                      # Total Memory (set to 0 for all node memory)</span>
<span class="c1">#SBATCH --ntasks=4                     # Number of cores</span>
<span class="c1">#SBATCH --nodes=1                      # Do not change (multi-node not supported)</span>
<span class="c1">##SBATCH --exclusive                   # Uncomment for scaling testing</span>
<span class="c1">##SBATCH --constraint=broadwell        # Applicable to graham or cedar</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020<span class="w"> </span>ansys/2021R2<span class="w">   </span><span class="c1"># OR newer Ansys modules</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nv">MEMPAR</span><span class="o">=</span><span class="m">0</span><span class="w">                               </span><span class="c1"># Set to 0 for SMP (shared memory parallel)</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">MEMPAR</span><span class="o">=</span><span class="m">1</span><span class="w">                               </span><span class="c1"># Set to 1 for DMP (distributed memory parallel)</span>
<span class="k">fi</span>

rm<span class="w"> </span>-fv<span class="w"> </span>*_files/.lock
<span class="nv">MWFILE</span><span class="o">=</span>~/.mw/Application<span class="se">\ </span>Data/Ansys/<span class="sb">`</span>basename<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span><span class="nv">$EBROOTANSYS</span>/v*<span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">0</span><span class="w"> </span>-type<span class="w"> </span>d<span class="k">)</span><span class="sb">`</span>/SolveHandlers.xml
sed<span class="w"> </span>-re<span class="w"> </span><span class="s2">&quot;s/(.AnsysSolution&gt;+)[a-zA-Z0-9]*(&lt;\/Distribute.)/\1</span><span class="nv">$MEMPAR</span><span class="s2">\2/&quot;</span><span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>
sed<span class="w"> </span>-re<span class="w"> </span><span class="s2">&quot;s/(.Processors&gt;+)[a-zA-Z0-9]*(&lt;\/MaxNumber.)/\1</span><span class="nv">$SLURM_NTASKS</span><span class="s2">\2/&quot;</span><span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s!UserConfigured=\&quot;0\&quot;!UserConfigured=\&quot;1\&quot;!g&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
<span class="nb">export</span><span class="w"> </span><span class="nv">I_MPI_HYDRA_BOOTSTRAP</span><span class="o">=</span>ssh

runwb2<span class="w"> </span>-B<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;Update();Save(Overwrite=True)&quot;</span><span class="w"> </span>-F<span class="w"> </span>YOURPROJECT.wbpj
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h2><span class="mw-headline" id="Mechanical">Mechanical</span></h2>
<p>Le fichier d'entrée peut être généré dans votre session interactive Workbench Mechanical en cliquant sur <i>Solution -&gt; Tools -&gt; Write Input Files</i> et en spécifiant <code>File name:</code> pour YOURAPDLFILE.inp et <code>Save as type:</code> pour les fichiers APDL en entrée (*.inp).  Les tâches APDL peuvent ensuite être soumises à la queue avec la commande <code>sbatch script-name.sh</code>.
</p>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm_4"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm_4">Scripts pour l'ordonnanceur Slurm</span></h3>
<p>Les modules Ansys dans les scripts suivants ont été testés sur Graham et devraient fonctionner sans problème (supprimez les marques de commentaire).  S'il y a lieu, ils seront mis à jour une fois qu'ils auront été testés sur d'autres grappes.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-7-0" name="tabs-7" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-7-1" name="tabs-7" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-7-1" data-tabpos="1">Nœud simple (StdEnv/2020)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-7-2" name="tabs-7" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-7-2" data-tabpos="2">Script pour plusieurs nœuds (StdEnv/2020)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-smp-2020.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++%23+Specify+memory+for+all+cores%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+number+of+cores+%281+or+more%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Specify+one+node+%28do+not+change%29%0A%0Aunset+SLURM_GTIDS%0A%0Amodule+load+StdEnv%2F2020%0A%0A%23module+load+ansys%2F2021R2%0A%23module+load+ansys%2F2022R1%0Amodule+load+ansys%2F2022R2%0A%0Amapdl+-smp+-b+nolist+-np+%24SLURM_NTASKS+-dir+%24SLURM_TMPDIR+-I+YOURAPDLFILE.inp%0A%0Arm+-rf+results-%2A%0Amkdir+results-%24SLURM_JOB_ID%0Acp+-a+--no-preserve%3Downership+%24SLURM_TMPDIR%2F%2A+results-%24SLURM_JOB_ID" />
<input type="hidden" name="filename" value="script-smp-2020.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account  # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G              # Specify memory for all cores</span>
<span class="c1">#SBATCH --ntasks=8             # Specify number of cores (1 or more)</span>
<span class="c1">#SBATCH --nodes=1              # Specify one node (do not change)</span>

<span class="nb">unset</span><span class="w"> </span>SLURM_GTIDS

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020

<span class="c1">#module load ansys/2021R2</span>
<span class="c1">#module load ansys/2022R1</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2022R2

mapdl<span class="w"> </span>-smp<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span><span class="w"> </span>-I<span class="w"> </span>YOURAPDLFILE.inp

rm<span class="w"> </span>-rf<span class="w"> </span>results-*
mkdir<span class="w"> </span>results-<span class="nv">$SLURM_JOB_ID</span>
cp<span class="w"> </span>-a<span class="w"> </span>--no-preserve<span class="o">=</span>ownership<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>/*<span class="w"> </span>results-<span class="nv">$SLURM_JOB_ID</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-dis-2020.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem-per-cpu%3D2G+++++++%23+Specify+memory+per+core%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+number+of+cores+%282+or+more%29%0A%23%23SBATCH+--nodes%3D2+++++++++++++%23+Specify+number+of+nodes+%28optional%29%0A%23%23SBATCH+--ntasks-per-node%3D4+++%23+Specify+cores+per+node+%28optional%29%0A%0Aunset+SLURM_GTIDS%0A%0Amodule+load+StdEnv%2F2020%0A%0Amodule+load+ansys%2F2022R2%0A%0Amapdl+-dis+-mpi+openmpi+-b+nolist+-np+%24SLURM_NTASKS+-dir+%24SLURM_TMPDIR+-I+YOURAPDLFILE.inp%0A%0Arm+-rf+results-%2A%0Amkdir+results-%24SLURM_JOB_ID%0Acp+-a+--no-preserve%3Downership+%24SLURM_TMPDIR%2F%2A+results-%24SLURM_JOB_ID" />
<input type="hidden" name="filename" value="script-dis-2020.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account  # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem-per-cpu=2G       # Specify memory per core</span>
<span class="c1">#SBATCH --ntasks=8             # Specify number of cores (2 or more)</span>
<span class="c1">##SBATCH --nodes=2             # Specify number of nodes (optional)</span>
<span class="c1">##SBATCH --ntasks-per-node=4   # Specify cores per node (optional)</span>

<span class="nb">unset</span><span class="w"> </span>SLURM_GTIDS

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020

module<span class="w"> </span>load<span class="w"> </span>ansys/2022R2

mapdl<span class="w"> </span>-dis<span class="w"> </span>-mpi<span class="w"> </span>openmpi<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span><span class="w"> </span>-I<span class="w"> </span>YOURAPDLFILE.inp

rm<span class="w"> </span>-rf<span class="w"> </span>results-*
mkdir<span class="w"> </span>results-<span class="nv">$SLURM_JOB_ID</span>
cp<span class="w"> </span>-a<span class="w"> </span>--no-preserve<span class="o">=</span>ownership<span class="w"> </span><span class="nv">$SLURM_TMPDIR</span>/*<span class="w"> </span>results-<span class="nv">$SLURM_JOB_ID</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<p>Par défaut, Ansys alloue aux tâches APDL 1024Mo de mémoire totale et 1024Mo de mémoire pour les bases de données. Ces valeurs peuvent être définies manuellement (ou modifiées) avec l'ajout des arguments <code>-m 1024</code> et/ou <code>-db 1024</code> sur la dernière ligne de commande mapdl des scripts ci-dessus. Si vous utilisez à distance un serveur de licence de votre établissement qui a plusieurs licences Ansys, il pourrait être nécessaire d'ajouter des arguments comme <code>-p aa_r</code> ou <code>-ppf anshpc</code>, selon le module que vous utilisez. Comme d'habitude, effectuez des tests détaillés de mise à l'échelle avant de lancer des tâches en production pour vous assurer que vous utilisez le nombre optimal de cœurs et la bonne quantité minimale de mémoire. Les scripts pour nœud simple avec mémoire parallèle partagée (SMP pour <i>Shared Memory Parallel</i>) offriront une meilleure performance que les scripts pour plusieurs nœuds avec mémoire parallèle distribuée (DMP pour <i>Distributed Memory Parallel</i>) et devraient être utilisés autant que possible.  Pour prévenir les problèmes de compatibilité, le module qui est chargé dans votre script devrait idéalement correspondre à la version employée pour générer le fichier en entrée.
</p>
<pre> [gra-login2:~/ansys/mechanical/demo] cat YOURAPDLFILE.inp | grep version
! ANSYS input file written by Workbench version 2019 R3
</pre>
<h2><span class="mw-headline" id="Ansys_EDT">Ansys EDT</span></h2>
<p>Ansys EDT peut être exécuté de manière interactive en mode <i>batch</i> (sans interface graphique) en démarrant d'abord une session salloc avec les options <code>salloc --time=3:00:00 --tasks=8 --mem=16G --account=def- compte</code>; copiez-collez ensuite la commande <code>ansysedt</code> complète donnée à la dernière ligne de <i>script-local-cmd.sh</i> en vous assurant de spécifier manuellement $YOUR_AEDT_FILE.
</p>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm_5"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm_5">Scripts pour l'ordonnanceur Slurm</span></h3>
<p>Les tâches Ansys Electronic Desktop peuvent être soumises à la file d'attente d'une grappe avec la commande <code>sbatch script-name.sh</code> en utilisant l'un des scripts Slurm pour nœud simple ci-dessous. En date de janvier 2023, ces scripts n'ont été testés que sur Graham et pourraient donc être mis à jour à l'avenir si nécessaire pour fonctionner avec d'autres grappes. Avant de les utiliser, spécifiez le temps de simulation, la mémoire, le nombre de cœurs et remplacez YOUR_AEDT_FILE par le nom de votre fichier d'entrée. Une liste complète des options de ligne de commande ansysedt peut être obtenue en démarrant Ansys EDT en <a class="mw-selflink-fragment" href="#Mode_graphique">mode graphique</a> avec les commandes <code>ansysedt -help</code> ou <code>ansysedt -Batchoptionhelp</code> pour obtenir des fenêtres contextuelles graphiques déroulantes.  
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-8-0" name="tabs-8" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-8-1" name="tabs-8" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-8-1" data-tabpos="1">Nœud simple (ligne de commande)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-8-2" name="tabs-8" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-8-2" data-tabpos="2">Nœud simple (fichier d&amp;#039;options)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-local-cmd.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+compute+node+memory%29%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+cores+%28beluga+40%2C+cedar+32+or+48%2C+graham+32+or+44%2C+narval+64%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28Do+Not+Change%29%0A%0Amodule+load+StdEnv%2F2020%0Amodule+load+ansysedt%2F2021R2%0A%0A%23+Uncomment+next+line+to+run+a+test+example%3A%0Acp+-f+%24EBROOTANSYSEDT%2FAnsysEM21.2%2FLinux64%2FExamples%2FHFSS%2FAntennas%2FTransientGeoRadar.aedt+.%0A%0A%23+Specify+input+file+such+as%3A%0AYOUR_AEDT_FILE%3D%22TransientGeoRadar.aedt%22%0A%0A%23+Remove+previous+output%3A%0Arm+-rf+%24YOUR_AEDT_FILE.%2A+%24%7BYOUR_AEDT_FILE%7Dresults%0A%0A%23+----+do+not+change+anything+below+this+line+----+%23%0A%0Aecho+-e+%22%5CnANSYSLI_SERVERS%3D+%24ANSYSLI_SERVERS%22%0Aecho+%22ANSYSLMD_LICENSE_FILE%3D+%24ANSYSLMD_LICENSE_FILE%22%0Aecho+-e+%22SLURM_TMPDIR%3D+%24SLURM_TMPDIR+on+%24SLURMD_NODENAME%5Cn%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aansysedt+-monitor+-UseElectronicsPPE+-ng+-distributed+-machinelist+list%3Dlocalhost%3A1%3A%24SLURM_NTASKS+%5C%0A-batchoptions+%22TempDirectory%3D%24SLURM_TMPDIR+HPCLicenseType%3Dpool+HFSS%2FEnableGPU%3D0%22+-batchsolve+%22%24YOUR_AEDT_FILE%22" />
<input type="hidden" name="filename" value="script-local-cmd.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G              # Specify memory (set to 0 to use all compute node memory)</span>
<span class="c1">#SBATCH --ntasks=8             # Specify cores (beluga 40, cedar 32 or 48, graham 32 or 44, narval 64)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (Do Not Change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020
module<span class="w"> </span>load<span class="w"> </span>ansysedt/2021R2

<span class="c1"># Uncomment next line to run a test example:</span>
cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$EBROOTANSYSEDT</span>/AnsysEM21.2/Linux64/Examples/HFSS/Antennas/TransientGeoRadar.aedt<span class="w"> </span>.

<span class="c1"># Specify input file such as:</span>
<span class="nv">YOUR_AEDT_FILE</span><span class="o">=</span><span class="s2">&quot;TransientGeoRadar.aedt&quot;</span>

<span class="c1"># Remove previous output:</span>
rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$YOUR_AEDT_FILE</span>.*<span class="w"> </span><span class="si">${</span><span class="nv">YOUR_AEDT_FILE</span><span class="si">}</span>results

<span class="c1"># ---- do not change anything below this line ---- #</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nANSYSLI_SERVERS= </span><span class="nv">$ANSYSLI_SERVERS</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE= </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SLURM_TMPDIR= </span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> on </span><span class="nv">$SLURMD_NODENAME</span><span class="s2">\n&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
ansysedt<span class="w"> </span>-monitor<span class="w"> </span>-UseElectronicsPPE<span class="w"> </span>-ng<span class="w"> </span>-distributed<span class="w"> </span>-machinelist<span class="w"> </span><span class="nv">list</span><span class="o">=</span>localhost:1:<span class="nv">$SLURM_NTASKS</span><span class="w"> </span><span class="se">\</span>
-batchoptions<span class="w"> </span><span class="s2">&quot;TempDirectory=</span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> HPCLicenseType=pool HFSS/EnableGPU=0&quot;</span><span class="w"> </span>-batchsolve<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$YOUR_AEDT_FILE</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-local-opt.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++%23+Specify+memory+%28set+to+0+to+allocate+all+compute+node+memory%29%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+cores+%28beluga+40%2C+cedar+32+or+48%2C+graham+32+or+44%2C+narval+64%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28Do+Not+Change%29%0A%0Amodule+load+StdEnv%2F2020%0Amodule+load+ansysedt%2F2021R2%0A%0A%23+Uncomment+next+line+to+run+a+test+example%3A%0Acp+-f+%24EBROOTANSYSEDT%2FAnsysEM21.2%2FLinux64%2FExamples%2FHFSS%2FAntennas%2FTransientGeoRadar.aedt+.%0A%0A%23+indiquer+un+fichier+en+entr%C3%A9e+comme%0AYOUR_AEDT_FILE%3D%22TransientGeoRadar.aedt%22%0A%0A%23+Remove+previous+output%3A%0Arm+-rf+%24YOUR_AEDT_FILE.%2A+%24%7BYOUR_AEDT_FILE%7Dresults%0A%0A%23+Specify+options+filename%3A%0AOPTIONS_TXT%3D%22Options.txt%22%0A%0A%23+Write+sample+options+file%0Arm+-f+%24OPTIONS_TXT%0Acat+%3E+%24OPTIONS_TXT+%3C%3CEOF%0A%5C%24begin+%27Config%27%0A%27TempDirectory%27%3D%27%24SLURM_TMPDIR%27%0A%27HPCLicenseType%27%3D%27pool%27%0A%27HFSS%2FEnableGPU%27%3D0%0A%5C%24end+%27Config%27%0AEOF%0A%0A%23+----+do+not+change+anything+below+this+line+----+%23%0A%0Aecho+-e+%22%5CnANSYSLI_SERVERS%3D+%24ANSYSLI_SERVERS%22%0Aecho+%22ANSYSLMD_LICENSE_FILE%3D+%24ANSYSLMD_LICENSE_FILE%22%0Aecho+-e+%22SLURM_TMPDIR%3D+%24SLURM_TMPDIR+on+%24SLURMD_NODENAME%5Cn%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aansysedt+-monitor+-UseElectronicsPPE+-ng+-distributed+-machinelist+list%3Dlocalhost%3A1%3A%24SLURM_NTASKS+%5C%0A-batchoptions+%24OPTIONS_TXT+-batchsolve+%22%24YOUR_AEDT_FILE%22" />
<input type="hidden" name="filename" value="script-local-opt.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G              # Specify memory (set to 0 to allocate all compute node memory)</span>
<span class="c1">#SBATCH --ntasks=8             # Specify cores (beluga 40, cedar 32 or 48, graham 32 or 44, narval 64)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (Do Not Change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020
module<span class="w"> </span>load<span class="w"> </span>ansysedt/2021R2

<span class="c1"># Uncomment next line to run a test example:</span>
cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$EBROOTANSYSEDT</span>/AnsysEM21.2/Linux64/Examples/HFSS/Antennas/TransientGeoRadar.aedt<span class="w"> </span>.

<span class="c1"># indiquer un fichier en entrée comme</span>
<span class="nv">YOUR_AEDT_FILE</span><span class="o">=</span><span class="s2">&quot;TransientGeoRadar.aedt&quot;</span>

<span class="c1"># Remove previous output:</span>
rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$YOUR_AEDT_FILE</span>.*<span class="w"> </span><span class="si">${</span><span class="nv">YOUR_AEDT_FILE</span><span class="si">}</span>results

<span class="c1"># Specify options filename:</span>
<span class="nv">OPTIONS_TXT</span><span class="o">=</span><span class="s2">&quot;Options.txt&quot;</span>

<span class="c1"># Write sample options file</span>
rm<span class="w"> </span>-f<span class="w"> </span><span class="nv">$OPTIONS_TXT</span>
cat<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$OPTIONS_TXT</span><span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s">\$begin &#39;Config&#39;</span>
<span class="s">&#39;TempDirectory&#39;=&#39;$SLURM_TMPDIR&#39;</span>
<span class="s">&#39;HPCLicenseType&#39;=&#39;pool&#39;</span>
<span class="s">&#39;HFSS/EnableGPU&#39;=0</span>
<span class="s">\$end &#39;Config&#39;</span>
<span class="s">EOF</span>

<span class="c1"># ---- do not change anything below this line ---- #</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nANSYSLI_SERVERS= </span><span class="nv">$ANSYSLI_SERVERS</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE= </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SLURM_TMPDIR= </span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> on </span><span class="nv">$SLURMD_NODENAME</span><span class="s2">\n&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
ansysedt<span class="w"> </span>-monitor<span class="w"> </span>-UseElectronicsPPE<span class="w"> </span>-ng<span class="w"> </span>-distributed<span class="w"> </span>-machinelist<span class="w"> </span><span class="nv">list</span><span class="o">=</span>localhost:1:<span class="nv">$SLURM_NTASKS</span><span class="w"> </span><span class="se">\</span>
-batchoptions<span class="w"> </span><span class="nv">$OPTIONS_TXT</span><span class="w"> </span>-batchsolve<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$YOUR_AEDT_FILE</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h2><span class="mw-headline" id="Ansys_ROCKY">Ansys ROCKY</span></h2>
<p>En plus de pouvoir exécuter des simulations en mode graphique (comme indiqué dans la section <i>Mode graphique</i> ci-dessous), <a rel="nofollow" class="external text" href="https://www.ansys.com/products/fluids/ansys-rocky">Ansys Rocky</a> peut également exécuter des simulations en mode non graphique. Les deux modes prennent en charge l'exécution de Rocky avec des processeurs uniquement ou avec des processeurs et <a rel="nofollow" class="external text" href="https://www.ansys.com/blog/mastering-multi-gpu-ansys-rocky-software-enhancing-its-performance">des GPU</a>. Dans la section ci-dessous, deux exemples de scripts sont fournis où chacun serait soumis à la file d'attente de Graham avec la commande habituelle <code>sbatch</code>. Au moment de la rédaction de cet article, aucun des deux scripts n'a été testé et des modifications seraient probablement nécessaires. Il est important de noter que ces scripts ne sont utilisables que sur Graham puisque le module Rocky qu'ils chargent tous les deux n'est (pour le moment) installé que sur Graham localement.
</p>
<h3><span id="Scripts_pour_l.27ordonnanceur_Slurm_6"></span><span class="mw-headline" id="Scripts_pour_l'ordonnanceur_Slurm_6">Scripts pour l'ordonnanceur Slurm</span></h3>
<p>Pour obtenir une liste complète des options de ligne de commande, exécutez <code>Rocky -h</code> sur la ligne de commande après avoir chargé un module Rocky (seul rocky/2023R2 est présentement disponible sur Graham). En ce qui concerne l'utilisation de Rocky avec des GPU pour résoudre des problèmes couplés, le nombre de CPU que vous devez demander (sur le même nœud) doit être augmenté au maximum jusqu'à ce que la limite de scalabilité de l'application couplée soit atteinte. D'autre part, si Rocky est exécuté avec des GPU pour résoudre des problèmes découplés autonomes, seul un nombre minimal de CPU doit être demandé, ce qui permettra à Rocky de fonctionner de manière optimale; par exemple, seuls 2 ou éventuellement 3 CPU peuvent être nécessaires. Enfin, lorsque Rocky est exécuté avec plus de 4 CPU, des licences <i>rocky_hpc</i> seront nécessaires, ce que fournit la licence SHARCNET.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-9-0" name="tabs-9" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-9-1" name="tabs-9" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-9-1" data-tabpos="1">CPU seulement</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-9-2" name="tabs-9" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-9-2" data-tabpos="2">GPU based</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-rocky-cpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-02%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D24G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D6++++++%23+Specify+cores+%28graham+32+or+44+to+use+all+cores%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28do+not+change%29%0A%0Amodule+load+StdEnv%2F2023%0Amodule+load+rocky%2F2023R2+ansys%2F2023R2+++%23+only+available+on+graham+%28do+not+change%29+++%0A%0ARocky+--simulate+%E2%80%9Cmysim.rocky%E2%80%9D+--resume%3D0+--ncpus%3D%24SLURM_CPUS_PER_TASK+--use-gpu%3D0" />
<input type="hidden" name="filename" value="script-rocky-cpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-02:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=24G              # Specify memory (set to 0 to use all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=6      # Specify cores (graham 32 or 44 to use all cores)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (do not change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
module<span class="w"> </span>load<span class="w"> </span>rocky/2023R2<span class="w"> </span>ansys/2023R2<span class="w">   </span><span class="c1"># only available on graham (do not change)   </span>

Rocky<span class="w"> </span>--simulate<span class="w"> </span>“mysim.rocky”<span class="w"> </span>--resume<span class="o">=</span><span class="m">0</span><span class="w"> </span>--ncpus<span class="o">=</span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--use-gpu<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-rocky-gpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+reg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D24G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D6++++++%23+Specify+cores+%28graham+32+or+44+to+use+all+cores%29%0A%23SBATCH+--gres%3Dgpu%3Av100%3A2++++++%23+Specify+gpu+type+%3A+gpu+quantity%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28do+not+change%29%0A%0Amodule+load+StdEnv%2F2023%0Amodule+load+rocky%2F2023R2+ansys%2F2023R2+++%23+only+available+on+graham+%28do+not+change%29%0A%0ARocky+--simulate+%E2%80%9Cmysim.rocky%E2%80%9D+--resume%3D0+--ncpus%3D%24SLURM_CPUS_PER_TASK+--use-gpu%3D1+--gpu-num%3D%24SLURM_GPUS_ON_NODE" />
<input type="hidden" name="filename" value="script-rocky-gpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or reg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=24G              # Specify memory (set to 0 to use all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=6      # Specify cores (graham 32 or 44 to use all cores)</span>
<span class="c1">#SBATCH --gres=gpu:v100:2      # Specify gpu type&#160;: gpu quantity</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (do not change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
module<span class="w"> </span>load<span class="w"> </span>rocky/2023R2<span class="w"> </span>ansys/2023R2<span class="w">   </span><span class="c1"># only available on graham (do not change)</span>

Rocky<span class="w"> </span>--simulate<span class="w"> </span>“mysim.rocky”<span class="w"> </span>--resume<span class="o">=</span><span class="m">0</span><span class="w"> </span>--ncpus<span class="o">=</span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--use-gpu<span class="o">=</span><span class="m">1</span><span class="w"> </span>--gpu-num<span class="o">=</span><span class="nv">$SLURM_GPUS_ON_NODE</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h1><span class="mw-headline" id="Mode_graphique">Mode graphique</span></h1>
<p>Les programmes Ansys fonctionnent interactivement en mode graphique sur les nœuds de calcul des grappes ou sur les nœuds VDI de Graham.
</p>
<h2><span id="N.C5.93uds_de_calcul"></span><span class="mw-headline" id="Nœuds_de_calcul">Nœuds de calcul</span></h2>
<p>Ansys peut être exécuté interactivement sur un nœud de calcul simple pour une durée pouvant aller jusqu'à 24 heures. C'est l'approche idéale pour tester des simulations intensives puisque tous les cœurs et la mémoire peuvent être demandés avec salloc comme décrit dans <a href="/wiki/VNC/fr#Nœuds_de_calcul" title="VNC/fr">TigerVNC</a>. Une fois la connexion faite avec vncviewer, toutes les versions suivantes peuvent être lancées après que les modules requis ont été chargés.
</p>
<h3><span class="mw-headline" id="Fluids">Fluids</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R1</code> (ou versions plus récentes)</dd>
<dd><code>fluent -mpi=intel</code>, ou</dd>
<dd><code>QTWEBENGINE_DISABLE_SANDBOX=1 cfx5</code></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Mapdl">Mapdl</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R2</code> (ou versions plus récentes)</dd>
<dd><code>mapdl -g</code>, ou via le démarreur,</dd>
<dd><code>launcher</code> --&gt; cliquer sur le bouton RUN</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Workbench_2">Workbench</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R2</code> (ou versions plus récentes)</dd>
<dd><code>xfwm4 --replace &amp;</code> (nécessaire seulement si vous utilisez Ansys Mechanical)</dd>
<dd><code>export QTWEBENGINE_DISABLE_SANDBOX=1</code> (nécessaire seulement si vous utilisez CFD-Post)</dd>
<dd><code>runwb2</code></dd>
<dd><br /></dd>
<dd>Remarques&#160;: Quand vous exécutez en parallèle un programme d'analyse comme  Mechanical or Fluent sur un nœud simple, ne cochez pas la case <i>Distributed</i> et indiquez un nombre de cœurs égal à votre  <b>session salloc, moins 1</b>. Les menus déroulants du Ansys Mechanical Workbench ne répondent pas correctement. Comme solution, lancez <code>xfwm4 --replace</code> sur la ligne de commande avant de démarrer Workbench. Pour avoir xfwm4 par défaut, modifiez <code>$HOME/.vnc/xstartup</code> et remplacez <code>mate-session</code> par <code>xfce4-session</code>. Enfin, Fluent dans ansys/2022R2 ne fonctionne pas en ce moment sur les nœuds de calcul; utilisez une autre version.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ansys_EDT_2">Ansys EDT</span></h3>
<dl><dd><dl><dd><dl><dd>Lancez une session interactive avec le format suivant de la commande salloc (pour spécifier les cœurs et la mémoire disponible)&#160;:</dd>
<dd><code>salloc --time=3:00:00 --nodes=1 --cores=8 --mem=16G --account=def-group</code></dd>
<dd><code>xfwm4 --replace &amp;</code> (appuyez deux fois sur Enter)</dd>
<dd><code>module load StdEnv/2020 ansysedt/2021R2</code>, ou</dd>
<dd><code>module load StdEnv/2020 ansysedt/2023R2</code>, ou</dd>
<dd><code>module load StdEnv/2023 ansysedt/2023R2</code> ou plus récente</dd>
<dd><code>ansysedt</code></dd>
<dd>o Cliquez sur <code>Tools -&gt; Options -&gt; HPC and Analysis Options -&gt; Edit</code>, puis
<dl><dd>1) supprimez la coche de la case Use Automatic Settings (nécessaire une fois seulement)</dd>
<dd>2) sous l'onglet Machines, ne modifiez pas Cores (détecté automatiquement à partir de Slurm)</dd></dl></dd>
<dd>o Pour exécuter l'analyse interactive, cliquez sur  <code>Project -&gt; Analyze All</code></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ensight">Ensight</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020 ansys/2022R2; A=222; B=5.12.6</code>, ou</dd>
<dd><code>module load StdEnv/2020 ansys/2022R1; A=221; B=5.12.6</code>, ou</dd>
<dd><code>module load StdEnv/2020 ansys/2021R2; A=212; B=5.12.6</code>, ou</dd>
<dd><code>module load StdEnv/2020 ansys/2021R1; A=211; B=5.12.6</code>, ou</dd>
<dd><code>export LD_LIBRARY_PATH=$EBROOTANSYS/v$A/CEI/apex$A/machines/linux_2.6_64/qt-$B/lib</code></dd>
<dd><code>ensight -X</code></dd></dl></dd></dl></dd></dl>
<p>Remarque&#160;: ansys/2022R2 Ensight a été peu testé sur les nœuds de calcul; veuillez nous faire part des problèmes que vous rencontrez.
</p>
<h3><span class="mw-headline" id="Rocky">Rocky</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load rocky/2023R2 ansys/2023R2</code> (ou versions plus récentes)</dd>
<dd><code>Rocky</code> (se lit ~/licenses/ansys.lic si le module est présent, affiche autrement le serveur SHARCNET en ligne de commande), ou<br /></dd>
<dd><code>Rocky-int</code> (sélectionner interactivement le serveur CMC ou SHARCNET server; se lit aussi ~/licenses/ansys.lic, gui use)<br /></dd>
<dd><code>RockySolver</code> (exécuter Rocky à partir de la ligne de commande; ceci n'a pas été testé mais vous pouvez entrer "-h" pour <i>help</i>)</dd>
<dd><code>RockySchedular</code> (gestionnaire de ressources pour soumettre plusieurs tâches sur le nœud courant)</dd>
<dd>o Rocky est présentement disponible uniquement sur gra-vdi et la grappe Graham (workbench ne prend pas en charge linux)</dd>
<dd>o La documentation se trouve sur /opt/software/rocky/2023R2/docs (que vous pouvez lire avec <code>mupdf</code>)</dd>
<dd>o Rocky prend en charge le calcul avec GPU accélérés (par contre, aucun test n'a été effectué)</dd>
<dd>o Pour travailler interactivement sur un nœud de calcul sur Graham pour une durée de 8 heures avec 4 CPU et 1 GPU, la commande est</dd>
<dd><code>salloc --time=08:00:00 --nodes=1 --cpus-per-task=4 --gres=gpu:v100:1 --mem=32G --account=someaccount</code></dd>
<dd>o La licence SHARCNET comprend maintenant Rocky (utilisation gratuite pour la recherche)</dd></dl></dd></dl></dd></dl>
<h2><span id="N.C5.93uds_VDI"></span><span class="mw-headline" id="Nœuds_VDI">Nœuds VDI</span></h2>
<p>Les programmes Ansys peuvent être exécutés jusqu'à 7&#160;jours sur les nœuds Graham VDI (gra-vdi.alliancecan.ca) en utilisant un maximum de 8&#160;cœurs (maximum de 16&#160;cœurs) et 128 Go&#160;de mémoire. Le système VDI fournit une accélération GPU OpenGL, ce qui est idéal pour les  graphiques à haute performance. On peut utiliser VDI pour créer ou modifier des fichiers d'entrée de simulation, post-traiter des données ou visualiser des résultats de simulation. Connectez-vous d'abord à gra-vdi.computecanada.ca avec <a href="/wiki/VNC/fr#Nœuds_VDI" title="VNC/fr">TigerVNC</a> puis ouvrez une nouvelle fenêtre de terminal et démarrez l'une des <b>versions de programme prises en charge</b> montrées ci-dessous. La barre verticale <code>|</code> est utilisée pour séparer les commandes. La taille maximale d'une tâche parallèle exécutée sur gra-vdi doit être limitée à 16&#160;cœurs pour éviter de surcharger les serveurs et de nuire aux autres utilisateurs. Pour exécuter deux tâches simultanées (16&#160;cœurs maximum chacune), utilisez deux sessions VCN distinctes. Pour la première session, connectez-vous avec VNC à gra-vdi3.sharcnet.ca. Pour la deuxième session, connectez-vous à gra-vdi4.sharecnet.ca aussi avec VNC. Dans chacune des sessions, démarrez Ansys en mode graphique et faites exécuter la simulation. Notez que les simulations simultanées doivent en général être exécutées dans des répertoires différents pour éviter les conflits de fichiers. Contrairement aux connexions VNC des nœuds de calcul (qui imposent des limites Slurm via salloc), il n'y a pas de contrainte de limite de temps sur gra-vdi lors de l'exécution des simulations.
</p>
<h3><span class="mw-headline" id="Fluids_2">Fluids</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load CcEnv StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R1</code> (ou versions plus récentes)</dd>
<dd><code>unset SESSION_MANAGER</code></dd>
<dd><code>fluent | cfx5 | icemcfd</code></dd>
<dd>o La commande <code>unset SESSION_MANAGER</code> permet d'éviter le message d'erreur suivant au lancement de Fluent.</dd>
<dd>[<span style="Color:#ff7f50">Qt: Session management error: None of the authentication protocols specified are supported</span>]</dd>
<dd>o Si le message suivant est affiché au lancement de icemcfd ...</dd>
<dd>[<span style="Color:#ff7f50">Error segmentation violation - exiting after doing an emergency save</span>]</dd>
<dd>... ne cliquez pas sur le bouton OK, autrement icemcfd va planter. Faites plutôt ce qui suit (une seule fois)&#160;:</dd>
<dd>sélectionnez <i>Settings Tab -&gt; Display -&gt; tick X11 -&gt; Apply -&gt; OK -&gt; File -&gt; Exit</i></dd>
<dd>L'erreur ne devrait pas se produire quand vous démarrez de nouveau icemcfd.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Mapdl_2">Mapdl</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load CcEnv StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R1</code> (ou versions plus récentes)</dd>
<dd><code>mapdl -g</code>, or via launcher,</dd>
<dd><code>unset SESSION_MANAGER; launcher</code> --&gt; cliquez sur le bouton RUN</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Workbench_3">Workbench</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load SnEnv</code></dd>
<dd><code>module load ansys/2020R2</code> (ou versions plus récentes)</dd>
<dd><code>export HOOPS_PICTURE=opengl</code></dd>
<dd><code>runwb2</code></dd>
<dd>o La ligne <code>export HOOPS_PICTURE=opengl</code> permet d'éviter le message suivant au lancement de Fluid.
<dl><dd>[<span style="Color:#ff7f50">Software rasterizer found, hardware acceleration will be disabled.</span>]</dd></dl></dd>
<dd>La variable HOOPS_PICTURE peut aussi être configurée dans Workbench avec
<dl><dd>Fluent Launcher --&gt; Environment Tab --&gt; HOOPS_PICTURE=opengl (sans la commande export)</dd></dl></dd></dl></dd></dl></dd></dl>
<dl><dd><dl><dd><dl><dd>REMARQUE&#160;1&#160;: Lorsque vous exécutez Mechanical dans Workbench sur gra-vdi, assurez-vous de cocher <i>Distributed</i> dans le panneau <i>Solver</i> du ruban supérieur et de spécifier une valeur maximale de <b>24&#160;cœurs</b>. Lorsque vous exécutez Fluent sur gra-vdi, ne cochez pas <i>Distributed</i> et spécifiez une valeur maximale de <b>12&#160;cœurs</b>. N'essayez pas d'utiliser plus de 128Go de mémoire, sinon Ansys atteindra la limite et sera arrêté. Si vous avez besoin de plus de cœurs ou de mémoire, utilisez un nœud de calcul sur une grappe pour exécuter votre session graphique (comme décrit dans la section <i>Nœuds de calcul</i> ci-dessus). Lorsque vous effectuez une ancienne tâche de prétraitement ou de post-traitement avec Ansys sur gra-vdi et que vous n'exécutez pas de calcul, utilisez uniquement <b>4&#160;cœurs</b>, sinon les licences HPC seront extraites inutilement.</dd>
<dd>REMARQUE&#160;2&#160;: Dans de très rares cas, l'interface graphique de Workbench se bloque ou cesse de répondre pour quelconque raison. Si cela se produit, ouvrez une nouvelle fenêtre de terminal et exécutez <code>pkill -9 -e -u $USER -f "ansys|fluent|mwrpcss|mwfwrapper|ENGINE|mono"</code> pour arrêter complètement Ansys. De même, si Ansys plante ou si vncviewer se déconnecte avant qu'Ansys ne puisse être arrêté correctement, essayez d'exécuter la commande <code>pkill</code> si Ansys ne fonctionne pas normalement par la suite. En général, si Ansys ne se comporte pas correctement et que vous soupçonnez l'une des causes ci-dessus, essayez <code>pkill</code> avant de faire une demande d'assistance.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ansys_EDT_3">Ansys EDT</span></h3>
<dl><dd><dl><dd><dl><dd>Ouvrez une fenêtre de terminal et chargez le module avec
<dl><dd><code>module load SnEnv ansysedt/2023R2</code>, ou</dd>
<dd><code>module load SnEnv ansysedt/2021R2</code></dd></dl></dd>
<dd>Dans le terminal, entrez <code>ansysedt</code> et attendez que l'interface s'affiche.</dd>
<dd>Ceci doit être fait une seule fois&#160;:
<dl><dd>sélectionnez <i>Tools -&gt; Options -&gt; HPC and Analysis Options -&gt; Options</i></dd>
<dd>dans le menu déroulant, changez <i>HPC License</i> pour <i><b>Pool</b></i> (pour utiliser plus de 4 cœurs)</dd>
<dd>cliquez sur <i>OK</i></dd></dl></dd>
<dd>----------   EXEMPLES  ----------</dd>
<dd>Pour copier dans votre compte les exemples Antennas de 2023R2&#160;:
<dl><dd>connectez-vous à une grappe (par exemple Graham)</dd>
<dd><code>module load ansysedt/2023R2</code></dd>
<dd><code>mkdir -p ~/Ansoft/$EBVERSIONANSYSEDT; cd ~/Ansoft/$EBVERSIONANSYSEDT; rm -rf Antennas</code></dd>
<dd><code>cp -a $EBROOTANSYSEDT/v232/Linux64/Examples/HFSS/Antennas ~/Ansoft/$EBVERSIONANSYSEDT</code></dd></dl></dd>
<dd>Pour faire exécuter un exemple&#160;:
<dl><dd>ouvrez un fichier .aedt et cliquez sur <i>HFSS -&gt; Validation Check</i></dd>
<dd>(si la validation produit une erreur, fermez et ouvrez de nouveau la simulation autant de fois que nécessaire)</dd>
<dd>pour lancer la simulation, cliquez sur <i>Project -&gt; Analyze All</i></dd>
<dd>pour quitter sans sauvegarder la solution, cliquez sur <i>File -&gt; Close -&gt; No </i></dd></dl></dd>
<dd>si le programme plante et ne repart pas, essayez les commandes suivantes&#160;:
<dl><dd><code>pkill -9 -u $USER -f "ansys*|mono|mwrpcss|apip-standalone-service"</code></dd>
<dd><code>rm -rf ~/.mw</code> (au lancement, ansysedt utilisera la configuration initiale)</dd></dl></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ensight_2">Ensight</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load SnEnv ansys/2019R2</code> (ou version plus récente)</dd>
<dd><code>ensight</code><br /></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Rocky_2">Rocky</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load clumod rocky/2023R2 CcEnv StdEnv/2020 ansys/2023R2</code> (ou versions plus récentes)</dd>
<dd><code>Rocky</code> (s'il existe, lit  ~/licenses/ansys.lic, autrement utilise le serveur SHARCNET par défaut), ou<br /></dd>
<dd><code>Rocky-int</code> (sélectionnez interactivement le serveur CMC ou SHARCNET; lit aussi ~/licenses/ansys.lic)<br /></dd>
<dd><code>RockySolver</code> (lancez Rocky à partir de la ligne de commande; ceci n'a pas été testé mais vous pouvez entrer "-h" pour <i>help</i>)</dd>
<dd><code>RockySchedular</code> (gestionnaire de ressources pour soumettre plusieurs tâches sur le nœud courant)</dd>
<dd>o Rocky est présentement disponible uniquement sur gra-vdi et la grappe Graham (Workbench n'est pas supporté par linux)</dd>
<dd>o La documentation se trouve sur /opt/software/rocky/2023R2/docs (que vous pouvez lire avec <code>mupdf</code>)</dd>
<dd>o Rocky ne peut utiliser que des CPU sur gra-vdi puisqu'il n'y a présentement qu'un seul GPU dédié aux graphiques</dd>
<dd>o La licence SHARCNET inclut maintenant Rocky dont l'utilisation est sans frais pour la recherche</dd></dl></dd></dl></dd></dl>
<h2><span id="Probl.C3.A8mes_avec_SSH"></span><span class="mw-headline" id="Problèmes_avec_SSH">Problèmes avec SSH</span></h2>
<dl><dd><dl><dd><dl><dd>Certains programmes d'interface graphique ANSYS peuvent être exécutés à distance sur un nœud de calcul d'une de nos grappes par redirection X via SSH vers votre ordinateur local. Contrairement à VNC, cette approche n'est ni testée ni prise en charge car elle repose sur un serveur d'affichage X correctement configuré pour votre système d'exploitation particulier OU sur la sélection, l'installation et la configuration d'un paquet d'émulateur client X approprié tel que MobaXterm. La plupart d'entre vous trouverez les temps de réponse interactifs inacceptables pour les tâches de menu de base, sans parler de l'exécution de tâches plus complexes telles que celles nécessitant du rendu graphique. Les temps d'attente pour démarrer des programmes avec interface graphique peuvent également être très longs, dépendant de votre connexion Internet. Dans un test par exemple, il a fallu 40&#160;minutes pour démarrer complètement <i>ansysedt</i> sur SSH alors que vncviewer n'a pris que 34&#160;secondes. Malgré la lenteur potentielle lors de la connexion via SSH pour exécuter des programmes avec interface graphique, cela peut toujours être intéressant si votre seul objectif est d'ouvrir une simulation et d'effectuer des opérations de menu de base ou d'exécuter des calculs. Ces étapes de base sont un point de départ&#160;: 1) ssh -Y username@graham.computecanada.ca; 2) salloc --x11 --time=1:00:00 --mem=16G --cpus-per-task =4 [--gpus-per-node=1] --account=def-mygroup; 3) une fois connecté à un nœud de calcul, essayez d'exécuter <code>xclock</code>. Si l'horloge apparaît sur votre bureau, chargez le module Ansys souhaité et essayez d'exécuter le programme.</dd></dl></dd></dl></dd></dl>
<h1><span id="Particularit.C3.A9s_selon_le_site_d.27utilisation"></span><span class="mw-headline" id="Particularités_selon_le_site_d'utilisation">Particularités selon le site d'utilisation</span></h1>
<h2><span class="mw-headline" id="Licence_SHARCNET">Licence SHARCNET</span></h2>
<p>La licence Ansys de SHARCNET est gratuite pour une utilisation académique par les chercheurs et chercheuses de l'Alliance sur les systèmes de l'Alliance. Le logiciel installé n'a pas de limites de solveur ou de géométrie. La licence SHARCNET peut  <b>uniquement</b> être utilisée à des fins de <b><i>recherche universitaire publiable</i></b>; la production de résultats à des fins commerciales privées est strictement interdite. La licence a été mise à niveau de CFD vers MCS (Multiphysics Campus Solution) en mai 2020 et inclut les produits suivants&#160;: HF, EM, Electronics HPC, Mechanical et CFD  <a rel="nofollow" class="external text" href="https://www.ansys.com/academic/educator-tools/academic-product-portfolio">comme décrit ici</a>. En 2023 Rocky pour Linux a été ajouté, mais sans prise en charge pour Workbench. Puisque toutes nos grappes fonctionnent avec Linux, SpaceClaim ne peut pas être utilisé. La licence SHARCNET n'inclut pas LS-DYNA et Lumerical, mais ceux-ci peuvent être achetés  but could purchased as an add-on that would work with the existing hpc licenses. Ni LS-DYNA ni Lumerical ne sont inclus. En juillet 2021, 1024 licences anshpc supplémentaires ont été ajoutées au groupe de 512. Avant d'exécuter de grands travaux parallèles, des tests de scalabilité doivent être exécutés pour une simulation donnée. Les tâches parallèles qui n'atteignent pas au moins 50% d'utilisation CPU peuvent être portées à l'attention de notre équipe technique par le système.
</p><p>Depuis décembre 2022, chaque utilisateur peut exécuter 4 travaux en utilisant un total de 252 anshpc (plus 4 anshpc par tâche). Ainsi, les combinaisons de taille de tâches uniformes suivantes sont possibles&#160;: une tâche de 256&#160;cœurs, deux tâches de 130&#160;cœurs, trois tâches de 88&#160;cœurs ou quatre tâches de 67&#160;cœurs selon ( (252 + 4* nombre de tâches) / nombre de tâches). MISE À JOUR%nbsp;: En octobre 2024, la limite a été portée à 8 tâches et 512 cœurs HPC par utilisateur (collectivement sur toutes les grappes pour toutes les applications) pour une période de test afin de permettre plus de flexibilité pour l'exploration de paramètres et l'exécution de problèmes de plus grande envergure. Comme la licence sera beaucoup moins utilisée, certains cas d'échec de tâche au démarrage pourront rarement se produire, mais les tâches devront être soumises à nouveau. Néanmoins, en supposant que la plupart continuent à exécuter une ou deux tâches en utilisant 128 cœurs en moyenne au total, cela ne devrait pas poser de problème. Cela dit, il sera utile de fermer les applications Ansys immédiatement après l'achèvement de toute tâche liée à l'interface graphique afin de libérer toutes les licences qui peuvent être consommées pendant que l'application est inactive, pour que d'autres puissent les utiliser.
</p><p>Étant donné que les meilleures performances parallèles sont généralement obtenues en utilisant tous les cœurs sur des nœuds de calcul (également appelés nœuds complets), on peut déterminer le nombre de nœuds complets en divisant le nombre total de cœurs anshpc par la taille du nœud de calcul. Par exemple, prenons Graham qui possède de nombreux nœuds de calcul à 32&#160;cœurs (Broadwell) et certains à 44&#160;cœurs (Cascade). Le nombre maximal de nœuds pouvant être demandés lors de l'exécution de tâches de différentes tailles sur des nœuds à 32&#160;cœurs en supposant une limite de 252&#160;cœurs pour exécuter respectivement 1, 2, 3 ou 4 tâches simultanées serait&#160;<br />
256/32=8, 130/32=~4, 88/32=~2 ou 67/32=~2. Pour exprimer cela sous forme d'équation, pour une taille de nœud de calcul donnée sur n'importe quelle grappe, le nombre de nœuds de calcul peut être calculé par
( 252 + (4*num_tâches) ) / (num_tâches*cœurs par nœud) ) puis arrondir à l'inférieur et enfin déterminer le nombre total de cœurs à demander en multipliant le nombre pair de nœuds par le nombre de cœurs par nœud.
</p><p>La licence de SHARCNET est disponible selon le principe du premier arrivé, premier servi. Si un nombre anormalement élevé de tâches Ansys était soumis un jour donné, certaines tâches pourraient échouer au démarrage si le nombre de licences disponibles est insuffisant.  Ces événements sont cependant devenus très rares compte tenu de l'augmentation récente des licences anshpc. Si votre recherche nécessite plus de licences que SHARCNET ne peut fournir, une licence dédiée peut être achetée (et hébergée) sur un serveur de licences Ansys dans votre établissement local. Cependant, si la demande est forte, nous pourrions éventuellement acquérir une licence offrant plus d'accès.
</p><p>Vous pouvez aussi acheter votre propre licence Ansys auprès de <a rel="nofollow" class="external text" href="https://www.cmc.ca/subscriptions/">CMC</a> et utiliser leurs serveurs de licences distants. Ceci présente plusieurs avantages&#160;:
</p>
<ul><li>un serveur de licences institutionnel local n'est pas nécessaire,</li>
<li>une licence physique n'a pas besoin d'être obtenue à chaque renouvellement,</li>
<li>la licence peut être utilisée <a rel="nofollow" class="external text" href="https://www.cmc.ca/ansys-">campus-solutions-cmc-00200-04847/ presque n'importe où</a>, y compris à la maison, dans des établissements ou dans toutes les grappes de l'Alliance,</li>
<li>les directives de téléchargement et d'installation pour la version Windows d'Ansys sont fournies afin de permettre l'exécution de spaceclaim sur votre propre ordinateur (ceci n'est pas possible sur nos systèmes qui sont basés sur Linux).</li></ul>
<p>Il existe cependant une limitation potentiellement sérieuse à prendre en compte&#160;: selon <a rel="nofollow" class="external text" href="https://www.cmc.ca/qsg-ansys-cadpass-r20/">Ansys Quick Start Guides</a>, il pourrait avoir une limite de 64 cœurs par utilisateur.
</p>
<h4><span class="mw-headline" id="Fichier_du_serveur_de_licence">Fichier du serveur de licence</span></h4>
<p>Pour utiliser la licence de SHARCNET sur nos grappes, configurez votre fichier <code>ansys.lic</code> comme suit&#160;:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>username@cluster:~<span class="o">]</span><span class="w"> </span>cat<span class="w"> </span>~/.licenses/ansys.lic
setenv<span class="o">(</span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE&quot;</span>,<span class="w"> </span><span class="s2">&quot;1055@license3.sharcnet.ca&quot;</span><span class="o">)</span>
setenv<span class="o">(</span><span class="s2">&quot;ANSYSLI_SERVERS&quot;</span>,<span class="w"> </span><span class="s2">&quot;2325@license3.sharcnet.ca&quot;</span><span class="o">)</span>
</pre></div>
<h4><span class="mw-headline" id="Interroger_le_serveur_de_licence">Interroger le serveur de licence</span></h4>
<p>Pour connaître le nombre de licences utilisées qui sont associées à votre nom d'utilisateur et le nombre de licences utilisées par tous les utilisateurs, lancez
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span>ssh<span class="w"> </span>graham.computecanada.ca
module<span class="w"> </span>load<span class="w"> </span>ansys
lmutil<span class="w"> </span>lmstat<span class="w"> </span>-c<span class="w"> </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="w"> </span>-a<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Users of\|</span><span class="nv">$USER</span><span class="s2">&quot;</span>
</pre></div>
<p>Si vous remarquez que des licences sont utilisées sans justification avec votre nom d'utilisateur (ce qui peut se produire si Ansys n'a pas été correctement fermé sur gra-vdi), connectez-vous au nœud en cause, ouvrez une fenêtre de terminal et mettez fin au processus avec <code>pkill -9 -e -u $USER -f "ansys"</code> pour libérer vos licences.  Prenez note que gra-vdi possède deux nœuds (gra-vdi3 et gra-vdi4) qui vous sont assignés au hasard quand vous vous connectez avec tigervnc; ainsi, avant de lancer <tt>pkill</tt>, il est nécessaire d'indiquer le nom complet de l'hôte (gra-vdi3.sharcnet.ca ou grav-vdi4.sharcnet.ca) quand vous vous connectez.
</p>
<h3><span class="mw-headline" id="Modules_VDI_locaux">Modules VDI locaux</span></h3>
<p>Lors de l'utilisation de gra-vdi, vous avez le choix de charger des modules Ansys à partir de notre environnement global (après avoir chargé CcEnv) ou de charger des modules Ansys installés localement sur la machine elle-même (après avoir chargé SnEnv). Les modules locaux peuvent être intéressants, car ils incluent certains programmes et versions d'Ansys non encore pris en charge par notre environnement standard. Lors du démarrage de programmes à partir de modules Ansys locaux, vous pouvez sélectionner le serveur de licences CMC ou accepter le serveur de licences SHARCNET par défaut. Les paramètres de <code>~/.licenses/ansys.lic</code> ne sont présentement pas utilisés par les modules Ansys locaux, sauf lors du démarrage de <code>runwb2</code> où ils remplacent les paramètres par défaut du serveur de licences SHARCNET. L'utilisation appropriée des programmes Ansys sur gra-vdi comprend&#160;: l'exécution interactive d'une seule tâche de test avec jusqu'à 8&#160;cœurs et/ou 128Go de RAM; la création ou la modification de fichiers d'entrée pour la simulation; le post-traitement; ou la visualisation de données.
</p>
<h4><span class="mw-headline" id="Modules_Ansys">Modules Ansys</span></h4>
<ol><li>Connectez-vous à gra-vdi.computecanada.ca avec <a href="/wiki/VNC/fr#Nœuds_VDI" title="VNC/fr">TigerVNC</a>.</li>
<li>Ouvrez une fenêtre de terminal et chargez le module &#160;:
<dl><dt><code>module load SnEnv ansys/2021R2</code>, ou</dt>
<dt><code>module load SnEnv ansys/2021R1</code>, ou</dt>
<dt><code>module load SnEnv ansys/2020R2</code>, ou</dt>
<dt><code>module load SnEnv ansys/2020R1</code>, ou</dt>
<dt><code>module load SnEnv ansys/2019R3</code></dt></dl></li>
<li>Lancez un programme Ansys avec une des commandes suivantes&#160;:
<dl><dt><code>runwb2|fluent|<b>cfx5</b>|icemcfd|apdl</code></dt></dl></li>
<li>Appuyez sur <code>y</code> et <code>Enter</code> pour accepter les conditions.</li>
<li>Appuyez sur <code>Enter</code> pour accepter l'option <code>n</code> et utilisez le serveur de licence par défaut SHARCNET (dans le cas de runwb2, <i>~/.licenses/ansysedt.lic</i> sera utilisé si trouvé, autrement ANSYSLI_SERVERS et ANSYSLMD_LICENSE_FILE seront utilisés s'ils sont configurés dans votre environnement, pour un autre serveur de licences distant, par exemple).   Pour utiliser le serveur de licence de CMC, changez <code>n</code> pour <code>y</code> et appuyez sur <code>Enter</code>.</li></ol>
<p>où <code><b>cfx5</b></code> de l'étape 3 ci-dessus donne l'option de démarrer les composantes suivantes&#160;:
</p>
<pre>   1) CFX-Launcher  (cfx5 -&gt; cfx5launch)
   2) CFX-Pre       (cfx5pre)
   3) CFD-Post      (cfdpost -&gt; cfx5post)
   4) CFX-Solver    (cfx5solve)
</pre>
<h4><span class="mw-headline" id="Modules_ansysedt">Modules ansysedt</span></h4>
<ol><li>Connectez-vous à gra-vdi.computecanada.ca avec <a href="/wiki/VNC/fr#Nœuds_VDI" title="VNC/fr">TigerVNC</a>.</li>
<li>Ouvrez une nouvelle fenêtre de terminal et chargez un module
<dl><dt><code>module load SnEnv ansysedt/2021R2</code>, ou</dt>
<dt><code>module load SnEnv ansysedt/2021R1</code></dt></dl></li>
<li>Lancez Ansys Electromagnetics Desktop avec la commande <code>ansysedt</code>.</li>
<li>Appuyez sur <code>y</code> et <code>Enter</code> pour accepter les conditions.</li>
<li>Appuyez sur <code>enter</code> pour accepter l'option <code>n</code> et utiliser le serveur de licences SHARCNET par défaut (si présente,  <i>~/.licenses/ansysedt.lic</i> sera utilisée, autrement ANSYSLI_SERVERS et ANSYSLMD_LICENSE_FILE seront utilisés s'ils sont configurés dans votre environnement, par exemple pour un autre serveur à distance).  Si vous remplacez <code>n</code> par <code>y</code> et appuyez sur <code>Enter</code>, le serveur de licences CMC sera utilisé.</li></ol>
<p>Les préférences des fonctionnalités de licence précédemment configurées avec <i>anslic_admin</i> ne sont plus prises en charge suite à la mise à jour du serveur de licences SHARCNET du 9 septembre 2021. Si un problème de licence survient, essayez de supprimer le répertoire <code>~/.ansys</code> de votre compte /home pour effacer les paramètres. Si les problèmes persistent, veuillez contacter notre <a href="/wiki/Technical_support/fr" title="Technical support/fr">soutien technique</a> et fournir le contenu de votre fichier <code>~/.licenses/ansys.lic</code>.
</p>
<h1><span class="mw-headline" id="Additive_Manufacturing">Additive Manufacturing</span></h1>
<p>Configurez d'abord votre fichier <code>~/.licenses/ansys.lic</code> pour l'orienter vers le serveur de licence où se trouve une licence valide pour Ansys Mechanical.  Vous devez faire ceci sur tous les systèmes où vous utiliserez le logiciel.  
</p>
<h2><span class="mw-headline" id="Activer_Additive">Activer Additive</span></h2>
<p>Nous décrivons ici comment obtenir l'extension ACT de Ansys Additive Manufacturing pour l'utiliser dans votre projet. Les étapes suivantes doivent être effectuées pour chaque version de module Ansys sur chacune des grappes où l'extension sera utilisée. Les extensions nécessaires à votre projet doivent aussi être installées sur la ou les grappes, tel que décrit ci-dessous. Si vous recevez des avertissements à l'effet que des extensions dont vous n'avez pas besoin sont manquantes, par exemple ANSYSMotion, désinstallez-les à partir de votre projet.
</p>
<h3><span id="T.C3.A9l.C3.A9charger_l.27extension"></span><span class="mw-headline" id="Télécharger_l'extension">Télécharger l'extension</span></h3>
<ul><li>téléchargez AdditiveWizard.wbex à partir de <a rel="nofollow" class="external free" href="https://catalog.ansys.com/">https://catalog.ansys.com/</a></li>
<li>téléversez AdditiveWizard.wbex sur la grappe où vous allez l'utiliser</li></ul>
<h3><span class="mw-headline" id="Lancer_Workbench">Lancer Workbench</span></h3>
<ul><li>Voir la section Workbench dans<a href="/mediawiki/index.php?title=ANSYS/fr&amp;action=edit&amp;redlink=1" class="new" title="ANSYS/fr (page does not exist)">Mode graphique plus haut</a>.</li>
<li>Dans l'interface Workbench, ouvrez votre fichier de projet avec File -&gt; Open.</li></ul>
<h3><span id="Ouvrir_le_gestionnaire_d.27extensions"></span><span class="mw-headline" id="Ouvrir_le_gestionnaire_d'extensions">Ouvrir le gestionnaire d'extensions</span></h3>
<ul><li>Cliquez sur la page ACT Start pour faire afficher l'onglet de la page ACT Home.</li>
<li>Cliquez sur Manage Extensions pour ouvrir le gestionnaire d'extensions.</li></ul>
<h3><span id="Installer_l.27extension"></span><span class="mw-headline" id="Installer_l'extension">Installer l'extension</span></h3>
<ul><li>Cliquez sur la boîte avec le signe + sous la barre de recherche.</li>
<li>Sélectionnez et installez votre fichier AdditiveWizard.wbex.</li></ul>
<h3><span id="Charger_l.27extension"></span><span class="mw-headline" id="Charger_l'extension">Charger l'extension</span></h3>
<ul><li>Cliquez pour sélectionner la boîte AdditiveWizard, ce qui charge l'extension uniquement pour la session en cours.</li>
<li>Cliquez sur la flèche dans le coin droit au bas de la boîte AdditiveWizard et sélectionnez <i>Load extension</i>, ce qui charge l'extension pour la session en cours et pour les sessions futures.</li></ul>
<h3><span id="Supprimer_l.27extension"></span><span class="mw-headline" id="Supprimer_l'extension">Supprimer l'extension</span></h3>
<ul><li>Cliquez pour désélectionner la boîte AdditiveWizard, ce qui supprime l'extension pour la session en cours.</li>
<li>Cliquez sur la flèche dans le coin droit au bas de la boîte AdditiveWizard et sélectionnez <i>Do not load as default</i>, ce qui empêche le chargement de l'extension pour les futures sessions.</li></ul>
<h2><span id="Ex.C3.A9cuter_Additive"></span><span class="mw-headline" id="Exécuter_Additive">Exécuter Additive</span></h2>
<h3><span class="mw-headline" id="Gra-vdi">Gra-vdi</span></h3>
<p>Vous pouvez exécuter une seule tâche Ansys Additive Manufacturing sur gra-vdi en utilisant jusqu'à 16 cœurs comme suit&#160;: 
</p>
<ul><li>Lancez Workbench sur gra-vdi comme décrit ci-dessus dans <i>Additive Manufacturing -&gt; Activer Additive</i>.</li>
<li>Cliquez sur <i>File -&gt; Open</i> et sélectionnez <i>test.wbpj</i> puis cliquez sur <i>Open</i>.</li>
<li>Cliquez sur <i>View -&gt; Reset workspace</i> si votre écran est gris.</li>
<li>Lancez <i>Mechanical, Clear Generated Data</i>, sélectionnez  <i>Distributed</i>, spécifiez <i>Cores</i>.</li>
<li>Cliquez sur <i>File -&gt; Save Project -&gt; Solve</i>.</li></ul>
<p>Vérifiez l'utilisation&#160;:
</p>
<ul><li>Ouvrez un autre terminal et lancez <code>top -u $USER</code> OU <code>ps u -u $USER | grep ansys</code>.</li>
<li>Terminez les processus non nécessaires créés par des tâches précédentes avec  <code>pkill -9 -e -u $USER -f "ansys|mwrpcss|mwfwrapper|ENGINE"</code>.</li></ul>
<p>Veuillez noter que des processus persistants peuvent bloquer les licences entre les sessions de connexion gra-vdi ou provoquer d'autres erreurs inhabituelles lors de la tentative de démarrage de l'interface graphique sur gra-vdi. Bien que cela soit rare, un processus peut rester en mémoire si une session d'interface graphique Ansys (Fluent, Workbench, etc.) n'est pas correctement terminée avant que vncviewer ne soit terminé manuellement ou de manière inattendue, par exemple en raison d'une panne de réseau temporaire ou d'un système de fichiers bloqué. Dans ce dernier cas, les processus peuvent ne pas être tués tant que l'accès normal au disque n'est pas rétabli.
</p>
<h3><span class="mw-headline" id="Grappe">Grappe</span></h3>
<p>Préparation du projet
</p><p>Certaines préparations doivent être effectuées avant de soumettre un projet Additive nouvellement téléchargé dans la file d'attente d'une grappe avec <code>sbatch scriptname</code>. Pour commencer, ouvrez votre simulation avec l'interface graphique de Workbench (comme décrit ci-dessus dans <i>Additive Manufacturing -&gt; Activer Additive</i>) dans le même répertoire que celui à partir duquel votre tâche sera soumise, puis enregistrez-la à nouveau. Assurez-vous d'utiliser la même version du module Ansys qui sera utilisé pour la tâche. Créez ensuite un script Slurm (comme expliqué dans le paragraphe pour Workbench dans la section <i>Soumettre des tâches en lot sur nos grappes</i> ci-dessus). Pour effectuer des études paramétriques, remplacez <code>Update()</code> par <code>UpdateAllDesignPoints()</code> dans le script Slurm. Déterminez le nombre optimal de cœurs et de mémoire en soumettant plusieurs courtes tâches de test. Pour éviter d'avoir à effacer manuellement la solution <b>et</b> recréer tous les points de conception dans Workbench entre chaque exécution de test, soit 1. remplacez <code>Save(Overwrite=True)</code> par <code>Save (Overwrite=False)</code>; ou 2. enregistrez une copie du fichier YOURPROJECT.wbpj d'origine et du répertoire YOURPROJECT_files correspondant. Vous pouvez aussi créer puis exécuter manuellement un fichier de relecture sur la grappe dans le répertoire de cas de test entre chaque exécution, en notant qu'un seul fichier de relecture peut être utilisé dans différents répertoires en l'ouvrant dans un éditeur de texte et en modifiant le paramètre interne FilePath.
</p>
<pre>module load ansys/2019R3
rm -f test_files/.lock
runwb2 -R myreplay.wbjn
</pre>
<p>Utilisation des ressources
</p><p>Après quelques minutes, vous pouvez obtenir un instantané de l'utilisation des ressources par la tâche en cours d'exécution sur le ou les nœuds de calcul avec la commande <tt>srun</tt>. Le script pour 8 cœurs ci-dessous produit le résultat suivant où on remarque que l'ordonnanceur a choisi 2 nœuds.
</p>
<pre>[gra-login1:~] srun --jobid=myjobid top -bn1 -u $USER | grep R | grep -v top
  PID USER   PR  NI    VIRT    RES    SHR S  %CPU %MEM    TIME+  COMMAND
22843 demo   20   0 2272124 256048  72796 R  88.0  0.2  1:06.24  ansys.e
22849 demo   20   0 2272118 256024  72822 R  99.0  0.2  1:06.37  ansys.e
22838 demo   20   0 2272362 255086  76644 R  96.0  0.2  1:06.37  ansys.e
  PID USER   PR  NI    VIRT    RES    SHR S  %CPU %MEM    TIME+  COMMAND
 4310 demo   20   0 2740212 271096 101892 R 101.0  0.2  1:06.26  ansys.e
 4311 demo   20   0 2740416 284552  98084 R  98.0  0.2  1:06.55  ansys.e
 4304 demo   20   0 2729516 268824 100388 R 100.0  0.2  1:06.12  ansys.e
 4305 demo   20   0 2729436 263204 100932 R 100.0  0.2  1:06.88  ansys.e
 4306 demo   20   0 2734720 431532  95180 R 100.0  0.3  1:06.57  ansys.e
</pre>
<p>Tests de scalabilité
</p><p>Une fois la tâche complétée, son <i>Job Wall-clock time</i> peut être obtenu avec <code>seff jobid</code>. Cette valeur peut être utilisée pour effectuer des tests de scalabilité en soumettant de courtes tâches d'abord puis en doublant le nombre de cœurs. Tant que le Wall-clock time  diminue d'environ 50%, vous pouvez continuer de doubler le nombre de cœurs.
</p>
<h1><span class="mw-headline" id="Aide">Aide</span></h1>
<h2><span class="mw-headline" id="Documentation_en_ligne">Documentation en ligne</span></h2>
<p>Ansys documentation, tutorial and videos (for any Ansys version back to 19.2) can be accessed by following these steps:
</p>
<ol><li>Connect to <b>gra-vdi.computecanada.ca</b> with tigervnc as described <a href="/wiki/VNC#VDI_Nodes" title="VNC">here</a>.</li>
<li>If the Firefox browser or the Ansys Workbench is open, close it now.</li>
<li>Start Firefox by clicking <i>Applications -&gt; Internet -&gt; Firefox</i>.</li>
<li>Open a <b><i>new</i></b> terminal window by clicking  <i>Applications -&gt; System Tools -&gt; Mate Terminal</i>.</li>
<li>Start Workbench by typing the following in your terminal: <i>module load CcEnv StdEnv/2023 ansys; runwb2</i></li>
<li>Go to the upper Workbench menu bar and click  <i>Help -&gt; ANSYS Workbench Help</i>.  The <b>Workbench Users' Guide</b> should appear loaded in Firefox.</li>
<li>At this point Workbench is no longer needed so close it by clicking the <i>&gt;Unsaved Project - Workbench</i> tab located along the bottom frame (doing this will bring Workbench into focus) and then click <i>File -&gt; Exit</i>.</li>
<li>In the top middle of the Ansys documentation page, click the word <i>HOME</i> located just left of <i>API DOCS</i>.</li>
<li>Now scroll down and you should see a list of Ansys product icons and/or alphabetical ranges.</li>
<li>Select a product to view its documentation.  The documentation for the latest release version will be displayed by default.  Change the version by clicking the <i>Release Year</i> pull down located above and just to the right of the Ansys documentation page search bar.</li>
<li>To search for documentation corresponding to a different Ansys product, click <i>HOME</i> again.</li></ol>
<h2><span id="Vid.C3.A9os_sur_YouTube"></span><span class="mw-headline" id="Vidéos_sur_YouTube">Vidéos sur YouTube</span></h2>
<p><a rel="nofollow" class="external text" href="https://www.youtube.com/@AnsysHowTo/videos">Ansys How To</a>
</p>
<h2><span class="mw-headline" id="Innovation_Space">Innovation Space</span></h2>
<p><a rel="nofollow" class="external text" href="https://innovationspace.ansys.com/">Customer Support &amp; Training: Ansys Innovation Space</a>.
</p>
<!-- 
NewPP limit report
Cached time: 20250530235441
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.270 seconds
Real time usage: 2.701 seconds
Preprocessor visited node count: 1531/1000000
Post‐expand include size: 43255/2097152 bytes
Template argument size: 61589/2097152 bytes
Highest expansion depth: 9/100
Expensive parser function count: 24/100
Unstrip recursion depth: 3/20
Unstrip post‐expand size: 164826/5000000 bytes
ExtLoops count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 2366.016      1 -total
 92.71% 2193.649     21 Template:File
  4.52%  107.021      1 Template:Commands2
-->

<!-- Saved in parser cache with key ccwiki:pcache:idhash:4960-0!canonical and timestamp 20250530235441 and revision id 173818. Rendering was triggered because: page-view
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys/fr&amp;oldid=173818">https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys/fr&amp;oldid=173818</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/mediawiki/index.php?title=Category:Pages_using_deprecated_source_tags&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using deprecated source tags (page does not exist)">Pages using deprecated source tags</a></li><li><a href="/wiki/Category:Software" title="Category:Software">Software</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-login" class="mw-list-item"><a href="/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Ansys%2Ffr" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li>
		</ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-namespaces-label"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/Ansys/fr" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="/mediawiki/index.php?title=Talk:Ansys/fr&amp;action=edit&amp;redlink=1" rel="discussion" class="new" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-variants-label"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	>
	<label
		id="p-variants-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">français</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-views-label"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected mw-list-item"><a href="/wiki/Ansys/fr"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys/fr&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys/fr&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-cactions-label"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<h3 >Search</h3>
	<form action="/mediawiki/index.php" id="searchform" class="vector-search-box-form">
		<div id="simpleSearch"
			class="vector-search-box-inner"
			 data-search-loc="header-navigation">
			<input class="vector-search-box-input"
				 type="search" name="search" placeholder="Search Alliance Doc" aria-label="Search Alliance Doc" autocapitalize="sentences" title="Search Alliance Doc [f]" accesskey="f" id="searchInput"
			>
			<input type="hidden" name="title" value="Special:Search">
			<input id="mw-searchButton"
				 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
			<input id="searchButton"
				 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel" class="vector-legacy-sidebar">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Technical_documentation"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu-portal portal vector-menu" aria-labelledby="p-navigation-label"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-wiki-main-page" class="mw-list-item"><a href="/wiki/Technical_documentation"><span>Wiki Main Page</span></a></li>
		</ul>
		
	</div>
</nav>

	
<nav id="p-sidebar-support" class="mw-portlet mw-portlet-sidebar-support vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-support-label"  >
	<h3
		id="p-sidebar-support-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Support</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-getting-started" class="mw-list-item"><a href="/wiki/Getting_started"><span>Getting started</span></a></li><li id="n-sidebar-technical-support" class="mw-list-item"><a href="/wiki/Technical_support"><span>Getting help</span></a></li><li id="n-sidebar-running-jobs" class="mw-list-item"><a href="/wiki/Running_jobs"><span>Running jobs</span></a></li><li id="n-sidebar-known-issues" class="mw-list-item"><a href="/wiki/Known_issues"><span>Known issues</span></a></li><li id="n-sidebar-system-status" class="mw-list-item"><a href="http://status.computecanada.ca" rel="nofollow"><span>System status</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-resources" class="mw-portlet mw-portlet-sidebar-resources vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-resources-label"  >
	<h3
		id="p-sidebar-resources-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Resources</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Béluga" class="mw-list-item"><a href="/wiki/B%C3%A9luga/en"><span>Béluga</span></a></li><li id="n-Cedar" class="mw-list-item"><a href="/wiki/Cedar"><span>Cedar</span></a></li><li id="n-Graham" class="mw-list-item"><a href="/wiki/Graham"><span>Graham</span></a></li><li id="n-Narval" class="mw-list-item"><a href="/wiki/Narval/en"><span>Narval</span></a></li><li id="n-Niagara" class="mw-list-item"><a href="/wiki/Niagara"><span>Niagara</span></a></li><li id="n-sidebar-cloud" class="mw-list-item"><a href="/wiki/CC-Cloud"><span>Cloud</span></a></li><li id="n-tamIA" class="mw-list-item"><a href="/wiki/TamIA/en"><span>tamIA</span></a></li><li id="n-Killarney" class="mw-list-item"><a href="/wiki/Killarney"><span>Killarney</span></a></li><li id="n-sidebar-quantum-computing" class="mw-list-item"><a href="/wiki/Services_d%27informatique_quantique/en"><span>Quantum computing</span></a></li><li id="n-sidebar-available-software" class="mw-list-item"><a href="/wiki/Available_software"><span>Available software</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-alliance" class="mw-portlet mw-portlet-sidebar-alliance vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-alliance-label"  >
	<h3
		id="p-sidebar-alliance-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">The Alliance</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-alliance-main-page" class="mw-list-item"><a href="https://alliancecan.ca/en" rel="nofollow"><span>Alliance main page</span></a></li><li id="n-sidebar-ccdb" class="mw-list-item"><a href="https://ccdb.computecanada.ca/security/login" rel="nofollow"><span>CCDB</span></a></li><li id="n-sidebar-getting-an-account" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/apply-account" rel="nofollow"><span>Getting An Account</span></a></li><li id="n-sidebar-acknowledging-alliance" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/research-portal/acknowledging-alliance" rel="nofollow"><span>Acknowledging the Alliance</span></a></li><li id="n-sidebar-aup" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/policies" rel="nofollow"><span>Acceptable Use Policy</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-authoring" class="mw-portlet mw-portlet-sidebar-authoring vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-authoring-label"  >
	<h3
		id="p-sidebar-authoring-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Authoring</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-guidelines" class="mw-list-item"><a href="/wiki/Authoring_guidelines"><span>Guidelines</span></a></li><li id="n-sidebar-mediawiki-help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu-portal portal vector-menu" aria-labelledby="p-tb-label"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/Ansys/fr" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/Ansys/fr" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys/fr&amp;oldid=173818" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys/fr&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
		</ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 5 March 2025, at 22:25.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="/wiki/CCWiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/CCWiki:About">About Alliance Doc</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/CCWiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys/fr&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/mediawiki/resources/assets/poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.log.warn("This page is using the deprecated ResourceLoader module \"codex-search-styles\".\n[1.43] Use a CodexModule with codexComponents to set your specific components used: https://www.mediawiki.org/wiki/Codex#Using_a_limited_subset_of_components");});</script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-TVBPRD78K4" async=""></script><script>
window.dataLayer = window.dataLayer || [];

function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TVBPRD78K4', {});
</script>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":2832,"wgPageParseReport":{"limitreport":{"cputime":"0.270","walltime":"2.701","ppvisitednodes":{"value":1531,"limit":1000000},"postexpandincludesize":{"value":43255,"limit":2097152},"templateargumentsize":{"value":61589,"limit":2097152},"expansiondepth":{"value":9,"limit":100},"expensivefunctioncount":{"value":24,"limit":100},"unstrip-depth":{"value":3,"limit":20},"unstrip-size":{"value":164826,"limit":5000000},"timingprofile":["100.00% 2366.016      1 -total"," 92.71% 2193.649     21 Template:File","  4.52%  107.021      1 Template:Commands2"]},"loops":{"limitreport-count-limited":{"value":0,"limit":100}},"cachereport":{"timestamp":"20250530235441","ttl":86400,"transientcontent":false}}});});</script>
</body>
</html>