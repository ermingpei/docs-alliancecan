<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ansys - Alliance Doc</title>
<script>(function(){var className="client-js";var cookie=document.cookie.match(/(?:^|; )ccwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"aDpFQY34nW-BQYizeTZIggAAA08","wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Ansys","wgTitle":"Ansys","wgCurRevisionId":177665,"wgRevisionId":177665,"wgArticleId":4568,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages using deprecated source tags",
"Software"],"wgPageViewLanguage":"en","wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Ansys","wgRelevantArticleId":4568,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgULSAcceptLanguageList":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"watchlist":false,"tagline":false},"wgCiteReferencePreviewsActive":true,"wgTranslatePageTranslation":"source","wgULSPosition":"personal","wgULSisCompactLinksEnabled":true,"wgVector2022LanguageInHeader":false,"wgULSisLanguageSelectorEmpty":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.translate.tag.languages":"ready","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.translate.edit.documentation.styles":"ready","ext.translate":"ready","codex-search-styles":"ready","ext.uls.pt":"ready"};RLPAGEMODULES=["ext.tabs","ext.pygments.view","site","mediawiki.page.ready",
"mediawiki.toc","skins.vector.legacy.js","ext.languageSelector","ext.translate.pagetranslation.uls","ext.uls.compactlinks","ext.uls.geoclient","ext.uls.interface","ext.moderation.notify","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=codex-search-styles%7Cext.pygments%2Ctranslate%7Cext.translate.edit.documentation.styles%7Cext.translate.tag.languages%7Cext.uls.pt%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector">
<script async="" src="/mediawiki/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/mediawiki/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<link rel="icon" href="/mediawiki/resources/assets/Alliance_favicon.png">
<link rel="search" type="application/opensearchdescription+xml" href="/mediawiki/rest.php/v1/search" title="Alliance Doc (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://docs.alliancecan.ca/mediawiki/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="Alliance Doc Atom feed" href="/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<style type="text/css" id="tabs-dynamic-styles">/*<![CDATA[*/
/* Dynamically generated tabs styles */
.tabs-input-1:checked ~ .tabs-container .tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-content-1 {display:inline-block;}
.tabs-input-1:checked ~ .tabs-container .tabs-inline.tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-inline.tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-inline.tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-inline.tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-inline.tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-inline.tabs-content-1 {display:inline;}
.tabs-input-1:checked ~ .tabs-container .tabs-block.tabs-content-1,
.tabs-input-2:checked ~ .tabs-container .tabs-block.tabs-content-2,
.tabs-input-3:checked ~ .tabs-container .tabs-block.tabs-content-3,
.tabs-input-4:checked ~ .tabs-container .tabs-block.tabs-content-4,
.tabs-input-5:checked ~ .tabs-container .tabs-block.tabs-content-5,
.tabs-input-0:checked ~ .tabs-container .tabs-block.tabs-content-1 {display:block;}
/* The same styles, but with .checked instead of :checked, for browsers that rely on the JavaScript fallback */
.tabs-input-1.checked ~ .tabs-container .tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-content-1 {display:inline-block;}
.tabs-input-1.checked ~ .tabs-container .tabs-inline.tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-inline.tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-inline.tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-inline.tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-inline.tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-inline.tabs-content-1 {display:inline;}
.tabs-input-1.checked ~ .tabs-container .tabs-block.tabs-content-1,
.tabs-input-2.checked ~ .tabs-container .tabs-block.tabs-content-2,
.tabs-input-3.checked ~ .tabs-container .tabs-block.tabs-content-3,
.tabs-input-4.checked ~ .tabs-container .tabs-block.tabs-content-4,
.tabs-input-5.checked ~ .tabs-container .tabs-block.tabs-content-5,
.tabs-input-0.checked ~ .tabs-container .tabs-block.tabs-content-1 {display:block;}
.tabs-dropdown .tabs-content,.tabs-dropdown .tabs-container,.tabs-dropdown li,.tabs-dropdown ul,.tabs-dropdown ol {background-color: white /* Malicious data in tabs-dropdown-bgcolor */}
/*]]>*/</style>
</head>
<body class="skin-vector-legacy mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ansys rootpage-Ansys skin-vector action-view"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	<div id="mw-indicator-languageselector" class="mw-indicator"><span id="languageselector-box-1" class="languageselector " style=""><form name="languageselector-form-1" id="languageselector-form-1" method="get" action="/mediawiki/index.php" style="display:inline;"><input type="hidden" value="Ansys" name="title"><select name="setlang" id="languageselector-select-1" style=""><option value="aae">Arbërisht</option><option value="ab">аԥсшәа</option><option value="abs">bahasa ambon</option><option value="ace">Acèh</option><option value="acf">Kwéyòl Sent Lisi</option><option value="acm">عراقي</option><option value="ady">адыгабзэ</option><option value="ady-cyrl">адыгабзэ</option><option value="aeb">تونسي / Tûnsî</option><option value="aeb-arab">تونسي</option><option value="aeb-latn">Tûnsî</option><option value="af">Afrikaans</option><option value="aln">Gegë</option><option value="alt">алтай тил</option><option value="am">አማርኛ</option><option value="ami">Pangcah</option><option value="an">aragonés</option><option value="ang">Ænglisc</option><option value="ann">Obolo</option><option value="anp">अंगिका</option><option value="apc">شامي</option><option value="ar">العربية</option><option value="arc">ܐܪܡܝܐ</option><option value="arn">mapudungun</option><option value="arq">جازايرية</option><option value="ary">الدارجة</option><option value="arz">مصرى</option><option value="as">অসমীয়া</option><option value="ase">American sign language</option><option value="ast">asturianu</option><option value="atj">Atikamekw</option><option value="av">авар</option><option value="avk">Kotava</option><option value="awa">अवधी</option><option value="ay">Aymar aru</option><option value="az">azərbaycanca</option><option value="azb">تۆرکجه</option><option value="ba">башҡортса</option><option value="ban">Basa Bali</option><option value="ban-bali">ᬩᬲᬩᬮᬶ</option><option value="bar">Boarisch</option><option value="bbc">Batak Toba</option><option value="bbc-latn">Batak Toba</option><option value="bcc">جهلسری بلوچی</option><option value="bci">wawle</option><option value="bcl">Bikol Central</option><option value="bdr">Bajau Sama</option><option value="be">беларуская</option><option value="be-tarask">беларуская (тарашкевіца)</option><option value="bew">Betawi</option><option value="bg">български</option><option value="bgc">हरियाणवी</option><option value="bgn">روچ کپتین بلوچی</option><option value="bh">भोजपुरी</option><option value="bho">भोजपुरी</option><option value="bi">Bislama</option><option value="bjn">Banjar</option><option value="blk">ပအိုဝ်ႏဘာႏသာႏ</option><option value="bm">bamanankan</option><option value="bn">বাংলা</option><option value="bo">བོད་ཡིག</option><option value="bpy">বিষ্ণুপ্রিয়া মণিপুরী</option><option value="bqi">بختیاری</option><option value="br">brezhoneg</option><option value="brh">Bráhuí</option><option value="bs">bosanski</option><option value="btm">Batak Mandailing</option><option value="bto">Iriga Bicolano</option><option value="bug">Basa Ugi</option><option value="bxr">буряад</option><option value="ca">català</option><option value="cbk-zam">Chavacano de Zamboanga</option><option value="ccp">𑄌𑄋𑄴𑄟𑄳𑄦</option><option value="cdo">閩東語 / Mìng-dĕ̤ng-ngṳ̄</option><option value="ce">нохчийн</option><option value="ceb">Cebuano</option><option value="ch">Chamoru</option><option value="chn">chinuk wawa</option><option value="chr">ᏣᎳᎩ</option><option value="chy">Tsetsêhestâhese</option><option value="ckb">کوردی</option><option value="co">corsu</option><option value="cps">Capiceño</option><option value="cpx">莆仙語 / Pó-sing-gṳ̂</option><option value="cpx-hans">莆仙语（简体）</option><option value="cpx-hant">莆仙語（繁體）</option><option value="cr">Nēhiyawēwin / ᓀᐦᐃᔭᐍᐏᐣ</option><option value="crh">qırımtatarca</option><option value="crh-cyrl">къырымтатарджа (Кирилл)</option><option value="crh-latn">qırımtatarca (Latin)</option><option value="crh-ro">tatarşa</option><option value="cs">čeština</option><option value="csb">kaszëbsczi</option><option value="cu">словѣньскъ / ⰔⰎⰑⰂⰡⰐⰠⰔⰍⰟ</option><option value="cv">чӑвашла</option><option value="cy">Cymraeg</option><option value="da">dansk</option><option value="dag">dagbanli</option><option value="de">Deutsch</option><option value="de-at">Österreichisches Deutsch</option><option value="de-ch">Schweizer Hochdeutsch</option><option value="de-formal">Deutsch (Sie-Form)</option><option value="dga">Dagaare</option><option value="din">Thuɔŋjäŋ</option><option value="diq">Zazaki</option><option value="dsb">dolnoserbski</option><option value="dtp">Kadazandusun</option><option value="dty">डोटेली</option><option value="dua">Duálá</option><option value="dv">ދިވެހިބަސް</option><option value="dz">ཇོང་ཁ</option><option value="ee">eʋegbe</option><option value="efi">Efịk</option><option value="egl">emiliàn e rumagnòl</option><option value="el">Ελληνικά</option><option value="eml">emiliàn e rumagnòl</option><option value="en" selected="">English</option><option value="en-ca">Canadian English</option><option value="en-gb">British English</option><option value="eo">Esperanto</option><option value="es">español</option><option value="es-formal">español (formal)</option><option value="et">eesti</option><option value="eu">euskara</option><option value="ext">estremeñu</option><option value="fa">فارسی</option><option value="fat">mfantse</option><option value="ff">Fulfulde</option><option value="fi">suomi</option><option value="fit">meänkieli</option><option value="fj">Na Vosa Vakaviti</option><option value="fo">føroyskt</option><option value="fon">fɔ̀ngbè</option><option value="fr">français</option><option value="frc">français cadien</option><option value="frp">arpetan</option><option value="frr">Nordfriisk</option><option value="fur">furlan</option><option value="fy">Frysk</option><option value="ga">Gaeilge</option><option value="gaa">Ga</option><option value="gag">Gagauz</option><option value="gan">贛語</option><option value="gan-hans">赣语（简体）</option><option value="gan-hant">贛語（繁體）</option><option value="gcf">kréyòl Gwadloup</option><option value="gcr">kriyòl gwiyannen</option><option value="gd">Gàidhlig</option><option value="gl">galego</option><option value="gld">на̄ни</option><option value="glk">گیلکی</option><option value="gn">Avañe'ẽ</option><option value="gom">गोंयची कोंकणी / Gõychi Konknni</option><option value="gom-deva">गोंयची कोंकणी</option><option value="gom-latn">Gõychi Konknni</option><option value="gor">Bahasa Hulontalo</option><option value="got">𐌲𐌿𐍄𐌹𐍃𐌺</option><option value="gpe">Ghanaian Pidgin</option><option value="grc">Ἀρχαία ἑλληνικὴ</option><option value="gsw">Alemannisch</option><option value="gu">ગુજરાતી</option><option value="guc">wayuunaiki</option><option value="gur">farefare</option><option value="guw">gungbe</option><option value="gv">Gaelg</option><option value="ha">Hausa</option><option value="hak">客家語 / Hak-kâ-ngî</option><option value="haw">Hawaiʻi</option><option value="he">עברית</option><option value="hi">हिन्दी</option><option value="hif">Fiji Hindi</option><option value="hif-latn">Fiji Hindi</option><option value="hil">Ilonggo</option><option value="hno">ہندکو</option><option value="hr">hrvatski</option><option value="hrx">Hunsrik</option><option value="hsb">hornjoserbsce</option><option value="hsn">湘語</option><option value="ht">Kreyòl ayisyen</option><option value="hu">magyar</option><option value="hu-formal">magyar (formal)</option><option value="hy">հայերեն</option><option value="hyw">Արեւմտահայերէն</option><option value="ia">interlingua</option><option value="iba">Jaku Iban</option><option value="ibb">ibibio</option><option value="id">Bahasa Indonesia</option><option value="ie">Interlingue</option><option value="ig">Igbo</option><option value="igl">Igala</option><option value="ii">ꆇꉙ</option><option value="ik">Iñupiatun</option><option value="ike-cans">ᐃᓄᒃᑎᑐᑦ</option><option value="ike-latn">inuktitut</option><option value="ilo">Ilokano</option><option value="inh">гӀалгӀай</option><option value="io">Ido</option><option value="is">íslenska</option><option value="isv-cyrl">меджусловјанскы</option><option value="isv-latn">medžuslovjansky</option><option value="it">italiano</option><option value="iu">ᐃᓄᒃᑎᑐᑦ / inuktitut</option><option value="ja">日本語</option><option value="jam">Patois</option><option value="jbo">la .lojban.</option><option value="jut">jysk</option><option value="jv">Jawa</option><option value="ka">ქართული</option><option value="kaa">Qaraqalpaqsha</option><option value="kab">Taqbaylit</option><option value="kai">Karai-karai</option><option value="kbd">адыгэбзэ</option><option value="kbd-cyrl">адыгэбзэ</option><option value="kbp">Kabɩyɛ</option><option value="kcg">Tyap</option><option value="kea">kabuverdianu</option><option value="kg">Kongo</option><option value="kge">Kumoring</option><option value="khw">کھوار</option><option value="ki">Gĩkũyũ</option><option value="kiu">Kırmancki</option><option value="kjh">хакас</option><option value="kjp">ဖၠုံလိက်</option><option value="kk">қазақша</option><option value="kk-arab">قازاقشا (تٴوتە)</option><option value="kk-cn">قازاقشا (جۇنگو)</option><option value="kk-cyrl">қазақша (кирил)</option><option value="kk-kz">қазақша (Қазақстан)</option><option value="kk-latn">qazaqşa (latın)</option><option value="kk-tr">qazaqşa (Türkïya)</option><option value="kl">kalaallisut</option><option value="km">ភាសាខ្មែរ</option><option value="kn">ಕನ್ನಡ</option><option value="knc">Yerwa Kanuri</option><option value="ko">한국어</option><option value="ko-kp">조선말</option><option value="koi">перем коми</option><option value="kr">kanuri</option><option value="krc">къарачай-малкъар</option><option value="kri">Krio</option><option value="krj">Kinaray-a</option><option value="krl">karjal</option><option value="ks">कॉशुर / کٲشُر</option><option value="ks-arab">کٲشُر</option><option value="ks-deva">कॉशुर</option><option value="ksh">Ripoarisch</option><option value="ksw">စှီၤ</option><option value="ku">kurdî</option><option value="ku-arab">کوردی (عەرەبی)</option><option value="ku-latn">kurdî (latînî)</option><option value="kum">къумукъ</option><option value="kus">Kʋsaal</option><option value="kv">коми</option><option value="kw">kernowek</option><option value="ky">кыргызча</option><option value="la">Latina</option><option value="lad">Ladino</option><option value="lb">Lëtzebuergesch</option><option value="lbe">лакку</option><option value="lez">лезги</option><option value="lfn">Lingua Franca Nova</option><option value="lg">Luganda</option><option value="li">Limburgs</option><option value="lij">Ligure</option><option value="liv">Līvõ kēļ</option><option value="lki">لەکی</option><option value="lld">Ladin</option><option value="lmo">lombard</option><option value="ln">lingála</option><option value="lo">ລາວ</option><option value="loz">Silozi</option><option value="lrc">لۊری شومالی</option><option value="lt">lietuvių</option><option value="ltg">latgaļu</option><option value="lua">ciluba</option><option value="lus">Mizo ţawng</option><option value="luz">لئری دوٙمینی</option><option value="lv">latviešu</option><option value="lzh">文言</option><option value="lzz">Lazuri</option><option value="mad">Madhurâ</option><option value="mag">मगही</option><option value="mai">मैथिली</option><option value="map-bms">Basa Banyumasan</option><option value="mdf">мокшень</option><option value="mg">Malagasy</option><option value="mhr">олык марий</option><option value="mi">Māori</option><option value="min">Minangkabau</option><option value="mk">македонски</option><option value="ml">മലയാളം</option><option value="mn">монгол</option><option value="mnc">manju gisun</option><option value="mnc-latn">manju gisun</option><option value="mnc-mong">ᠮᠠᠨᠵᡠ ᡤᡳᠰᡠᠨ</option><option value="mni">ꯃꯤꯇꯩ ꯂꯣꯟ</option><option value="mnw">ဘာသာမန်</option><option value="mo">молдовеняскэ</option><option value="mos">moore</option><option value="mr">मराठी</option><option value="mrh">Mara</option><option value="mrj">кырык мары</option><option value="ms">Bahasa Melayu</option><option value="ms-arab">بهاس ملايو</option><option value="mt">Malti</option><option value="mui">Baso Palembang</option><option value="mwl">Mirandés</option><option value="my">မြန်မာဘာသာ</option><option value="myv">эрзянь</option><option value="mzn">مازِرونی</option><option value="na">Dorerin Naoero</option><option value="nah">Nāhuatl</option><option value="nan">閩南語 / Bân-lâm-gú</option><option value="nan-hant">閩南語（傳統漢字）</option><option value="nan-latn-pehoeji">Bân-lâm-gú (Pe̍h-ōe-jī)</option><option value="nan-latn-tailo">Bân-lâm-gú (Tâi-lô)</option><option value="nap">Napulitano</option><option value="nb">norsk bokmål</option><option value="nds">Plattdüütsch</option><option value="nds-nl">Nedersaksies</option><option value="ne">नेपाली</option><option value="new">नेपाल भाषा</option><option value="nia">Li Niha</option><option value="nit">కొలామి</option><option value="niu">Niuē</option><option value="nl">Nederlands</option><option value="nl-informal">Nederlands (informeel)</option><option value="nmz">nawdm</option><option value="nn">norsk nynorsk</option><option value="nod">ᨣᩤᩴᨾᩮᩬᩥᨦ</option><option value="nog">ногайша</option><option value="nov">Novial</option><option value="nqo">ߒߞߏ</option><option value="nr">isiNdebele seSewula</option><option value="nrm">Nouormand</option><option value="nso">Sesotho sa Leboa</option><option value="nup">Nupe</option><option value="nv">Diné bizaad</option><option value="ny">Chi-Chewa</option><option value="nyn">runyankore</option><option value="nyo">Orunyoro</option><option value="nys">Nyunga</option><option value="oc">occitan</option><option value="ojb">Ojibwemowin</option><option value="olo">livvinkarjala</option><option value="om">Oromoo</option><option value="or">ଓଡ଼ିଆ</option><option value="os">ирон</option><option value="pa">ਪੰਜਾਬੀ</option><option value="pag">Pangasinan</option><option value="pam">Kapampangan</option><option value="pap">Papiamentu</option><option value="pcd">Picard</option><option value="pcm">Naijá</option><option value="pdc">Deitsch</option><option value="pdt">Plautdietsch</option><option value="pfl">Pälzisch</option><option value="pi">पालि</option><option value="pih">Norfuk / Pitkern</option><option value="pl">polski</option><option value="pms">Piemontèis</option><option value="pnb">پنجابی</option><option value="pnt">Ποντιακά</option><option value="prg">prūsiskan</option><option value="ps">پښتو</option><option value="pt">português</option><option value="pt-br">português do Brasil</option><option value="pwn">pinayuanan</option><option value="qqq">Message documentation</option><option value="qu">Runa Simi</option><option value="qug">Runa shimi</option><option value="rgn">Rumagnôl</option><option value="rif">Tarifit</option><option value="rki">ရခိုင်</option><option value="rm">rumantsch</option><option value="rmc">romaňi čhib</option><option value="rmy">romani čhib</option><option value="rn">ikirundi</option><option value="ro">română</option><option value="roa-tara">tarandíne</option><option value="rsk">руски</option><option value="ru">русский</option><option value="rue">русиньскый</option><option value="rup">armãneashti</option><option value="ruq">Vlăheşte</option><option value="ruq-cyrl">Влахесте</option><option value="ruq-latn">Vlăheşte</option><option value="rut">мыхаӀбишды</option><option value="rw">Ikinyarwanda</option><option value="ryu">うちなーぐち</option><option value="sa">संस्कृतम्</option><option value="sah">саха тыла</option><option value="sat">ᱥᱟᱱᱛᱟᱲᱤ</option><option value="sc">sardu</option><option value="scn">sicilianu</option><option value="sco">Scots</option><option value="sd">سنڌي</option><option value="sdc">Sassaresu</option><option value="sdh">کوردی خوارگ</option><option value="se">davvisámegiella</option><option value="se-fi">davvisámegiella (Suoma bealde)</option><option value="se-no">davvisámegiella (Norgga bealde)</option><option value="se-se">davvisámegiella (Ruoŧa bealde)</option><option value="sei">Cmique Itom</option><option value="ses">Koyraboro Senni</option><option value="sg">Sängö</option><option value="sgs">žemaitėška</option><option value="sh">srpskohrvatski / српскохрватски</option><option value="sh-cyrl">српскохрватски (ћирилица)</option><option value="sh-latn">srpskohrvatski (latinica)</option><option value="shi">Taclḥit</option><option value="shn">ၽႃႇသႃႇတႆး </option><option value="shy">tacawit</option><option value="shy-latn">tacawit</option><option value="si">සිංහල</option><option value="sjd">кӣллт са̄мь кӣлл</option><option value="sje">bidumsámegiella</option><option value="sk">slovenčina</option><option value="skr">سرائیکی</option><option value="skr-arab">سرائیکی</option><option value="sl">slovenščina</option><option value="sli">Schläsch</option><option value="sm">Gagana Samoa</option><option value="sma">åarjelsaemien</option><option value="smn">anarâškielâ</option><option value="sms">nuõrttsääʹmǩiõll</option><option value="sn">chiShona</option><option value="so">Soomaaliga</option><option value="sq">shqip</option><option value="sr">српски / srpski</option><option value="sr-ec">српски (ћирилица)</option><option value="sr-el">srpski (latinica)</option><option value="srn">Sranantongo</option><option value="sro">sardu campidanesu</option><option value="ss">SiSwati</option><option value="st">Sesotho</option><option value="stq">Seeltersk</option><option value="sty">себертатар</option><option value="su">Sunda</option><option value="sv">svenska</option><option value="sw">Kiswahili</option><option value="syl">ꠍꠤꠟꠐꠤ</option><option value="szl">ślůnski</option><option value="szy">Sakizaya</option><option value="ta">தமிழ்</option><option value="tay">Tayal</option><option value="tcy">ತುಳು</option><option value="tdd">ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ</option><option value="te">తెలుగు</option><option value="tet">tetun</option><option value="tg">тоҷикӣ</option><option value="tg-cyrl">тоҷикӣ</option><option value="tg-latn">tojikī</option><option value="th">ไทย</option><option value="ti">ትግርኛ</option><option value="tig">ትግሬ</option><option value="tk">Türkmençe</option><option value="tl">Tagalog</option><option value="tly">tolışi</option><option value="tn">Setswana</option><option value="to">lea faka-Tonga</option><option value="tok">toki pona</option><option value="tpi">Tok Pisin</option><option value="tr">Türkçe</option><option value="tru">Ṫuroyo</option><option value="trv">Seediq</option><option value="ts">Xitsonga</option><option value="tt">татарча / tatarça</option><option value="tt-cyrl">татарча</option><option value="tt-latn">tatarça</option><option value="ttj">Orutooro</option><option value="tum">chiTumbuka</option><option value="tw">Twi</option><option value="ty">reo tahiti</option><option value="tyv">тыва дыл</option><option value="tzm">ⵜⴰⵎⴰⵣⵉⵖⵜ</option><option value="udm">удмурт</option><option value="ug">ئۇيغۇرچە / Uyghurche</option><option value="ug-arab">ئۇيغۇرچە</option><option value="ug-latn">Uyghurche</option><option value="uk">українська</option><option value="ur">اردو</option><option value="uz">oʻzbekcha / ўзбекча</option><option value="ve">Tshivenda</option><option value="vec">vèneto</option><option value="vep">vepsän kel’</option><option value="vi">Tiếng Việt</option><option value="vls">West-Vlams</option><option value="vmf">Mainfränkisch</option><option value="vmw">emakhuwa</option><option value="vo">Volapük</option><option value="vot">Vaďďa</option><option value="vro">võro</option><option value="wa">walon</option><option value="wal">wolaytta</option><option value="war">Winaray</option><option value="wls">Fakaʻuvea</option><option value="wo">Wolof</option><option value="wuu">吴语</option><option value="wuu-hans">吴语（简体）</option><option value="wuu-hant">吳語（正體）</option><option value="xal">хальмг</option><option value="xh">isiXhosa</option><option value="xmf">მარგალური</option><option value="xsy">saisiyat</option><option value="yi">ייִדיש</option><option value="yo">Yorùbá</option><option value="yrl">Nhẽẽgatú</option><option value="yue">粵語</option><option value="yue-hans">粵语（简体）</option><option value="yue-hant">粵語（繁體）</option><option value="za">Vahcuengh</option><option value="zea">Zeêuws</option><option value="zgh">ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ</option><option value="zh">中文</option><option value="zh-cn">中文（中国大陆）</option><option value="zh-hans">中文（简体）</option><option value="zh-hant">中文（繁體）</option><option value="zh-hk">中文（香港）</option><option value="zh-mo">中文（澳門）</option><option value="zh-my">中文（马来西亚）</option><option value="zh-sg">中文（新加坡）</option><option value="zh-tw">中文（臺灣）</option><option value="zu">isiZulu</option></select><input id="languageselector-commit-1" style="" type="submit" value="set"></form></span></div>
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Ansys</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Alliance Doc</div>
		<div id="contentSub"><div id="mw-content-subtitle"></div></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content"><div class="mw-pt-translate-header noprint nomobile" dir="ltr" lang="en">This page contains <span class="plainlinks"><a rel="nofollow" class="external text" href="https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys&amp;oldid=173088&amp;diff=177665">changes</a></span> which are not marked for translation.</div><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="en" dir="ltr">English</span></li>
<li><a href="/wiki/Ansys/fr" class="mw-pt-progress mw-pt-progress--complete" title="Ansys (100% translated)" lang="fr" dir="ltr">français</a></li></ul></div>
<p><a rel="nofollow" class="external text" href="http://www.ansys.com/">Ansys</a> is a software suite for engineering simulation and 3-D design. It includes packages such as <a rel="nofollow" class="external text" href="http://www.ansys.com/Products/Fluids/ANSYS-Fluent">Ansys Fluent</a> and <a rel="nofollow" class="external text" href="http://www.ansys.com/products/fluids/ansys-cfx">Ansys CFX</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Licensing"><span class="tocnumber">1</span> <span class="toctext">Licensing</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Configuring_your_license_file"><span class="tocnumber">1.1</span> <span class="toctext">Configuring your license file</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Local_license_servers"><span class="tocnumber">1.1.1</span> <span class="toctext">Local license servers</span></a>
<ul>
<li class="toclevel-4 tocsection-4"><a href="#Ready_to_use"><span class="tocnumber">1.1.1.1</span> <span class="toctext">Ready to use</span></a></li>
<li class="toclevel-4 tocsection-5"><a href="#Setup_required"><span class="tocnumber">1.1.1.2</span> <span class="toctext">Setup required</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Checking_license"><span class="tocnumber">1.2</span> <span class="toctext">Checking license</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Version_compatibility"><span class="tocnumber">2</span> <span class="toctext">Version compatibility</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Platform_support"><span class="tocnumber">2.1</span> <span class="toctext">Platform support</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#What&#39;s_new"><span class="tocnumber">2.2</span> <span class="toctext">What's new</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Service_packs"><span class="tocnumber">2.3</span> <span class="toctext">Service packs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Cluster_batch_job_submission"><span class="tocnumber">3</span> <span class="toctext">Cluster batch job submission</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Ansys_Fluent"><span class="tocnumber">3.1</span> <span class="toctext">Ansys Fluent</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Slurm_scripts"><span class="tocnumber">3.1.1</span> <span class="toctext">Slurm scripts</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#General_purpose"><span class="tocnumber">3.1.1.1</span> <span class="toctext">General purpose</span></a></li>
<li class="toclevel-4 tocsection-15"><a href="#License_requeue"><span class="tocnumber">3.1.1.2</span> <span class="toctext">License requeue</span></a></li>
<li class="toclevel-4 tocsection-16"><a href="#Solution_restart"><span class="tocnumber">3.1.1.3</span> <span class="toctext">Solution restart</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-17"><a href="#Journal_files"><span class="tocnumber">3.1.2</span> <span class="toctext">Journal files</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#UDFs"><span class="tocnumber">3.1.3</span> <span class="toctext">UDFs</span></a>
<ul>
<li class="toclevel-4 tocsection-19"><a href="#Interpreted"><span class="tocnumber">3.1.3.1</span> <span class="toctext">Interpreted</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="#Compiled"><span class="tocnumber">3.1.3.2</span> <span class="toctext">Compiled</span></a></li>
<li class="toclevel-4 tocsection-21"><a href="#Parallel"><span class="tocnumber">3.1.3.3</span> <span class="toctext">Parallel</span></a></li>
<li class="toclevel-4 tocsection-22"><a href="#DPM"><span class="tocnumber">3.1.3.4</span> <span class="toctext">DPM</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="#Ansys_CFX"><span class="tocnumber">3.2</span> <span class="toctext">Ansys CFX</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#Slurm_scripts_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Slurm scripts</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Workbench"><span class="tocnumber">3.3</span> <span class="toctext">Workbench</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Slurm_scripts_3"><span class="tocnumber">3.3.1</span> <span class="toctext">Slurm scripts</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#Mechanical"><span class="tocnumber">3.4</span> <span class="toctext">Mechanical</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#Slurm_scripts_4"><span class="tocnumber">3.4.1</span> <span class="toctext">Slurm scripts</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#Ansys_EDT"><span class="tocnumber">3.5</span> <span class="toctext">Ansys EDT</span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="#Slurm_scripts_5"><span class="tocnumber">3.5.1</span> <span class="toctext">Slurm scripts</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#Ansys_ROCKY"><span class="tocnumber">3.6</span> <span class="toctext">Ansys ROCKY</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Slurm_scripts_6"><span class="tocnumber">3.6.1</span> <span class="toctext">Slurm scripts</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="#Graphical_use"><span class="tocnumber">4</span> <span class="toctext">Graphical use</span></a>
<ul>
<li class="toclevel-2 tocsection-34"><a href="#Compute_nodes"><span class="tocnumber">4.1</span> <span class="toctext">Compute nodes</span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#Fluids"><span class="tocnumber">4.1.1</span> <span class="toctext">Fluids</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#Mapdl"><span class="tocnumber">4.1.2</span> <span class="toctext">Mapdl</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#Workbench_2"><span class="tocnumber">4.1.3</span> <span class="toctext">Workbench</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Ansys_EDT_2"><span class="tocnumber">4.1.4</span> <span class="toctext">Ansys EDT</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#Ensight"><span class="tocnumber">4.1.5</span> <span class="toctext">Ensight</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="#Rocky"><span class="tocnumber">4.1.6</span> <span class="toctext">Rocky</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#VDI_nodes"><span class="tocnumber">4.2</span> <span class="toctext">VDI nodes</span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="#Fluids_2"><span class="tocnumber">4.2.1</span> <span class="toctext">Fluids</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#Mapdl_2"><span class="tocnumber">4.2.2</span> <span class="toctext">Mapdl</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Workbench_3"><span class="tocnumber">4.2.3</span> <span class="toctext">Workbench</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#Ansys_EDT_3"><span class="tocnumber">4.2.4</span> <span class="toctext">Ansys EDT</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#Ensight_2"><span class="tocnumber">4.2.5</span> <span class="toctext">Ensight</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#Rocky_2"><span class="tocnumber">4.2.6</span> <span class="toctext">Rocky</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-48"><a href="#SSH_issues"><span class="tocnumber">4.3</span> <span class="toctext">SSH issues</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49"><a href="#Site-specific_usage"><span class="tocnumber">5</span> <span class="toctext">Site-specific usage</span></a>
<ul>
<li class="toclevel-2 tocsection-50"><a href="#SHARCNET_license"><span class="tocnumber">5.1</span> <span class="toctext">SHARCNET license</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="#License_server_file"><span class="tocnumber">5.1.1</span> <span class="toctext">License server file</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#Query_license_server"><span class="tocnumber">5.1.2</span> <span class="toctext">Query license server</span></a></li>
<li class="toclevel-3 tocsection-53"><a href="#Local_VDI_modules"><span class="tocnumber">5.1.3</span> <span class="toctext">Local VDI modules</span></a>
<ul>
<li class="toclevel-4 tocsection-54"><a href="#Ansys_modules"><span class="tocnumber">5.1.3.1</span> <span class="toctext">Ansys modules</span></a></li>
<li class="toclevel-4 tocsection-55"><a href="#ansysedt_modules"><span class="tocnumber">5.1.3.2</span> <span class="toctext">ansysedt modules</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-56"><a href="#Additive_Manufacturing"><span class="tocnumber">6</span> <span class="toctext">Additive Manufacturing</span></a>
<ul>
<li class="toclevel-2 tocsection-57"><a href="#Enable_Additive"><span class="tocnumber">6.1</span> <span class="toctext">Enable Additive</span></a>
<ul>
<li class="toclevel-3 tocsection-58"><a href="#Download_Extension"><span class="tocnumber">6.1.1</span> <span class="toctext">Download Extension</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#Start_Workbench"><span class="tocnumber">6.1.2</span> <span class="toctext">Start Workbench</span></a></li>
<li class="toclevel-3 tocsection-60"><a href="#Open_Extension_Manager"><span class="tocnumber">6.1.3</span> <span class="toctext">Open Extension Manager</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#Install_Extension"><span class="tocnumber">6.1.4</span> <span class="toctext">Install Extension</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#Load_Extension"><span class="tocnumber">6.1.5</span> <span class="toctext">Load Extension</span></a></li>
<li class="toclevel-3 tocsection-63"><a href="#Unload_Extension"><span class="tocnumber">6.1.6</span> <span class="toctext">Unload Extension</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-64"><a href="#Run_Additive"><span class="tocnumber">6.2</span> <span class="toctext">Run Additive</span></a>
<ul>
<li class="toclevel-3 tocsection-65"><a href="#Gra-vdi"><span class="tocnumber">6.2.1</span> <span class="toctext">Gra-vdi</span></a></li>
<li class="toclevel-3 tocsection-66"><a href="#Cluster"><span class="tocnumber">6.2.2</span> <span class="toctext">Cluster</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-67"><a href="#Help_resources"><span class="tocnumber">7</span> <span class="toctext">Help resources</span></a>
<ul>
<li class="toclevel-2 tocsection-68"><a href="#Online_documentation"><span class="tocnumber">7.1</span> <span class="toctext">Online documentation</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#Youtube_videos"><span class="tocnumber">7.2</span> <span class="toctext">Youtube videos</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#Innovation_Space"><span class="tocnumber">7.3</span> <span class="toctext">Innovation Space</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Licensing">Licensing</span></h1>
<p>We are a hosting provider for Ansys. This means that we have the software installed on our clusters, but we do not provide a generic license accessible to everyone. However, many institutions, faculties, and departments already have licenses that can be used on our clusters.  Once the legal aspects are worked out for licensing, there will be remaining technical aspects. The license server on your end will need to be reachable by our compute nodes. This will require our technical team to get in touch with the technical people managing your license software. In some cases, this has already been done. You should then be able to load the Ansys module, and it should find its license automatically. If this is not the case, please contact our <a href="/wiki/Technical_support" title="Technical support">technical support</a> so that they can arrange this for you.
</p>
<h2><span class="mw-headline" id="Configuring_your_license_file">Configuring your license file</span></h2>
<p>Our module for Ansys is designed to look for license information in a few places. One of those places is your /home folder. You can specify your license server by creating a file named <code>$HOME/.licenses/ansys.lic</code> consisting of two lines as shown.  Customize the file to replacing FLEXPORT, INTEPORT and LICSERVER with appropriate values for your server. 
</p>
<table class="wikitable" style="text-align:left; border:1px solid #BBB; background-color:#F9F9F9; width:50%;">
<caption style="text-align:left; background-color:#F2F2F2; font-size:110%">FILE: ansys.lic
</caption>
<tbody><tr>
<td style="border-style: none none none none; font-size: 100%; padding-left:10%; padding-bottom:0;">setenv("ANSYSLMD_LICENSE_FILE", "<b>FLEXPORT@LICSERVER</b>")
</td></tr>
<tr>
<td style="border-style: none none none none; font-size: 100%; padding-left:10%; padding-top:0;">setenv("ANSYSLI_SERVERS", "<b>INTEPORT@LICSERVER</b>")
</td></tr></tbody></table>
<p>The following table provides established values for the CMC and SHARCNET license servers.  To use a different server, locate the corresponding values as explained in <a href="#Local_license_servers">Local license servers</a>.
</p>
<table class="wikitable">
<caption style="text-align:left; background-color:#F2F2F2; font-size:110%">TABLE: Preconfigured license servers
</caption>
<tbody><tr>
<th>License
</th>
<th>System/Cluster
</th>
<th>LICSERVER
</th>
<th>FLEXPORT
</th>
<th>INTEPORT
</th>
<th>VENDPORT
</th>
<th>NOTICES
</th></tr>
<tr>
<td>CMC
</td>
<td>beluga
</td>
<td><code>10.20.73.21</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>n/a
</td>
<td>None
</td></tr>
<tr>
<td>CMC
</td>
<td>cedar
</td>
<td><code>172.16.0.101</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>n/a
</td>
<td>None
</td></tr>
<tr>
<td>CMC
</td>
<td>graham
</td>
<td><code>10.25.1.56</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>n/a
</td>
<td>NewIP Feb21/2025
</td></tr>
<tr>
<td>CMC
</td>
<td>narval
</td>
<td><code>10.100.64.10</code>
</td>
<td><code>6624</code>
</td>
<td><code>2325</code>
</td>
<td>n/a
</td>
<td>None
</td></tr>
<tr>
<td>SHARCNET
</td>
<td>beluga/cedar/graham/gra-vdi/narval
</td>
<td><code>license3.sharcnet.ca</code>
</td>
<td><code>1055</code>
</td>
<td><code>2325</code>
</td>
<td>n/a
</td>
<td>None
</td></tr>
<tr>
<td>SHARCNET
</td>
<td>niagara
</td>
<td><code>localhost</code>
</td>
<td><code>1055</code>
</td>
<td><code>2325</code>
</td>
<td><code>1793</code>
</td>
<td>None
</td></tr></tbody></table>
<p>Researchers who purchase a CMC license subscription must send their Alliance account username to &lt;cmcsupport@cmc.ca&gt; otherwise license checkouts will fail. 
</p><p>Researchers who purchase a CMC license subscription must create a <a rel="nofollow" class="external text" href="https://www.cmc.ca/support/">CMC</a> support case to submit their Alliance account username otherwise license checkouts will fail. The number of cores that can be used with a CMC license is described in the <i>Other Tricks and Tips</i> sections of the <a rel="nofollow" class="external text" href="https://www.cmc.ca/?s=Other+Tricks+and+Tips&amp;lang=en/">Ansys Electronics Desktop and  Ansys Mechanical/Fluids quick start guides</a>.
</p>
<h3><span class="mw-headline" id="Local_license_servers">Local license servers</span></h3>
<p>Before a local institutional Ansys license server can be used on the Alliance, firewall changes will need to be done on both the server and cluster side.  For many Ansys servers this work has already been done and they can be used by following the steps in the "Ready To Use" section below.  For Ansys servers that have never used on the Alliance, two additional steps must be done as shown in the "Setup Required" section also below.
</p>
<h4><span class="mw-headline" id="Ready_to_use">Ready to use</span></h4>
<p>To use an ANSYS License server that has already been set up for use on the cluster where you will be submitting jobs, contact your local Ansys license server administrator and get the following three pieces (1-&gt;3) of information:
</p>
<pre>1) the fully qualified hostname (LICSERVER) of the server
2) the Ansys flex port (FLEXPORT) number commonly 1055
3) the Ansys licensing interconnect port (INTEPORT) number commonly 2325
</pre>
<p>Once the three pieces of information are collected, configure your <code>~/.licenses/ansys.lic</code> file by plugging the values for LICSERVER, FLEXPORT and INTEPORT into the <code>FILE: ansys.lic</code> template above.
</p>
<h4><span class="mw-headline" id="Setup_required">Setup required</span></h4>
<p>If your local Ansys license server has never been setup for use on the Alliance cluster(s) where you will be submitting jobs, then in addition to (1-&gt;3) above, you will ALSO need to get the following items (4,5) from the administrator:
</p>
<pre> 4) the static vendor port (VENDPORT) number from your local Ansys server administrator
 5) confirmation that &lt;servername&gt; will resolve to the same IP as LICSERVER on Alliance clusters
</pre>
<p>where the &lt;servername&gt; can be found in the first line of the license file with format "SERVER &lt;servername&gt; &lt;host id&gt; &lt;lmgrd port&gt;".  Item (5) is required; otherwise, Ansys license checkouts will not work on any remote cluster at the Alliance.  If it turns out &lt;servername&gt; does not meet this requirement then request your license administrator to change &lt;servername&gt; to either the same fully qualified hostname as LICSERVER or at least to a hostname that will resolve to the same IP address as LICSERVER remotely.
</p><p>Finally, send (1-&gt;4) by email to <a href="/wiki/Technical_support" title="Technical support">technical support</a> being sure to mention which Alliance cluster(s) you want to run Ansys jobs on. Alliance system administrators will then proceed to open the firewall so license checkout requests can reach your license server from the specified cluster(s) compute nodes.  In return you will then receive a range of IP addresses to forward to your server administrator can then open the local firewall to permit inbound Ansys license connections from the cluster(s) on EACH of the ports defined by FLEXPORT, INTEPORT and VENDPORT.
</p>
<h2><span class="mw-headline" id="Checking_license">Checking license</span></h2>
<p>To test if your <code>ansys.lic</code> is configured and working properly copy/paste the following sequence of commands on the cluster you will be submitting jobs to.  The only required change would be to specify YOURUSERID.  If the software on a remote license server has not been updated then a failure can occur if the latest module version of ansys is loaded to test with.  Therefore to be certain the license checkouts will work when jobs are run in the queue, the same ansys module version that you load in your slurm scripts should be specified below.
</p>
<pre>[gra-login:~] cd /tmp
[gra-login:~] salloc --time=1:0:0 --mem=1000M --account=def-YOURUSERID
[gra-login:~] module load StdEnv/2023; module load ansys/2023R2
[gra-login:~] $EBROOTANSYS/v$(echo ${EBVERSIONANSYS:2:2}${EBVERSIONANSYS:5:1})/licensingclient/linx64/lmutil lmstat -c $ANSYSLMD_LICENSE_FILE 1&gt; /dev/null &amp;&amp; echo Success || echo Fail
</pre>
<p>If <code>Success</code> is output license checkouts should work when jobs are submitted to the queue.<br />
If <code>Fail</code> is output then jobs will likely fail requiring a problem ticket to be submitted to resolve.
</p>
<h1><span class="mw-headline" id="Version_compatibility">Version compatibility</span></h1>
<p>Ansys simulations are typically forward compatible but <span style="color:red">NOT</span> backwards compatible.  This means that simulations created using an older version of Ansys can be expected to load and run fine with any newer version.  For example, a simulation created and saved with ansys/2022R2 should load and run smoothly with ansys/2023R2 but <span style="color:red">NOT</span> the other way around.  While it maybe possible to start a simulation running with an older version random error messages or crashing will likely occur.  Regarding Fluent simulations, if you cannot recall which version of ansys was used to create your cas file try grepping it as follows to look for clues&#160;:
</p>
<pre>$ grep -ia fluent combustor.cas
  (0 "fluent15.0.7  build-id: 596")
</pre>
<pre>$ grep -ia fluent cavity.cas.h5
  ANSYS_FLUENT 24.1 Build 1018
</pre>
<h2><span class="mw-headline" id="Platform_support">Platform support</span></h2>
<p>Ansys provides detailed platform support information describing software/hardware compatibility for the <a rel="nofollow" class="external text" href="https://www.ansys.com/it-solutions/platform-support">Current Release</a> and <a rel="nofollow" class="external text" href="https://www.ansys.com/it-solutions/platform-support/previous-releases">Previous Releases</a>.   The <i>Platform Support by Application / Product</i> pdf is of special interest since it shows which packages are supported under Windows but not under Linux and thus not on the Alliance such as Spaceclaim.
</p>
<h2><span id="What.27s_new"></span><span class="mw-headline" id="What's_new">What's new</span></h2>
<p>Ansys posts <a rel="nofollow" class="external text" href="https://www.ansys.com/products/release-highlights">Product Release and Updates</a> for the latest releases.  Similar information for previous releases can generally be pulled up for various application topics by visiting the Ansys <a rel="nofollow" class="external text" href="https://www.ansys.com/blog">blog</a> page and using the FILTERS search bar.  For example, searching on <code>What’s New Fluent 2024 gpu</code> pulls up a document with title <code><a rel="nofollow" class="external text" href="https://www.ansys.com/blog/fluent-2024-r1">What’s New for Ansys Fluent in 2024 R1?</a></code> containing a wealth of the latest gpu support information. Specifying a version number in the <a rel="nofollow" class="external text" href="https://www.ansys.com/news-center/press-releases">Press Release</a> search bar is also a good way to find new release information.   At the time of this writing Ansys 2024R2 is the current release and will be installed when interest is expressed or there is evident need to support newer hardware or solver capabilities.  To request a new version be installed <a href="/wiki/Technical_support" title="Technical support">submit a ticket</a>.
</p>
<h2><span class="mw-headline" id="Service_packs">Service packs</span></h2>
<p>Starting with Ansys 2024 a separate Ansys module will appear on the clusters with a decimal and two digits appearing after the release number whenever a service pack is been installed over the initial release.  For example, the initial 2024 release with no service pack applied may be loaded with  <code>module load ansys/2024R1</code> while a module with Service Pack 3 applied may be loaded with <code>module load ansys/2024R1.03</code> instead.  If a service pack is already available by the time a new release is to be installed, then most likely only a module for that service pack number will be installed unless a request to install the initial release is also received.
</p><p>Most users will likely want to load the latest module version equipped with the latest installed service pack which can be achieved by simply doing <code>module load ansys</code>.  While it's not expected service packs will impact numerical results, the changes they make are extensive and so, if computations have already been done with the initial release or an earlier service pack then some groups may prefer to continue using it. Having separate modules for each service pack makes this possible.  Starting with Ansys 2024R1 a detailed description of what each service pack does can be found by searching this <a rel="nofollow" class="external text" href="https://storage.ansys.com/staticfiles/cp/Readme/release2024R1/info_combined.pdf">link</a> for <i>Service Pack Details</i>.  Future versions will presumably be similarly searchable by manually modifying the version number contained in the link.
</p>
<h1><span class="mw-headline" id="Cluster_batch_job_submission">Cluster batch job submission</span></h1>
<p>The Ansys software suite comes with multiple implementations of MPI to support parallel computation. Unfortunately, none of them support our <a href="/wiki/Running_jobs" title="Running jobs">Slurm scheduler</a>. For this reason, we need special instructions for each Ansys package on how to start a parallel job. In the sections below, we give examples of submission scripts for some of the packages.  While the slurm scripts should work with on all clusters, Niagara users may need to make some additional changes covered <a rel="nofollow" class="external text" href="https://docs.scinet.utoronto.ca/index.php">here</a>.
</p>
<h2><span class="mw-headline" id="Ansys_Fluent">Ansys Fluent</span></h2>
<p>Typically, you would use the following procedure to run Fluent on one of our clusters:
</p>
<ol><li>Prepare your Fluent job using Fluent from the Ansys Workbench on your desktop machine up to the point where you would run the calculation.</li>
<li>Export the "case" file with <i>File &gt; Export &gt; Case…</i> or find the folder where Fluent saves your project's files. The case file will often have a name like <code>FFF-1.cas.gz</code>.</li>
<li>If you already have data from a previous calculation, which you want to continue, export a "data" file as well (<i>File &gt; Export &gt; Data…</i>) or find it in the same project folder (<code>FFF-1.dat.gz</code>).</li>
<li><a href="/wiki/Transferring_data" title="Transferring data">Transfer</a> the case file (and if needed the data file) to a directory on the <a href="/wiki/Project_layout" title="Project layout">/project</a> or <a href="/wiki/Storage_and_file_management#Storage_types" title="Storage and file management">/scratch</a> filesystem on the cluster.  When exporting, you can save the file(s) under a more instructive name than <code>FFF-1.*</code> or rename them when they are uploaded.</li>
<li>Now you need to create a "journal" file. Its purpose is to load the case file (and optionally the data file), run the solver and finally write the results.  See examples below and remember to adjust the filenames and desired number of iterations.</li>
<li>If jobs frequently fail to start due to license shortages and manual resubmission of failed jobs is not convenient, consider modifying your script to requeue your job (up to 4 times) as shown under the <i>by node + requeue</i> tab further below.  Be aware that doing this will also requeue simulations that fail due to non-license related issues (such as divergence), resulting in lost compute time.  Therefore it is strongly recommended to monitor and inspect each Slurm output file to confirm each requeue attempt is license related.  When it is determined that a job is requeued due to a simulation issue, immediately manually kill the job progression with <code>scancel jobid</code> and correct the problem.</li>
<li>After <a href="/wiki/Running_jobs" title="Running jobs">running the job</a>, you can download the data file and import it back into Fluent with <i>File &gt; Import &gt; Data…</i>.</li></ol>
<h3><span class="mw-headline" id="Slurm_scripts">Slurm scripts</span></h3>
<h4><span class="mw-headline" id="General_purpose">General purpose</span></h4>
<p>Most Fluent jobs should use the following <i>by node</i> script to minimize solution latency and maximize performance over as few nodes as possible. Very large jobs, however, might wait less in the queue if they use a <i>by core</i> script. However, the startup time of a job using many nodes can be significantly longer, thus offsetting some of the benefits. In addition, be aware that running large jobs over an unspecified number of potentially very many nodes will make them far more vulnerable to crashing if any of the compute nodes fail during the simulation. The scripts will ensure Fluent uses shared memory for communication when run on a single node or distributed memory (utilizing MPI and the appropriate HPC interconnect) when run over multiple nodes.  The two narval tabs maybe be useful to provide a more robust alternative if fluent crashes during the initial auto mesh partitioning phase when using the standard intel based scripts with the parallel solver.  The other option would be to manually perform the mesh partitioning in the fluent gui then try to run the job again on the cluster with the intel scripts.  Doing so will allow you to inspect the partition statistics and specify the partitioning method to obtain an optimal result.  The number of mesh partitions should be an integral multiple of the number of cores; for optimal efficiency, ensure at least 10000 cells per core.
</p>
<form id="tabs-inputform" class="tabs tabs-inputform" action="#"></form><div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-1-0" name="tabs-1" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-1-1" name="tabs-1" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-1-1" data-tabpos="1">Multinode (by node)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-2" name="tabs-1" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-1-2" data-tabpos="2">Multinode (by core)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-3" name="tabs-1" class="tabs-input tabs-input-3" /><label class="tabs-label" for="tabs-input-1-3" data-tabpos="3">Multinode (by node, narval)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-4" name="tabs-1" class="tabs-input tabs-input-4" /><label class="tabs-label" for="tabs-input-1-4" data-tabpos="4">Multinode (by core, narval)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-1-5" name="tabs-1" class="tabs-input tabs-input-5" /><label class="tabs-label" for="tabs-input-1-5" data-tabpos="5">Multinode (by node, niagara)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-intel.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+narval+64%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-intel.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, narval 64, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore-intel.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore-intel.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-3">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-openmpi.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes%0A%23SBATCH+--ntasks-per-node%3D64++%23+Specify+number+of+cores+per+node+%28narval+64+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28narval+only%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aexport+OPENMPI_ROOT%3D%24EBROOTOPENMPI%0Aexport+OMPI_MCA_hwloc_base_binding_policy%3Dcore%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmf-%24SLURM_JOB_ID%0Afor+i+in+%60cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+uniq%60%3B+do+echo+%22%24%7Bi%7D%3A%24%28cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+grep+%24i+%7C+wc+-l%29%22+%3E%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%3B+done%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-openmpi.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes</span>
<span class="c1">#SBATCH --ntasks-per-node=64  # Specify number of cores per node (narval 64 or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (narval only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">OPENMPI_ROOT</span><span class="o">=</span><span class="nv">$EBROOTOPENMPI</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_hwloc_base_binding_policy</span><span class="o">=</span>core
slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">:</span><span class="k">$(</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-4">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore-openmpi.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+number+of+compute+nodes+%28optional%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change+++++%0Amodule+load+ansys%2F2023R2++++++%23+or+newer+versions+%28narval+only%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aexport+OPENMPI_ROOT%3D%24EBROOTOPENMPI%0Aexport+OMPI_MCA_hwloc_base_binding_policy%3Dcore%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmf-%24SLURM_JOB_ID%0Afor+i+in+%60cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+uniq%60%3B+do+echo+%22%24%7Bi%7D%3A%24%28cat+%2Ftmp%2Fmf-%24SLURM_JOB_ID+%7C+grep+%24i+%7C+wc+-l%29%22+%3E%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%3B+done%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dopenmpi+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore-openmpi.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify number of compute nodes (optional)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change     </span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># or newer versions (narval only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">OPENMPI_ROOT</span><span class="o">=</span><span class="nv">$EBROOTOPENMPI</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_MCA_hwloc_base_binding_policy</span><span class="o">=</span>core
slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">:</span><span class="k">$(</span>cat<span class="w"> </span>/tmp/mf-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>openmpi<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-5">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode-intel-nia.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group++++++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00++++++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D2++++++++++++++++%23+Specify+number+of+compute+nodes%0A%23SBATCH+--ntasks-per-node%3D80+++++%23+Specify+number+cores+per+node+%28niagara+80+or+less%29%0A%23SBATCH+--mem%3D0++++++++++++++++++%23+Do+not+change+%28allocate+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1++++++++%23+Do+not+change+%28required+parameter%29%0A%0Amodule+load+CCEnv+StdEnv%2F2023++++%23+Do+not+change%0Amodule+load+arch%2Favx512%0Amodule+load+ansys%2F2023R2+++++++++%23+or+newer+versions+%28niagara+only%29%0A%0AMYJOURNALFILE%3Dsample.jou+++++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d+++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+These+settings+are+used+instead+of+your+%7E%2F.licenses%2Fansys.lic%0ALICSERVER%3Dlicense3.sharcnet.ca+++%23+Specify+license+server+hostname%0AFLEXPORT%3D1055++++++++++++++++++++%23+Specify+server+flex+port%0AINTEPORT%3D2325++++++++++++++++++++%23+Specify+server+interconnect+port%0AVENDPORT%3D1793++++++++++++++++++++%23+Specify+server+vendor+port%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Assh+nia-gw+-fNL+%24FLEXPORT%3A%24LICSERVER%3A%24FLEXPORT++++++%23+Do+not+change%0Assh+nia-gw+-fNL+%24INTEPORT%3A%24LICSERVER%3A%24INTEPORT++++++%23+Do+not+change%0Assh+nia-gw+-fNL+%24VENDPORT%3A%24LICSERVER%3A%24VENDPORT++++++%23+Do+not+change%0Aexport+ANSYSLMD_LICENSE_FILE%3D%24FLEXPORT%40localhost++++%23+Do+not+change%0Aexport+ANSYSLI_SERVERS%3D%24INTEPORT%40localhost++++++++++%23+Do+not+change%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%24SLURM_SUBMIT_DIR%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%21+-L+%22%24HOME%2F.ansys%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.ansys+directory+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.ansys+if+one+exists+and+then+run%3A+ln+-s+%24SCRATCH%2F.ansys+%7E%2F.ansys%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelif+%5B+%21+-L+%22%24HOME%2F.fluentconf%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.fluentconf+directory+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.fluentconf+if+one+exists+and+run%3A+ln+-s+%24SCRATCH%2F.fluentconf+%7E%2F.fluentconf%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelif+%5B+%21+-L+%22%24HOME%2F.flrecent%22+%5D%3B+then%0A++echo+%22ERROR%3A+A+link+to+a+writable+.flrecent+file+does+not+exist.%22%0A++echo+%27Remove+%7E%2F.flrecent+if+one+exists+and+then+run%3A+ln+-s+%24SCRATCH%2F.flrecent+%7E%2F.flrecent%27%0A++echo+%22Then+try+submitting+your+job+again.+Aborting+the+current+job+now%21%22%0Aelse%0A++mkdir+-pv+%24SCRATCH%2F.ansys%0A++mkdir+-pv+%24SCRATCH%2F.fluentconf%0A++touch+%24SCRATCH%2F.flrecent%0A++if+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0A++else%0A+++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-ssh+-pib+-cnf%3D%24SLURM_SUBMIT_DIR%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0A++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode-intel-nia.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group      # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00          # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=2                # Specify number of compute nodes</span>
<span class="c1">#SBATCH --ntasks-per-node=80     # Specify number cores per node (niagara 80 or less)</span>
<span class="c1">#SBATCH --mem=0                  # Do not change (allocate all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1        # Do not change (required parameter)</span>

module<span class="w"> </span>load<span class="w"> </span>CCEnv<span class="w"> </span>StdEnv/2023<span class="w">    </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>arch/avx512
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">         </span><span class="c1"># or newer versions (niagara only)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">         </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                     </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># These settings are used instead of your ~/.licenses/ansys.lic</span>
<span class="nv">LICSERVER</span><span class="o">=</span>license3.sharcnet.ca<span class="w">   </span><span class="c1"># Specify license server hostname</span>
<span class="nv">FLEXPORT</span><span class="o">=</span><span class="m">1055</span><span class="w">                    </span><span class="c1"># Specify server flex port</span>
<span class="nv">INTEPORT</span><span class="o">=</span><span class="m">2325</span><span class="w">                    </span><span class="c1"># Specify server interconnect port</span>
<span class="nv">VENDPORT</span><span class="o">=</span><span class="m">1793</span><span class="w">                    </span><span class="c1"># Specify server vendor port</span>

<span class="c1"># ------- do not change any lines below --------</span>

ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$FLEXPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$FLEXPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$INTEPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$INTEPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
ssh<span class="w"> </span>nia-gw<span class="w"> </span>-fNL<span class="w"> </span><span class="nv">$VENDPORT</span>:<span class="nv">$LICSERVER</span>:<span class="nv">$VENDPORT</span><span class="w">      </span><span class="c1"># Do not change</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ANSYSLMD_LICENSE_FILE</span><span class="o">=</span><span class="nv">$FLEXPORT</span>@localhost<span class="w">    </span><span class="c1"># Do not change</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ANSYSLI_SERVERS</span><span class="o">=</span><span class="nv">$INTEPORT</span>@localhost<span class="w">          </span><span class="c1"># Do not change</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$SLURM_SUBMIT_DIR</span>/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.ansys&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .ansys directory does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.ansys if one exists and then run: ln -s $SCRATCH/.ansys ~/.ansys&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.fluentconf&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .fluentconf directory does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.fluentconf if one exists and run: ln -s $SCRATCH/.fluentconf ~/.fluentconf&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.flrecent&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: A link to a writable .flrecent file does not exist.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Remove ~/.flrecent if one exists and then run: ln -s $SCRATCH/.flrecent ~/.flrecent&#39;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Then try submitting your job again. Aborting the current job now!&quot;</span>
<span class="k">else</span>
<span class="w">  </span>mkdir<span class="w"> </span>-pv<span class="w"> </span><span class="nv">$SCRATCH</span>/.ansys
<span class="w">  </span>mkdir<span class="w"> </span>-pv<span class="w"> </span><span class="nv">$SCRATCH</span>/.fluentconf
<span class="w">  </span>touch<span class="w"> </span><span class="nv">$SCRATCH</span>/.flrecent
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">   </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span><span class="nv">$SLURM_SUBMIT_DIR</span>/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h4><span class="mw-headline" id="License_requeue">License requeue</span></h4>
<p>The scripts in this section should only be used with Fluent jobs that are known to complete normally without generating any errors in the output however typically require multiple requeue attempts to checkout licenses.  They are not recommended for Fluent jobs that may 1) run for a long time before crashing 2) run to completion but contain unresolved journal file warnings, since in both cases the simulations will be repeated from the beginning until the maximum number of requeue attempts specified by the <code>array</code> value is reached.  For these types of jobs, the general purpose scripts above should be used instead.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-2-0" name="tabs-2" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-2-1" name="tabs-2" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-2-1" data-tabpos="1">Multinode (by node + requeue)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-2-2" name="tabs-2" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-2-2" data-tabpos="2">Multinode (by core + requeue)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode+requeue.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+requeue+attempts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++scancel+%24SLURM_ARRAY_JOB_ID%0Aelse%0A++++echo+%22Job+attempt+%24SLURM_ARRAY_TASK_ID+of+%24SLURM_ARRAY_TASK_COUNT+failed+due+to+license+or+simulation+issue%21%22%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A+++++++echo+%22Resubmitting+job+now+%E2%80%A6%22%0A++++else%0A+++++++echo+%22All+job+attempts+failed+exiting+now.%22%0A++++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode+requeue.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of requeue attempts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">    </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job attempt </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2"> of </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2"> failed due to license or simulation issue!&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Resubmitting job now …&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All job attempts failed exiting now.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore+requeue.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29+%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+requeue+attempts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYJOURNALFILE%3Dsample.jou++++++%23+Specify+your+journal+file+name%0AMYVERSION%3D3d++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-i+%24MYJOURNALFILE%0Aelse%0A+fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOURNALFILE%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++scancel+%24SLURM_ARRAY_JOB_ID%0Aelse%0A++++echo+%22Job+attempt+%24SLURM_ARRAY_TASK_ID+of+%24SLURM_ARRAY_TASK_COUNT+failed+due+to+license+or+simulation+issue%21%22%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A+++++++echo+%22Resubmitting+job+now+%E2%80%A6%22%0A++++else%0A+++++++echo+%22All+job+attempts+failed+exiting+now.%22%0A++++fi%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore+requeue.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max) </span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of requeue attempts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYJOURNALFILE</span><span class="o">=</span>sample.jou<span class="w">      </span><span class="c1"># Specify your journal file name</span>
<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                  </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">else</span>
<span class="w"> </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOURNALFILE</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">    </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job attempt </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2"> of </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2"> failed due to license or simulation issue!&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Resubmitting job now …&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">       </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;All job attempts failed exiting now.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h4><span class="mw-headline" id="Solution_restart">Solution restart</span></h4>
<p>The following two scripts are provided to automate restarting very large jobs that require more than the typical seven-day maximum runtime window available on most clusters. Jobs are restarted from the most recent saved time step files. A fundamental requirement is the first time step can be completed within the requested job array time limit (specified at the top of your Slurm script) when starting a simulation from an initialized solution field. It is assumed that a standard fixed time step size is being used. To begin, a working set of sample.cas, sample.dat and sample.jou files must be present. Next edit your sample.jou file to contain <code>/solve/dual-time-iterate 1</code> and <code>/file/auto-save/data-frequency 1</code>. Then create a restart journal file by doing <code>cp sample.jou sample-restart.jou</code> and edit the sample-restart.jou file to contain <code>/file/read-cas-data sample-restart</code> instead of <code>/file/read-cas-data sample</code> and comment out the initialization line with a semicolon for instance <code>;/solve/initialize/initialize-flow</code>. If your 2nd and subsequent time steps are known to run twice as fast (as the initial time step), edit sample-restart.jou to specify <code>/solve/dual-time-iterate 2</code>. By doing this, the solution will only be restarted after two 2 time steps are completed following the initial time step. An output file for each time step will still be saved in the output subdirectory. The value 2 is arbitrary but should be chosen such that the time for 2 steps fits within the job array time limit. Doing this will minimize the number of solution restarts which are computationally expensive. If your first time step performed by sample.jou starts from a converged (previous) solution, choose 1 instead of 2 since likely all time steps will require a similar amount of wall time to complete. Assuming 2 is chosen, the total time of simulation to be completed will be 1*Dt+2*Nrestart*Dt where Nrestart is the number of solution restarts specified in the script. The total number of time steps (and hence the number of output files generated) will therefore be 1+2*Nrestart. The value for the time resource request should be chosen so the initial time step and subsequent time steps will complete comfortably within the Slurm time window specifiable up to a maximum of "#SBATCH --time=07-00:00" days.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-3-0" name="tabs-3" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-3-1" name="tabs-3" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-3-1" data-tabpos="1">Multinode (by node + restart)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-3-2" name="tabs-3" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-3-2" data-tabpos="2">Multinode (by core + restart)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bynode+restart.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D07-00%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+number+of+compute+nodes+%28narval+1+node+max%29%0A%23SBATCH+--ntasks-per-node%3D32++%23+Specify+number+of+cores+per+node+%28graham+32+or+44%2C+cedar+48%2C+beluga+40%2C+narval+64%2C+or+less%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Do+not+change+%28allocates+all+memory+per+compute+node%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+solution+restarts+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYVERSION%3D3d++++++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0AMYJOUFILE%3Dsample.jou++++++++++++++++%23+Specify+your+journal+filename%0AMYJOUFILERES%3Dsample-restart.jou+++++%23+Specify+journal+restart+filename%0AMYCASFILERES%3Dsample-restart.cas.h5++%23+Specify+cas+restart+filename%0AMYDATFILERES%3Dsample-restart.dat.h5++%23+Specify+dat+restart+filename%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NNODES+%2A+SLURM_NTASKS_PER_NODE+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0A%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp+and+replace+sample+with+your+journal+filename+%E2%80%A6%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-i+%24MYJOUFILERES%0A++fi%0Aelse+%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-mpi%3Dintel+-ssh+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+2ddp+-t+%24NCORES+-affinity%3D0+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-mpi%3Dintel+-ssh+-i+%24MYJOUFILERES%0A++fi%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo%0A++++echo+%22SLURM_ARRAY_TASK_ID++%3D+%24SLURM_ARRAY_TASK_ID%22%0A++++echo+%22SLURM_ARRAY_TASK_COUNT+%3D+%24SLURM_ARRAY_TASK_COUNT%22%0A++++echo%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A++++++echo+%22Restarting+job+with+the+most+recent+output+dat+file+%E2%80%A6%22%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.cas+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYCASFILERES%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.dat+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYDATFILERES%0A++++++ls+-lh+cavity%2A+output%2F%2A%0A++++else%0A++++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++++scancel+%24SLURM_ARRAY_JOB_ID%0A+++++fi%0Aelse%0A+++++echo+%22Simulation+failed.+Exiting+%E2%80%A6%22%0Afi" />
<input type="hidden" name="filename" value="script-flu-bynode+restart.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=07-00:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify number of compute nodes (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks-per-node=32  # Specify number of cores per node (graham 32 or 44, cedar 48, beluga 40, narval 64, or less)</span>
<span class="c1">#SBATCH --mem=0               # Do not change (allocates all memory per compute node)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of solution restarts (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                        </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>
<span class="nv">MYJOUFILE</span><span class="o">=</span>sample.jou<span class="w">                </span><span class="c1"># Specify your journal filename</span>
<span class="nv">MYJOUFILERES</span><span class="o">=</span>sample-restart.jou<span class="w">     </span><span class="c1"># Specify journal restart filename</span>
<span class="nv">MYCASFILERES</span><span class="o">=</span>sample-restart.cas.h5<span class="w">  </span><span class="c1"># Specify cas restart filename</span>
<span class="nv">MYDATFILERES</span><span class="o">=</span>sample-restart.dat.h5<span class="w">  </span><span class="c1"># Specify dat restart filename</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NNODES</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_NTASKS_PER_NODE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="c1"># Specify 2d, 2ddp, 3d or 3ddp and replace sample with your journal filename …</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span>2ddp<span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-ssh<span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_ID  = </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_COUNT = </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restarting job with the most recent output dat file …&quot;</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.cas<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYCASFILERES</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.dat<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYDATFILERES</span>
<span class="w">      </span>ls<span class="w"> </span>-lh<span class="w"> </span>cavity*<span class="w"> </span>output/*
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">      </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="w">     </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">     </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Simulation failed. Exiting …&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-flu-bycore+restart.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23%23SBATCH+--nodes%3D1++++++++++++%23+Uncomment+to+specify+%28narval+1+node+max%29%0A%23SBATCH+--ntasks%3D16+++++++++++%23+Specify+total+number+of+cores%0A%23SBATCH+--mem-per-cpu%3D4G++++++%23+Specify+memory+per+core%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%23SBATCH+--array%3D1-5%251+++++++++%23+Specify+number+of+restart+aka+time+steps+%282+or+more%2C+5+is+shown%29%0A%0Amodule+load+StdEnv%2F2023+++++++%23+Do+not+change%0Amodule+load+ansys%2F2023R2++++++%23+Specify+version+%28beluga%2C+cedar%2C+graham%2C+narval%29%0A%0A%23module+load+StdEnv%2F2020++++++%23+no+longer+supported%0A%23module+load+ansys%2F2019R3+++++%23+or+newer+versions+%28narval+only%29%0A%23module+load+ansys%2F2021R2+++++%23+or+newer+versions+%28beluga%2C+cedar%2C+graham%29%0A%0AMYVERSION%3D3d++++++++++++++++++++++++%23+Specify+2d%2C+2ddp%2C+3d+or+3ddp%0AMYJOUFILE%3Dsample.jou++++++++++++++++%23+Specify+your+journal+filename%0AMYJOUFILERES%3Dsample-restart.jou+++++%23+Specify+journal+restart+filename%0AMYCASFILERES%3Dsample-restart.cas.h5++%23+Specify+cas+restart+filename%0AMYDATFILERES%3Dsample-restart.dat.h5++%23+Specify+dat+restart+filename%0A%0A%23+-------+do+not+change+any+lines+below+--------%0A%0Aif+%5B%5B+%22%24%7BCC_CLUSTER%7D%22+%3D%3D+narval+%5D%5D%3B+then%0A+if+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2020+%5D%3B+then%0A+++module+load+intel%2F2021+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%2Fmpi%2Flatest%0A+++export+HCOLL_RCACHE%3D%5Eucs%0A+elif+%5B+%22%24EBVERSIONGENTOO%22+%3D%3D+2023+%5D%3B+then%0A+++module+load+intel%2F2023+intelmpi%0A+++export+INTELMPI_ROOT%3D%24I_MPI_ROOT%0A+fi%0A+unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A+unset+I_MPI_ROOT%0Afi%0A%0Aslurm_hl2hl.py+--format+ANSYS-FLUENT+%3E+%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID%0ANCORES%3D%24%28%28SLURM_NTASKS+%2A+SLURM_CPUS_PER_TASK%29%29%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-I+%24MYFILEJOU%0A++else%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pshmem+-I+%24MYFILEJOURES%0A++fi%0Aelse+%0A++if+%5B+%22%24SLURM_ARRAY_TASK_ID%22+%3D%3D+1+%5D%3B+then%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOUFILE%0A++else%0A++++fluent+-g+%24MYVERSION+-t+%24NCORES+-affinity%3D0+-mpi%3Dintel+-pib+-cnf%3D%2Ftmp%2Fmachinefile-%24SLURM_JOB_ID+-i+%24MYJOUFILERES%0A++fi%0Afi%0Aif+%5B+%24%3F+-eq+0+%5D%3B+then%0A++++echo%0A++++echo+%22SLURM_ARRAY_TASK_ID++%3D+%24SLURM_ARRAY_TASK_ID%22%0A++++echo+%22SLURM_ARRAY_TASK_COUNT+%3D+%24SLURM_ARRAY_TASK_COUNT%22%0A++++echo%0A++++if+%5B+%24SLURM_ARRAY_TASK_ID+-lt+%24SLURM_ARRAY_TASK_COUNT+%5D%3B+then%0A++++++echo+%22Restarting+job+with+the+most+recent+output+dat+file%22%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.cas+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYCASFILERES%0A++++++ln+-sfv+output%2F%24%28ls+-ltr+output+%7C+grep+.dat+%7C+tail+-n1+%7C+awk+%27%7Bprint+%249%7D%27%29+%24MYDATFILERES%0A++++++ls+-lh+cavity%2A+output%2F%2A%0A++++else%0A++++++echo+%22Job+completed+successfully%21+Exiting+now.%22%0A++++++scancel+%24SLURM_ARRAY_JOB_ID%0A+++++fi%0Aelse%0A+++++echo+%22Simulation+failed.+Exiting+now.%22%0Afi" />
<input type="hidden" name="filename" value="script-flu-bycore+restart.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">##SBATCH --nodes=1            # Uncomment to specify (narval 1 node max)</span>
<span class="c1">#SBATCH --ntasks=16           # Specify total number of cores</span>
<span class="c1">#SBATCH --mem-per-cpu=4G      # Specify memory per core</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>
<span class="c1">#SBATCH --array=1-5%1         # Specify number of restart aka time steps (2 or more, 5 is shown)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023<span class="w">       </span><span class="c1"># Do not change</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify version (beluga, cedar, graham, narval)</span>

<span class="c1">#module load StdEnv/2020      # no longer supported</span>
<span class="c1">#module load ansys/2019R3     # or newer versions (narval only)</span>
<span class="c1">#module load ansys/2021R2     # or newer versions (beluga, cedar, graham)</span>

<span class="nv">MYVERSION</span><span class="o">=</span>3d<span class="w">                        </span><span class="c1"># Specify 2d, 2ddp, 3d or 3ddp</span>
<span class="nv">MYJOUFILE</span><span class="o">=</span>sample.jou<span class="w">                </span><span class="c1"># Specify your journal filename</span>
<span class="nv">MYJOUFILERES</span><span class="o">=</span>sample-restart.jou<span class="w">     </span><span class="c1"># Specify journal restart filename</span>
<span class="nv">MYCASFILERES</span><span class="o">=</span>sample-restart.cas.h5<span class="w">  </span><span class="c1"># Specify cas restart filename</span>
<span class="nv">MYDATFILERES</span><span class="o">=</span>sample-restart.dat.h5<span class="w">  </span><span class="c1"># Specify dat restart filename</span>

<span class="c1"># ------- do not change any lines below --------</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CC_CLUSTER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2021<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>/mpi/latest
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">HCOLL_RCACHE</span><span class="o">=</span>^ucs
<span class="w"> </span><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EBVERSIONGENTOO</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span>module<span class="w"> </span>load<span class="w"> </span>intel/2023<span class="w"> </span>intelmpi
<span class="w">   </span><span class="nb">export</span><span class="w"> </span><span class="nv">INTELMPI_ROOT</span><span class="o">=</span><span class="nv">$I_MPI_ROOT</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w"> </span><span class="nb">unset</span><span class="w"> </span>I_MPI_ROOT
<span class="k">fi</span>

slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-FLUENT<span class="w"> </span>&gt;<span class="w"> </span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span>
<span class="nv">NCORES</span><span class="o">=</span><span class="k">$((</span><span class="nv">SLURM_NTASKS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">SLURM_CPUS_PER_TASK</span><span class="k">))</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-I<span class="w"> </span><span class="nv">$MYFILEJOU</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pshmem<span class="w"> </span>-I<span class="w"> </span><span class="nv">$MYFILEJOURES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span><span class="w"> </span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILE</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>fluent<span class="w"> </span>-g<span class="w"> </span><span class="nv">$MYVERSION</span><span class="w"> </span>-t<span class="w"> </span><span class="nv">$NCORES</span><span class="w"> </span>-affinity<span class="o">=</span><span class="m">0</span><span class="w"> </span>-mpi<span class="o">=</span>intel<span class="w"> </span>-pib<span class="w"> </span>-cnf<span class="o">=</span>/tmp/machinefile-<span class="nv">$SLURM_JOB_ID</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$MYJOUFILERES</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_ID  = </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SLURM_ARRAY_TASK_COUNT = </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_COUNT</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Restarting job with the most recent output dat file&quot;</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.cas<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYCASFILERES</span>
<span class="w">      </span>ln<span class="w"> </span>-sfv<span class="w"> </span>output/<span class="k">$(</span>ls<span class="w"> </span>-ltr<span class="w"> </span>output<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>.dat<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $9}&#39;</span><span class="k">)</span><span class="w"> </span><span class="nv">$MYDATFILERES</span>
<span class="w">      </span>ls<span class="w"> </span>-lh<span class="w"> </span>cavity*<span class="w"> </span>output/*
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Job completed successfully! Exiting now.&quot;</span>
<span class="w">      </span>scancel<span class="w"> </span><span class="nv">$SLURM_ARRAY_JOB_ID</span>
<span class="w">     </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">     </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Simulation failed. Exiting now.&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h3><span class="mw-headline" id="Journal_files">Journal files</span></h3>
<p>Fluent journal files can include basically any command from Fluent's Text-User-Interface (TUI); commands can be used to change simulation parameters like temperature, pressure and flow speed. With this you can run a series of simulations under different conditions with a single case file, by only changing the parameters in the journal file. Refer to the Fluent User's Guide for more information and a list of all commands that can be used.  The following journal files are set up with <code>/file/cff-files no</code> to use the legacy .cas/.dat file format (the default in module versions 2019R3 or older).  Set this instead to <code>/file/cff-files yes</code> to use the more efficient .cas.h5/.dat.h5 file format (the default in module versions 2020R1 or newer).
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-4-0" name="tabs-4" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-4-1" name="tabs-4" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-4-1" data-tabpos="1">Journal file (steady, case)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-4-2" name="tabs-4" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-4-2" data-tabpos="2">Journal file (steady, case + data)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-4-3" name="tabs-4" class="tabs-input tabs-input-3" /><label class="tabs-label" for="tabs-input-4-3" data-tabpos="3">Journal file (transient)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample1.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+SAMPLE+FLUENT+JOURNAL+FILE+-+STEADY+SIMULATION%0A%3B+----------------------------------------------%0A%3B+lines+beginning+with+a+semicolon+are+comments%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+input+case+and+data+files%0A%2Ffile%2Fread-case-data+FFF-in%0A%0A%3B+Run+the+solver+for+this+many+iterations%0A%2Fsolve%2Fiterate+1000%0A%0A%3B+Overwrite+output+files+by+default%0A%2Ffile%2Fconfirm-overwrite+n%0A%0A%3B+Write+final+output+data+file%0A%2Ffile%2Fwrite-case-data+FFF-out%0A%0A%3B+Write+simulation+report+to+file+%28optional%29%0A%2Freport%2Fsummary+y+%22My_Simulation_Report.txt%22%0A%0A%3B+Cleanly+shutdown+fluent%0A%2Fexit" />
<input type="hidden" name="filename" value="sample1.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>SAMPLE<span class="w"> </span>FLUENT<span class="w"> </span>JOURNAL<span class="w"> </span>FILE<span class="w"> </span>-<span class="w"> </span>STEADY<span class="w"> </span>SIMULATION
<span class="p">;</span><span class="w"> </span>----------------------------------------------
<span class="p">;</span><span class="w"> </span>lines<span class="w"> </span>beginning<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>semicolon<span class="w"> </span>are<span class="w"> </span>comments

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>input<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>files
/file/read-case-data<span class="w"> </span>FFF-in

<span class="p">;</span><span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>solver<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>many<span class="w"> </span>iterations
/solve/iterate<span class="w"> </span><span class="m">1000</span>

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>output<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>n

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>final<span class="w"> </span>output<span class="w"> </span>data<span class="w"> </span>file
/file/write-case-data<span class="w"> </span>FFF-out

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>simulation<span class="w"> </span>report<span class="w"> </span>to<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span><span class="s2">&quot;My_Simulation_Report.txt&quot;</span>

<span class="p">;</span><span class="w"> </span>Cleanly<span class="w"> </span>shutdown<span class="w"> </span>fluent
/exit
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample2.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+SAMPLE+FLUENT+JOURNAL+FILE+-+STEADY+SIMULATION%0A%3B+----------------------------------------------%0A%3B+lines+beginning+with+a+semicolon+are+comments%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+input+files%0A%2Ffile%2Fread-case-data+FFF-in%0A%0A%3B+Write+a+data+file+every+100+iterations%0A%2Ffile%2Fauto-save%2Fdata-frequency+100%0A%0A%3B+Retain+data+files+from+5+most+recent+iterations%0A%2Ffile%2Fauto-save%2Fretain-most-recent-files+y%0A%0A%3B+Write+data+files+to+output+sub-directory+%28appends+iteration%29%0A%2Ffile%2Fauto-save%2Froot-name+output%2FFFF-out%0A%0A%3B+Run+the+solver+for+this+many+iterations%0A%2Fsolve%2Fiterate+1000%0A%0A%3B+Write+final+output+case+and+data+files%0A%2Ffile%2Fwrite-case-data+FFF-out%0A%0A%3B+Write+simulation+report+to+file+%28optional%29%0A%2Freport%2Fsummary+y+%22My_Simulation_Report.txt%22%0A%0A%3B+Cleanly+shutdown+fluent%0A%2Fexit" />
<input type="hidden" name="filename" value="sample2.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>SAMPLE<span class="w"> </span>FLUENT<span class="w"> </span>JOURNAL<span class="w"> </span>FILE<span class="w"> </span>-<span class="w"> </span>STEADY<span class="w"> </span>SIMULATION
<span class="p">;</span><span class="w"> </span>----------------------------------------------
<span class="p">;</span><span class="w"> </span>lines<span class="w"> </span>beginning<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>semicolon<span class="w"> </span>are<span class="w"> </span>comments

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>input<span class="w"> </span>files
/file/read-case-data<span class="w"> </span>FFF-in

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>a<span class="w"> </span>data<span class="w"> </span>file<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span>iterations
/file/auto-save/data-frequency<span class="w"> </span><span class="m">100</span>

<span class="p">;</span><span class="w"> </span>Retain<span class="w"> </span>data<span class="w"> </span>files<span class="w"> </span>from<span class="w"> </span><span class="m">5</span><span class="w"> </span>most<span class="w"> </span>recent<span class="w"> </span>iterations
/file/auto-save/retain-most-recent-files<span class="w"> </span>y

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>data<span class="w"> </span>files<span class="w"> </span>to<span class="w"> </span>output<span class="w"> </span>sub-directory<span class="w"> </span><span class="o">(</span>appends<span class="w"> </span>iteration<span class="o">)</span>
/file/auto-save/root-name<span class="w"> </span>output/FFF-out

<span class="p">;</span><span class="w"> </span>Run<span class="w"> </span>the<span class="w"> </span>solver<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>many<span class="w"> </span>iterations
/solve/iterate<span class="w"> </span><span class="m">1000</span>

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>final<span class="w"> </span>output<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>files
/file/write-case-data<span class="w"> </span>FFF-out

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>simulation<span class="w"> </span>report<span class="w"> </span>to<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span><span class="s2">&quot;My_Simulation_Report.txt&quot;</span>

<span class="p">;</span><span class="w"> </span>Cleanly<span class="w"> </span>shutdown<span class="w"> </span>fluent
/exit
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-3">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> sample3.jou</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%3B+SAMPLE+FLUENT+JOURNAL+FILE+-+TRANSIENT+SIMULATION%0A%3B+-------------------------------------------------%0A%3B+lines+beginning+with+a+semicolon+are+comments%0A%0A%3B+Overwrite+files+by+default%0A%2Ffile%2Fconfirm-overwrite+no%0A%0A%3B+Preferentially+read%2Fwrite+files+in+legacy+format%0A%2Ffile%2Fcff-files+no%0A%0A%3B+Read+the+input+case+file%0A%2Ffile%2Fread-case+FFF-transient-inp%0A%0A%3B+For+continuation+%28restart%29+read+in+both+case+and+data+input+files%0A%3B%2Ffile%2Fread-case-data+FFF-transient-inp%0A%0A%3B+Write+a+data+%28and+maybe+case%29+file+every+100+time+steps%0A%2Ffile%2Fauto-save%2Fdata-frequency+100%0A%2Ffile%2Fauto-save%2Fcase-frequency+if-case-is-modified%0A%0A%3B+Retain+only+the+most+recent+5+data+%28and+maybe+case%29+files%0A%2Ffile%2Fauto-save%2Fretain-most-recent-files+y%0A%0A%3B+Write+to+output+sub-directory+%28appends+flowtime+and+timestep%29%0A%2Ffile%2Fauto-save%2Froot-name+output%2FFFF-transient-out-%2510.6f%0A%0A%3B+%23%23%23%23%23+Settings+for+Transient+simulation+%3A++%23%23%23%23%23%0A%0A%3B+Set+the+physical+time+step+size%0A%2Fsolve%2Fset%2Ftime-step+0.0001%0A%0A%3B+Set+the+number+of+iterations+for+which+convergence+monitors+are+reported%0A%2Fsolve%2Fset%2Freporting-interval+1%0A%0A%3B+%23%23%23%23%23+End+of+settings+for+Transient+simulation+%23%23%23%23%23%0A%0A%3B+Initialize+using+the+hybrid+initialization+method%0A%2Fsolve%2Finitialize%2Fhyb-initialization%0A%0A%3B+Set+max+number+of+iters+per+time+step+and+number+of+time+steps%0A%3B%2Fsolve%2Fset%2Fmax-iterations-per-time-step+75%0A%3B%2Fsolve%2Fdual-time-iterate+1000+%2C%0A%2Fsolve%2Fdual-time-iterate+1000+75%0A%0A%3B+Write+final+case+and+data+output+files%0A%2Ffile%2Fwrite-case-data+FFF-transient-out%0A%0A%3B+Write+simulation+report+to+file+%28optional%29%0A%2Freport%2Fsummary+y+Report_Transient_Simulation.txt%0A%0A%3B+Cleanly+shutdown+fluent%0A%2Fexit" />
<input type="hidden" name="filename" value="sample3.jou" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="p">;</span><span class="w"> </span>SAMPLE<span class="w"> </span>FLUENT<span class="w"> </span>JOURNAL<span class="w"> </span>FILE<span class="w"> </span>-<span class="w"> </span>TRANSIENT<span class="w"> </span>SIMULATION
<span class="p">;</span><span class="w"> </span>-------------------------------------------------
<span class="p">;</span><span class="w"> </span>lines<span class="w"> </span>beginning<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>semicolon<span class="w"> </span>are<span class="w"> </span>comments

<span class="p">;</span><span class="w"> </span>Overwrite<span class="w"> </span>files<span class="w"> </span>by<span class="w"> </span>default
/file/confirm-overwrite<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Preferentially<span class="w"> </span>read/write<span class="w"> </span>files<span class="w"> </span><span class="k">in</span><span class="w"> </span>legacy<span class="w"> </span>format
/file/cff-files<span class="w"> </span>no

<span class="p">;</span><span class="w"> </span>Read<span class="w"> </span>the<span class="w"> </span>input<span class="w"> </span><span class="k">case</span><span class="w"> </span>file
/file/read-case<span class="w"> </span>FFF-transient-inp

<span class="p">;</span><span class="w"> </span>For<span class="w"> </span>continuation<span class="w"> </span><span class="o">(</span>restart<span class="o">)</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>both<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>input<span class="w"> </span>files
<span class="p">;</span>/file/read-case-data<span class="w"> </span>FFF-transient-inp

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>a<span class="w"> </span>data<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>maybe<span class="w"> </span><span class="k">case</span><span class="o">)</span><span class="w"> </span>file<span class="w"> </span>every<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="nb">time</span><span class="w"> </span>steps
/file/auto-save/data-frequency<span class="w"> </span><span class="m">100</span>
/file/auto-save/case-frequency<span class="w"> </span><span class="k">if</span>-case-is-modified

<span class="p">;</span><span class="w"> </span>Retain<span class="w"> </span>only<span class="w"> </span>the<span class="w"> </span>most<span class="w"> </span>recent<span class="w"> </span><span class="m">5</span><span class="w"> </span>data<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>maybe<span class="w"> </span><span class="k">case</span><span class="o">)</span><span class="w"> </span>files
/file/auto-save/retain-most-recent-files<span class="w"> </span>y

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>to<span class="w"> </span>output<span class="w"> </span>sub-directory<span class="w"> </span><span class="o">(</span>appends<span class="w"> </span>flowtime<span class="w"> </span>and<span class="w"> </span>timestep<span class="o">)</span>
/file/auto-save/root-name<span class="w"> </span>output/FFF-transient-out-%10.6f

<span class="p">;</span><span class="w"> </span><span class="c1">##### Settings for Transient simulation&#160;:  #####</span>

<span class="p">;</span><span class="w"> </span>Set<span class="w"> </span>the<span class="w"> </span>physical<span class="w"> </span><span class="nb">time</span><span class="w"> </span>step<span class="w"> </span>size
/solve/set/time-step<span class="w"> </span><span class="m">0</span>.0001

<span class="p">;</span><span class="w"> </span>Set<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>iterations<span class="w"> </span><span class="k">for</span><span class="w"> </span>which<span class="w"> </span>convergence<span class="w"> </span>monitors<span class="w"> </span>are<span class="w"> </span>reported
/solve/set/reporting-interval<span class="w"> </span><span class="m">1</span>

<span class="p">;</span><span class="w"> </span><span class="c1">##### End of settings for Transient simulation #####</span>

<span class="p">;</span><span class="w"> </span>Initialize<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>hybrid<span class="w"> </span>initialization<span class="w"> </span>method
/solve/initialize/hyb-initialization

<span class="p">;</span><span class="w"> </span>Set<span class="w"> </span>max<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>iters<span class="w"> </span>per<span class="w"> </span><span class="nb">time</span><span class="w"> </span>step<span class="w"> </span>and<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span><span class="nb">time</span><span class="w"> </span>steps
<span class="p">;</span>/solve/set/max-iterations-per-time-step<span class="w"> </span><span class="m">75</span>
<span class="p">;</span>/solve/dual-time-iterate<span class="w"> </span><span class="m">1000</span><span class="w"> </span>,
/solve/dual-time-iterate<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">75</span>

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>final<span class="w"> </span><span class="k">case</span><span class="w"> </span>and<span class="w"> </span>data<span class="w"> </span>output<span class="w"> </span>files
/file/write-case-data<span class="w"> </span>FFF-transient-out

<span class="p">;</span><span class="w"> </span>Write<span class="w"> </span>simulation<span class="w"> </span>report<span class="w"> </span>to<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
/report/summary<span class="w"> </span>y<span class="w"> </span>Report_Transient_Simulation.txt

<span class="p">;</span><span class="w"> </span>Cleanly<span class="w"> </span>shutdown<span class="w"> </span>fluent
/exit
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h3><span class="mw-headline" id="UDFs">UDFs</span></h3>
<p>The first step is to transfer your User-Defined Function or UDF (namely the sampleudf.c source file and any additional dependency files) to the cluster.  When uploading from a windows machine, be sure the text mode setting of your transfer client is used otherwise fluent won't be able to read the file properly on the cluster since it runs linux.  The UDF should be placed in the directory where your journal, cas and dat files reside.  Next add one of the following commands into your journal file before the commands that read in your simulation cas/dat files.   Regardless of whether you use the Interpreted or Compiled UDF approach,  before uploading your cas file onto the Alliance please check that neither the Interpreted UDFs Dialog Box or the UDF Library Manager Dialog Box are configured to use any UDF; this will ensure that only the journal file commands are in control when jobs are submitted.
</p>
<h4><span class="mw-headline" id="Interpreted">Interpreted</span></h4>
<p>To tell fluent to interpret your UDF at runtime, add the following command line into your journal file before the cas/dat files are read or initialized. The filename sampleudf.c should be replaced with the name of your source file.  The command remains the same regardless if the simulation is being run in serial or parallel.  To ensure the UDF can be found in the same directory as the journal file, open your cas file in the fluent gui, remove any managed definitions and resave it.   Doing this will ensure only the following command/method is in control when fluent runs. To use an interpreted UDF with parallel jobs, it will need to be parallelized as described in the section below.
</p>
<pre>define/user-defined/interpreted-functions "sampleudf.c" "cpp" 10000 no
</pre>
<h4><span class="mw-headline" id="Compiled">Compiled</span></h4>
<p>To use this approach, your UDF must be compiled on an Alliance cluster at least once.  Doing so will create a libudf subdirectory structure containing the required <code>libudf.so</code> shared library.   The libudf directory cannot simply be copied from a remote system (such as your laptop) to the Alliance since the library dependencies of the shared library will not be satisfied, resulting in fluent crashing on startup.  That said, once you have compiled your UDF on an Alliance cluster, you can transfer the newly created libudf to any other Alliance cluster, providing your account loads the same StdEnv environment module version.  Once copied, the UDF can be used by uncommenting the second (load) libudf line below in your journal file when submitting jobs to the cluster.  Both (compile and load) libudf lines should not be left uncommented in your journal file when submitting jobs on the cluster, otherwise your UDF will automatically (re)compiled for each and every job.  Not only is this highly inefficient, but it will also lead to racetime-like build conflicts if multiple jobs are run from the same directory. Besides configuring your journal file to build your UDF, the fluent gui (run on any cluster compute node or gra-vdi) may also be used.  To do this, you would navigate to the Compiled UDFs Dialog Box, add the UDF source file and click Build.   When using a compiled UDF with parallel jobs, your source file should be parallelized as discussed in the section below.
</p>
<pre>define/user-defined/compiled-functions compile libudf yes sampleudf.c "" ""
</pre>
<p>and/or
</p>
<pre>define/user-defined/compiled-functions load libudf
</pre>
<h4><span class="mw-headline" id="Parallel">Parallel</span></h4>
<p>Before a UDF can be used with a fluent parallel job (single node SMP and multinode MPI) it will need to be parallelized.  By doing this we control how/which processes (host and/or compute) run specific parts of the UDF code when fluent is run in parallel on the cluster. The instrumenting procedure involves adding compiler directives, predicates and reduction macros into your working serial UDF. Failure to do so will result in fluent running slow at best or immediately crashing at worst.  The end result will be a single UDF that runs efficiently when fluent is used in both serial and parallel mode.  The subject is described in detail under <i>Part I: Chapter 7: Parallel Considerations</i> of the Ansys 2024 <i>Fluent Customization Manual</i> which can be accessed <a class="mw-selflink-fragment" href="#Online_Documentation">here</a>.
</p>
<h4><span class="mw-headline" id="DPM">DPM</span></h4>
<p>UDFs can be used to customize Discrete Phase Models (DPM) as described in <i>Part III: Solution Mode | Chapter 24: Modeling Discrete Phase | 24.2 Steps for Using the Discrete Phase Models| 24.2.6 User-Defined Functions</i> of the <i>2024R2 Fluent Users Guide</i> and section <i>Part I: Creating and Using User Defined Functions | Chapter 2: DEFINE Macros | 2.5 Discrete Phase Model (DPM) DEFINE Macros</i> of the <i>2024R2 Fluent Customization Manual</i>. Before a DMP based UDF can be worked into a simulation, the injection of a set of particles must be defined by specifying "Point Properties" with variables such as source position, initial trajectory, mass flow rate, time duration, temperature and so forth depending on the injection type.  This can be done in the gui by clicking the Physics panel, Discrete Phase to open the <i>Discrete Phase Model</i> box and then clicking the <i>Injections</i> button.  Doing so will open an <i>Injections</i> dialog box where one or more injections can be created by clicking the <i>Create</i> button.   The "Set Injection Properties" dialog which appears will contain an "Injection Type" pulldown with first four types available are "single, group, surface, flat-fan-atomizer". If you select any of these then you can then the "Point Properties" tab can be selected to input the corresponding Value fields.  Another way to specify the "Point Properties" would be to read an injection text file.  To do this select "file" from the Injection Type pulldown, specify the Injection Name to be created and then click the <i>File</i> button (located beside the <i>OK</i> button at the bottom of the  "Set Injection Properties" dialog).   Here either an Injection Sample File (with .dpm extension) or a manually created injection text file can be selected.   To Select the File in the Select File dialog box that change the File of type pull down to All Files (*), then highlight the file which could have any arbitrary name but commonly does have a .inj extension, click the OK button.   Assuming there are no problems with the file, no Console error or warning message will appear in fluent.   As you will be returned to the "Injections" dialog box, you should see the same Injection name that you specified in the "Set Injection Properties" dialog and be able to List its Particles and Properties in the console.  Next open the Discrete Phase Model Dialog Box and select Interaction with Continuous Phase which will enable updating DPM source terms every flow iteration.  This setting can be saved in your cas file or added via the journal file as shown.  Once the injection is confirmed working in the gui the steps can be automated by adding commands to the journal file after solution initialization, for example:
</p>
<pre>/define/models/dpm/interaction/coupled-calculations yes
/define/models/dpm/injections/delete-injection injection-0:1
/define/models/dpm/injections/create injection-0:1 no yes file no zinjection01.inj no no no no
/define/models/dpm/injections/list-particles injection-0:1
/define/models/dpm/injections/list-injection-properties injection-0:1
</pre>
<p>where a basic manually created injection steady file format might look like:
</p>
<pre> $ cat  zinjection01.inj
 (z=4 12)
 ( x          y        z    u         v    w    diameter  t         mass-flow  mass  frequency  time name )
 (( 2.90e-02  5.00e-03 0.0 -1.00e-03  0.0  0.0  1.00e-04  2.93e+02  1.00e-06   0.0   0.0        0.0 ) injection-0:1 )
</pre>
<p>noting that injection files for DPM simulations are generally setup for either steady or unsteady particle tracking where the format of the former is described in subsection <i>Part III: Solution Mode | Chapter 24: Modeling Discrete Phase | 24.3. Setting Initial Conditions for the Discrete Phase | 24.3.13 Point Properties for File Injections | 24.3.13.1 Steady File Format</i> of the <i>2024R2 Fluent Customization Manual</i>.
</p>
<h2><span class="mw-headline" id="Ansys_CFX">Ansys CFX</span></h2>
<h3><span class="mw-headline" id="Slurm_scripts_2">Slurm scripts</span></h3>
<p>A summary of command-line options can be printed by running <b>cfx5solve -help</b> where the same module version thats loaded in your slurm script should be first manually loaded.  By default cfx5solve will run in single precision (-single).  To run cfx5solve in double precision add the <code>-double</code> option noting that doing so will also double memory requirements.  By default cfx5solve can support meshes with up to 80 million elements (structured) or 200 million elements (unstructured).  For larger meshes with up to 2 billion elements, add the <code>-large</code> option.  Various combinations of these options can be specified for the Partitioner, Interpolator or Solver.  Consult the ANSYS CFX-Solver Manager User's Guide for further details.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-5-0" name="tabs-5" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-5-1" name="tabs-5" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-5-1" data-tabpos="1">Single node</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-5-2" name="tabs-5" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-5-2" data-tabpos="2">Multinode</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-cfx-local.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D1+++++++++++++%23+Specify+single+compute+node+%28do+not+change%29%0A%23SBATCH+--ntasks-per-node%3D4+++%23+Specify+number+cores+%28maximum%3A+graham+44%2C+cedar+32+or+48%2C+beluga+40%2C+narval+64%29%0A%23SBATCH+--mem%3D16G+++++++++++++%23+Specify+node+memory+%28optionally+set+to+0+to+allocate+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0A%23module+load+StdEnv%2F2020++++++%23+Uncomment+to+use+%28deprecated%29+++++%0A%23module+load+2021R2+++++++++++%23+Specify+2021R2+only%0A%0Amodule+load+StdEnv%2F2023%0Amodule+load+ansys%2F2023R2++++++%23+Specify+2022R2+or+newer+module+versions%0A%0A%23+append+additional+cfx5solve+command+line+options+as+required%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+narval+%5D%5D%3B+then%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Open+MPI+Local+Parallel%22+-part+%24SLURM_CPUS_ON_NODE%0Aelse%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Intel+MPI+Local+Parallel%22+-part+%24SLURM_CPUS_ON_NODE%0Afi" />
<input type="hidden" name="filename" value="script-cfx-local.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=1             # Specify single compute node (do not change)</span>
<span class="c1">#SBATCH --ntasks-per-node=4   # Specify number cores (maximum: graham 44, cedar 32 or 48, beluga 40, narval 64)</span>
<span class="c1">#SBATCH --mem=16G             # Specify node memory (optionally set to 0 to allocate all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

<span class="c1">#module load StdEnv/2020      # Uncomment to use (deprecated)     </span>
<span class="c1">#module load 2021R2           # Specify 2021R2 only</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify 2022R2 or newer module versions</span>

<span class="c1"># append additional cfx5solve command line options as required</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Open MPI Local Parallel&quot;</span><span class="w"> </span>-part<span class="w"> </span><span class="nv">$SLURM_CPUS_ON_NODE</span>
<span class="k">else</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Intel MPI Local Parallel&quot;</span><span class="w"> </span>-part<span class="w"> </span><span class="nv">$SLURM_CPUS_ON_NODE</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-cfx-multiple.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-group+++%23+Specify+account+name%0A%23SBATCH+--time%3D00-03%3A00+++++++%23+Specify+time+limit+dd-hh%3Amm%0A%23SBATCH+--nodes%3D2+++++++++++++%23+Specify+multiple+compute+nodes+%282+or+more%29%0A%23SBATCH+--ntasks-per-node%3D64++%23+Specify+all+cores+per+node+%28maximum%3A+graham+44%2C+48%2C+beluga+40%2C+narval+64%29%0A%23SBATCH+--mem%3D0+++++++++++++++%23+Use+all+memory+per+compute+node+%28do+not+change%29%0A%23SBATCH+--cpus-per-task%3D1+++++%23+Do+not+change%0A%0A%23module+load+StdEnv%2F2020++++++%23+Uncomment+to+use+%28deprecated%29+++++%0A%23module+load+2021R2+++++++++++%23+Specify+2021R2+only%0A%0Amodule+load+StdEnv%2F2023%0Amodule+load+ansys%2F2023R2++++++%23+Specify+2022R2+or+newer+module+versions%0A%0ANNODES%3D%24%28slurm_hl2hl.py+--format+ANSYS-CFX%29%0A%0A%23+append+additional+cfx5solve+command+line+options+as+required%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+narval+%5D%5D%3B+then%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Open+MPI+Distributed+Parallel%22+-par-dist+%24NNODES%0Aelse%0A++export+I_MPI_HYDRA_BOOTSTRAP%3Dssh%0A++unset+I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS%0A++cfx5solve+-def+YOURFILE.def+-start-method+%22Intel+MPI+Distributed+Parallel%22+-par-dist+%24NNODES%0Afi" />
<input type="hidden" name="filename" value="script-cfx-multiple.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-group   # Specify account name</span>
<span class="c1">#SBATCH --time=00-03:00       # Specify time limit dd-hh:mm</span>
<span class="c1">#SBATCH --nodes=2             # Specify multiple compute nodes (2 or more)</span>
<span class="c1">#SBATCH --ntasks-per-node=64  # Specify all cores per node (maximum: graham 44, 48, beluga 40, narval 64)</span>
<span class="c1">#SBATCH --mem=0               # Use all memory per compute node (do not change)</span>
<span class="c1">#SBATCH --cpus-per-task=1     # Do not change</span>

<span class="c1">#module load StdEnv/2020      # Uncomment to use (deprecated)     </span>
<span class="c1">#module load 2021R2           # Specify 2021R2 only</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
module<span class="w"> </span>load<span class="w"> </span>ansys/2023R2<span class="w">      </span><span class="c1"># Specify 2022R2 or newer module versions</span>

<span class="nv">NNODES</span><span class="o">=</span><span class="k">$(</span>slurm_hl2hl.py<span class="w"> </span>--format<span class="w"> </span>ANSYS-CFX<span class="k">)</span>

<span class="c1"># append additional cfx5solve command line options as required</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>narval<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Open MPI Distributed Parallel&quot;</span><span class="w"> </span>-par-dist<span class="w"> </span><span class="nv">$NNODES</span>
<span class="k">else</span>
<span class="w">  </span><span class="nb">export</span><span class="w"> </span><span class="nv">I_MPI_HYDRA_BOOTSTRAP</span><span class="o">=</span>ssh
<span class="w">  </span><span class="nb">unset</span><span class="w"> </span>I_MPI_HYDRA_BOOTSTRAP_EXEC_EXTRA_ARGS
<span class="w">  </span>cfx5solve<span class="w"> </span>-def<span class="w"> </span>YOURFILE.def<span class="w"> </span>-start-method<span class="w"> </span><span class="s2">&quot;Intel MPI Distributed Parallel&quot;</span><span class="w"> </span>-par-dist<span class="w"> </span><span class="nv">$NNODES</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
</div></div>
<h2><span class="mw-headline" id="Workbench">Workbench</span></h2>
<p>Before submitting a project file to the queue on a cluster (for the first time) follow these steps to initialize it.<br />
</p>
<ol><li>Connect to the cluster with <a href="/wiki/VNC#Compute_nodes" title="VNC">TigerVNC</a>.</li>
<li>Switch to the directory where the project file is located (YOURPROJECT.wbpj) and <a class="mw-selflink-fragment" href="#Workbench_3">start Workbench</a> with the same Ansys module you used to create your project.</li>
<li>In Workbench, open the project with <i>File -&gt; Open</i>.</li>
<li>In the main window, right-click on <i>Setup</i> and select <i>Clear All Generated Data</i>.</li>
<li>In the top menu bar pulldown, select <i>File -&gt; Exit</i> to exit Workbench.</li>
<li>In the Ansys Workbench popup, when asked <i>The current project has been modified. Do you want to save it?</i>, click on the <i>No</i> button.</li>
<li>Quit Workbench and submit your job using one of the Slurm scripts shown below.</li></ol>
<p>To avoid writing the solution when a running job successfully completes \remove <code>;Save(Overwrite=True)</code> from the last line of your script.  Doing this will make it easier to run multiple test jobs (for scaling purposes when changing ntasks), since the initialized solution will not be overwritten each time.  Alternatively, keep a copy of the initialized YOURPROJECT.wbpj file and YOURPROJECT_files subdirectory and restore them after the solution is written.
</p>
<h3><span class="mw-headline" id="Slurm_scripts_3">Slurm scripts</span></h3>
<p>A project file can be submitted to the queue by customizing one of the following scripts and then running the <code>sbatch script-wbpj.sh</code> command:
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-6-0" name="tabs-6" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-6-1" name="tabs-6" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-6-1" data-tabpos="1">Single node (StdEnv/2020)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-wbpj-2020.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Ddef-account%0A%23SBATCH+--time%3D00-03%3A00++++++++++++++++%23+Time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++++++++++%23+Total+Memory+%28set+to+0+for+all+node+memory%29%0A%23SBATCH+--ntasks%3D4+++++++++++++++++++++%23+Number+of+cores%0A%23SBATCH+--nodes%3D1++++++++++++++++++++++%23+Do+not+change+%28multi-node+not+supported%29%0A%23%23SBATCH+--exclusive+++++++++++++++++++%23+Uncomment+for+scaling+testing%0A%23%23SBATCH+--constraint%3Dbroadwell++++++++%23+Applicable+to+graham+or+cedar%0A%0Amodule+load+StdEnv%2F2020+ansys%2F2021R2+++%23+OR+newer+Ansys+modules%0A%0Aif+%5B+%22%24SLURM_NNODES%22+%3D%3D+1+%5D%3B+then%0A++MEMPAR%3D0+++++++++++++++++++++++++++++++%23+Set+to+0+for+SMP+%28shared+memory+parallel%29%0Aelse%0A++MEMPAR%3D1+++++++++++++++++++++++++++++++%23+Set+to+1+for+DMP+%28distributed+memory+parallel%29%0Afi%0A%0Arm+-fv+%2A_files%2F.lock%0AMWFILE%3D%7E%2F.mw%2FApplication%5C+Data%2FAnsys%2F%60basename+%24%28find+%24EBROOTANSYS%2Fv%2A+-maxdepth+0+-type+d%29%60%2FSolveHandlers.xml%0Ased+-re+%22s%2F%28.AnsysSolution%3E%2B%29%5Ba-zA-Z0-9%5D%2A%28%3C%5C%2FDistribute.%29%2F%5C1%24MEMPAR%5C2%2F%22+-i+%22%24MWFILE%22%0Ased+-re+%22s%2F%28.Processors%3E%2B%29%5Ba-zA-Z0-9%5D%2A%28%3C%5C%2FMaxNumber.%29%2F%5C1%24SLURM_NTASKS%5C2%2F%22+-i+%22%24MWFILE%22%0Ased+-i+%22s%21UserConfigured%3D%5C%220%5C%22%21UserConfigured%3D%5C%221%5C%22%21g%22+%22%24MWFILE%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aexport+I_MPI_HYDRA_BOOTSTRAP%3Dssh%0A%0Arunwb2+-B+-E+%22Update%28%29%3BSave%28Overwrite%3DTrue%29%22+-F+YOURPROJECT.wbpj" />
<input type="hidden" name="filename" value="script-wbpj-2020.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=def-account</span>
<span class="c1">#SBATCH --time=00-03:00                # Time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G                      # Total Memory (set to 0 for all node memory)</span>
<span class="c1">#SBATCH --ntasks=4                     # Number of cores</span>
<span class="c1">#SBATCH --nodes=1                      # Do not change (multi-node not supported)</span>
<span class="c1">##SBATCH --exclusive                   # Uncomment for scaling testing</span>
<span class="c1">##SBATCH --constraint=broadwell        # Applicable to graham or cedar</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020<span class="w"> </span>ansys/2021R2<span class="w">   </span><span class="c1"># OR newer Ansys modules</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SLURM_NNODES</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nv">MEMPAR</span><span class="o">=</span><span class="m">0</span><span class="w">                               </span><span class="c1"># Set to 0 for SMP (shared memory parallel)</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">MEMPAR</span><span class="o">=</span><span class="m">1</span><span class="w">                               </span><span class="c1"># Set to 1 for DMP (distributed memory parallel)</span>
<span class="k">fi</span>

rm<span class="w"> </span>-fv<span class="w"> </span>*_files/.lock
<span class="nv">MWFILE</span><span class="o">=</span>~/.mw/Application<span class="se">\ </span>Data/Ansys/<span class="sb">`</span>basename<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span><span class="nv">$EBROOTANSYS</span>/v*<span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">0</span><span class="w"> </span>-type<span class="w"> </span>d<span class="k">)</span><span class="sb">`</span>/SolveHandlers.xml
sed<span class="w"> </span>-re<span class="w"> </span><span class="s2">&quot;s/(.AnsysSolution&gt;+)[a-zA-Z0-9]*(&lt;\/Distribute.)/\1</span><span class="nv">$MEMPAR</span><span class="s2">\2/&quot;</span><span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>
sed<span class="w"> </span>-re<span class="w"> </span><span class="s2">&quot;s/(.Processors&gt;+)[a-zA-Z0-9]*(&lt;\/MaxNumber.)/\1</span><span class="nv">$SLURM_NTASKS</span><span class="s2">\2/&quot;</span><span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>
sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s!UserConfigured=\&quot;0\&quot;!UserConfigured=\&quot;1\&quot;!g&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$MWFILE</span><span class="s2">&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
<span class="nb">export</span><span class="w"> </span><span class="nv">I_MPI_HYDRA_BOOTSTRAP</span><span class="o">=</span>ssh

runwb2<span class="w"> </span>-B<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;Update();Save(Overwrite=True)&quot;</span><span class="w"> </span>-F<span class="w"> </span>YOURPROJECT.wbpj
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h2><span class="mw-headline" id="Mechanical">Mechanical</span></h2>
<p>The input file can be generated from within your interactive Workbench Mechanical session by clicking <i>Solution -&gt; Tools -&gt; Write Input Files</i> then specify <code>File name:</code> YOURAPDLFILE.inp and <code>Save as type:</code> APDL Input Files (*.inp).  APDL jobs can then be submitted to the queue by running the <code>sbatch script-name.sh</code> command.
</p>
<h3><span class="mw-headline" id="Slurm_scripts_4">Slurm scripts</span></h3>
<p>The following slurm scripts have been tested on graham, narval, cedar and beluga.  Lines beginning with <code>##SBATCH</code> are commented.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-7-0" name="tabs-7" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-7-1" name="tabs-7" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-7-1" data-tabpos="1">Shared Memory Parallel (cpu)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-7-2" name="tabs-7" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-7-2" data-tabpos="2">Distributed Memory Parallel (cpu)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-7-3" name="tabs-7" class="tabs-input tabs-input-3" /><label class="tabs-label" for="tabs-input-7-3" data-tabpos="3">Shared Memory Parallel (gpu)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-7-4" name="tabs-7" class="tabs-input tabs-input-4" /><label class="tabs-label" for="tabs-input-7-4" data-tabpos="4">Distributed Memory Parallel (gpu)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-smp-2023-cpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account+++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00+++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D32G+++++++++++++++%23+Specify+memory+for+all+cores%0A%23SBATCH+--nodes%3D1+++++++++++++++%23+Do+not+change%0A%23SBATCH+--tasks%3D8+++++++++++++++%23+Specify+number+of+cores%0A%23SBATCH+--cpus-per-task%3D1+++++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023%0A%23module+load+ansys%2F2023R2%0Amodule+load+ansys%2F2024R1.03%0A%0Amkdir+outdir-%24SLURM_JOBID%0A%5B%5B+%22%24CC_CLUSTER%22+%3D+cedar+%5D%5D+%26%26+export+LD_LIBRARY_PATH%3D%24EBROOTGCC%2F..%2Flib%2Fgcc%0A%0Amapdl+-smp+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID+-i+YOURAPDLFILE.inp" />
<input type="hidden" name="filename" value="script-smp-2023-cpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account   # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00         # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=32G               # Specify memory for all cores</span>
<span class="c1">#SBATCH --nodes=1               # Do not change</span>
<span class="c1">#SBATCH --tasks=8               # Specify number of cores</span>
<span class="c1">#SBATCH --cpus-per-task=1       # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
<span class="c1">#module load ansys/2023R2</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2024R1.03

mkdir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span>
<span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cedar<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$EBROOTGCC</span>/../lib/gcc

mapdl<span class="w"> </span>-smp<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w"> </span>-i<span class="w"> </span>YOURAPDLFILE.inp
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-dmp-2023-cpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account+++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00+++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem-per-cpu%3D4G++++++++%23+Specify+memory+per+core%0A%23%23SBATCH+--nodes%3D2++++++++++++++%23+Specify+number+of+nodes+%28optional%29%0A%23SBATCH+--ntasks%3D8++++++++++++++%23+Specify+number+of+cores%0A%23%23SBATCH+--ntasks-per-node%3D4++++%23+Specify+cores+per+node+%28optional%29%0A%23SBATCH+--cpus-per-task%3D1+++++++%23+Do+not+change%0A%0Amodule+load+StdEnv%2F2023%0A%23module+load+ansys%2F2023R2%0Amodule+load+ansys%2F2024R1.03%0A%0Amkdir+outdir-%24SLURM_JOBID%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+cedar+%5D%5D%3B+then%0A+ln+-s+%24EBROOTGCC%2F..%2Flib%2Fgcc%2Flibstdc%2B%2B.so.6.0.29+%24PWD%2Foutdir-%24SLURM_JOBID%2Flibstdc%2B%2B.so.6.0.29%0A+export+LD_LIBRARY_PATH%3D%24PWD%2Foutdir-%24SLURM_JOBID%0Afi%0A%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+beluga++%5D%5D%3B+then%0A++export+KMP_AFFINITY%3Dnone%0A++mapdl+-dis+-mpi+intelmpi+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID+-i+YOURAPDLFILE.inp%0Aelse%0A++mapdl+-dis+-mpi+openmpi+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID+-i+YOURAPDLFILE.inp%0Afi" />
<input type="hidden" name="filename" value="script-dmp-2023-cpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account   # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00         # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem-per-cpu=4G        # Specify memory per core</span>
<span class="c1">##SBATCH --nodes=2              # Specify number of nodes (optional)</span>
<span class="c1">#SBATCH --ntasks=8              # Specify number of cores</span>
<span class="c1">##SBATCH --ntasks-per-node=4    # Specify cores per node (optional)</span>
<span class="c1">#SBATCH --cpus-per-task=1       # Do not change</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
<span class="c1">#module load ansys/2023R2</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2024R1.03

mkdir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cedar<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$EBROOTGCC</span>/../lib/gcc/libstdc++.so.6.0.29<span class="w"> </span><span class="nv">$PWD</span>/outdir-<span class="nv">$SLURM_JOBID</span>/libstdc++.so.6.0.29
<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$PWD</span>/outdir-<span class="nv">$SLURM_JOBID</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>beluga<span class="w">  </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>none
<span class="w">  </span>mapdl<span class="w"> </span>-dis<span class="w"> </span>-mpi<span class="w"> </span>intelmpi<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w"> </span>-i<span class="w"> </span>YOURAPDLFILE.inp
<span class="k">else</span>
<span class="w">  </span>mapdl<span class="w"> </span>-dis<span class="w"> </span>-mpi<span class="w"> </span>openmpi<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w"> </span>-i<span class="w"> </span>YOURAPDLFILE.inp
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-3">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-smp-2023-gpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account++++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00++++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D32G++++++++++++++++%23+Specify+memory+for+all+cores%0A%23SBATCH+--ntasks%3D8+++++++++++++++%23+Specify+number+of+cores%0A%23SBATCH+--nodes%3D1++++++++++++++++%23+Do+not+change%0A%23SBATCH+--cpus-per-task%3D1++++++++%23+Do+not+change%0A%23SBATCH+--gpus-per-node%3D1++++++++%23+Specify+%5Bgputype%3A%5Dquantity%0A%23%23SBATCH+--gpus-per-node%3Dh100%3A1++%23+Temporarily+required+on+mini-graham%0A%23%23SBATCH+--partition%3Ddebug+++++++%23+Temporarily+required+on+mini-graham%0A%0Amodule+load+StdEnv%2F2023%0A%23module+load+ansys%2F2023R2%0Amodule+load+ansys%2F2024R1.03%0A%0Amkdir+outdir-%24SLURM_JOBID%0A%5B%5B+%22%24CC_CLUSTER%22+%3D+cedar+%5D%5D+%26%26+export+LD_LIBRARY_PATH%3D%24EBROOTGCC%2F..%2Flib%2Fgcc%0A%0Aexport+ANSGPU_PRINTDEVICES%3D1%0Amapdl+-smp+-acc+nvidia+-na+%24SLURM_GPUS_ON_NODE+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID++-i+YOURAPDLFILE.inp" />
<input type="hidden" name="filename" value="script-smp-2023-gpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account    # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00          # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=32G                # Specify memory for all cores</span>
<span class="c1">#SBATCH --ntasks=8               # Specify number of cores</span>
<span class="c1">#SBATCH --nodes=1                # Do not change</span>
<span class="c1">#SBATCH --cpus-per-task=1        # Do not change</span>
<span class="c1">#SBATCH --gpus-per-node=1        # Specify [gputype:]quantity</span>
<span class="c1">##SBATCH --gpus-per-node=h100:1  # Temporarily required on mini-graham</span>
<span class="c1">##SBATCH --partition=debug       # Temporarily required on mini-graham</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
<span class="c1">#module load ansys/2023R2</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2024R1.03

mkdir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span>
<span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cedar<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$EBROOTGCC</span>/../lib/gcc

<span class="nb">export</span><span class="w"> </span><span class="nv">ANSGPU_PRINTDEVICES</span><span class="o">=</span><span class="m">1</span>
mapdl<span class="w"> </span>-smp<span class="w"> </span>-acc<span class="w"> </span>nvidia<span class="w"> </span>-na<span class="w"> </span><span class="nv">$SLURM_GPUS_ON_NODE</span><span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w">  </span>-i<span class="w"> </span>YOURAPDLFILE.inp
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-4">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-dmp-2023-gpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%23SBATCH+--account%3Ddef-account++++%23+Specify+your+account%0A%23SBATCH+--time%3D00-03%3A00++++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem-per-cpu%3D4G+++++++++%23+Specify+memory+per+core%0A%23SBATCH+--nodes%3D1++++++++++++++++%23+Specify+number+of+nodes%0A%23SBATCH+--ntasks-per-node%3D8++++++%23+Specify+cores+per+node%0A%23SBATCH+--cpus-per-task%3D1++++++++%23+Do+not+change%0A%23SBATCH+--gpus-per-node%3D1++++++++%23+Specify+%5Bgputype%3A%5Dquantity%0A%23%23SBATCH+--gpus-per-node%3Dh100%3A1++%23+Temporarily+required+on+mini-graham%0A%23%23SBATCH+--partition%3Ddebug+++++++%23+Temporarily+required+on+mini-graham%0A%0Amodule+load+StdEnv%2F2023%0A%23module+load+ansys%2F2023R2%0Amodule+load+ansys%2F2024R1.03%0A%0Amkdir+outdir-%24SLURM_JOBID%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+cedar+%5D%5D%3B+then%0A+ln+-s+%24EBROOTGCC%2F..%2Flib%2Fgcc%2Flibstdc%2B%2B.so.6.0.29+%24PWD%2Foutdir-%24SLURM_JOBID%2Flibstdc%2B%2B.so.6.0.29%0A+export+LD_LIBRARY_PATH%3D%24PWD%2Foutdir-%24SLURM_JOBID%0Afi%0A%0Aexport+ANSGPU_PRINTDEVICES%3D1%0Aif+%5B%5B+%22%24CC_CLUSTER%22+%3D+beluga++%5D%5D%3B+then+%0A++export+KMP_AFFINITY%3Dnone%0A++mapdl+-dis+-acc+nvidia+-na+%24SLURM_GPUS_ON_NODE+-mpi+intelmpi+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID+-i+YOURAPDLFILE.inp%0Aelse%0A++mapdl+-dis+-acc+nvidia+-na+%24SLURM_GPUS_ON_NODE+-mpi+openmpi+-b+nolist+-np+%24SLURM_NTASKS+-dir+outdir-%24SLURM_JOBID+-i+YOURAPDLFILE.inp%0Afi" />
<input type="hidden" name="filename" value="script-dmp-2023-gpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --account=def-account    # Specify your account</span>
<span class="c1">#SBATCH --time=00-03:00          # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem-per-cpu=4G         # Specify memory per core</span>
<span class="c1">#SBATCH --nodes=1                # Specify number of nodes</span>
<span class="c1">#SBATCH --ntasks-per-node=8      # Specify cores per node</span>
<span class="c1">#SBATCH --cpus-per-task=1        # Do not change</span>
<span class="c1">#SBATCH --gpus-per-node=1        # Specify [gputype:]quantity</span>
<span class="c1">##SBATCH --gpus-per-node=h100:1  # Temporarily required on mini-graham</span>
<span class="c1">##SBATCH --partition=debug       # Temporarily required on mini-graham</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2023
<span class="c1">#module load ansys/2023R2</span>
module<span class="w"> </span>load<span class="w"> </span>ansys/2024R1.03

mkdir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cedar<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$EBROOTGCC</span>/../lib/gcc/libstdc++.so.6.0.29<span class="w"> </span><span class="nv">$PWD</span>/outdir-<span class="nv">$SLURM_JOBID</span>/libstdc++.so.6.0.29
<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$PWD</span>/outdir-<span class="nv">$SLURM_JOBID</span>
<span class="k">fi</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">ANSGPU_PRINTDEVICES</span><span class="o">=</span><span class="m">1</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CC_CLUSTER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>beluga<span class="w">  </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="w">  </span><span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>none
<span class="w">  </span>mapdl<span class="w"> </span>-dis<span class="w"> </span>-acc<span class="w"> </span>nvidia<span class="w"> </span>-na<span class="w"> </span><span class="nv">$SLURM_GPUS_ON_NODE</span><span class="w"> </span>-mpi<span class="w"> </span>intelmpi<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w"> </span>-i<span class="w"> </span>YOURAPDLFILE.inp
<span class="k">else</span>
<span class="w">  </span>mapdl<span class="w"> </span>-dis<span class="w"> </span>-acc<span class="w"> </span>nvidia<span class="w"> </span>-na<span class="w"> </span><span class="nv">$SLURM_GPUS_ON_NODE</span><span class="w"> </span>-mpi<span class="w"> </span>openmpi<span class="w"> </span>-b<span class="w"> </span>nolist<span class="w"> </span>-np<span class="w"> </span><span class="nv">$SLURM_NTASKS</span><span class="w"> </span>-dir<span class="w"> </span>outdir-<span class="nv">$SLURM_JOBID</span><span class="w"> </span>-i<span class="w"> </span>YOURAPDLFILE.inp
<span class="k">fi</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<p>Ansys allocates 1024 MB total memory and 1024 MB database memory by default for APDL jobs. These values can be manually specified (or changed) by adding arguments <code>-m 1024</code> and/or <code>-db 1024</code> to the mapdl command line in the above scripts. When using a remote institutional license server with multiple Ansys licenses, it may be necessary to add <code>-p aa_r</code> or <code>-ppf anshpc</code>, depending on which Ansys module you are using. As always, perform detailed scaling tests before running production jobs to ensure that the optimal number of cores and minimum amount memory is specified in your scripts. The <i>single node</i> (SMP Shared Memory Parallel) scripts will typically perform better than the <i>multinode</i> (DIS Distributed Memory Parallel) scripts and therefore should be used whenever possible. To help avoid compatibility issues the Ansys module loaded in your script should ideally match the version used to generate the input file:
</p>
<pre> [gra-login2:~/testcase] cat YOURAPDLFILE.inp | grep version
! ANSYS input file written by Workbench version 2019 R3
</pre>
<h2><span class="mw-headline" id="Ansys_EDT">Ansys EDT</span></h2>
<p>Ansys EDT can be run interactively in batch (non-gui) mode by first starting an salloc session with options <code>salloc --time=3:00:00 --tasks=8 --mem=16G --account=def-account</code> and then copy-pasting the full <code>ansysedt</code> command found in the last line of <i>script-local-cmd.sh</i>, being sure to manually specify $YOUR_AEDT_FILE.
</p>
<h3><span class="mw-headline" id="Slurm_scripts_5">Slurm scripts</span></h3>
<p>Ansys Electronic Desktop jobs may be submitted to a cluster queue with the <code>sbatch script-name.sh</code> command using either of the following single node scripts.  As of January 2023, the scripts had only been tested on Graham and therefore may be updated in the future as required to support other clusters.  Before using them, specify the simulation time, memory, number of cores and replace YOUR_AEDT_FILE with your input file name.   A full listing of command line options can be obtained by starting Ansys EDT in <a href="/wiki/ANSYS#Graphical_use" class="mw-redirect" title="ANSYS">graphical mode</a> with commands <code>ansysedt -help</code> or <code>ansysedt -Batchoptionhelp</code> to obtain scrollable graphical popups.  
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-8-0" name="tabs-8" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-8-1" name="tabs-8" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-8-1" data-tabpos="1">Single node (command line)</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-8-2" name="tabs-8" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-8-2" data-tabpos="2">Single node (options file)</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-local-cmd.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+compute+node+memory%29%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+cores+%28beluga+40%2C+cedar+32+or+48%2C+graham+32+or+44%2C+narval+64%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28Do+Not+Change%29%0A%0Amodule+load+StdEnv%2F2020%0Amodule+load+ansysedt%2F2021R2%0A%0A%23+Uncomment+next+line+to+run+a+test+example%3A%0Acp+-f+%24EBROOTANSYSEDT%2FAnsysEM21.2%2FLinux64%2FExamples%2FHFSS%2FAntennas%2FTransientGeoRadar.aedt+.%0A%0A%23+Specify+input+file+such+as%3A%0AYOUR_AEDT_FILE%3D%22TransientGeoRadar.aedt%22%0A%0A%23+Remove+previous+output%3A%0Arm+-rf+%24YOUR_AEDT_FILE.%2A+%24%7BYOUR_AEDT_FILE%7Dresults%0A%0A%23+----+do+not+change+anything+below+this+line+----+%23%0A%0Aecho+-e+%22%5CnANSYSLI_SERVERS%3D+%24ANSYSLI_SERVERS%22%0Aecho+%22ANSYSLMD_LICENSE_FILE%3D+%24ANSYSLMD_LICENSE_FILE%22%0Aecho+-e+%22SLURM_TMPDIR%3D+%24SLURM_TMPDIR+on+%24SLURMD_NODENAME%5Cn%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aansysedt+-monitor+-UseElectronicsPPE+-ng+-distributed+-machinelist+list%3Dlocalhost%3A1%3A%24SLURM_NTASKS+%5C%0A-batchoptions+%22TempDirectory%3D%24SLURM_TMPDIR+HPCLicenseType%3Dpool+HFSS%2FEnableGPU%3D0%22+-batchsolve+%22%24YOUR_AEDT_FILE%22" />
<input type="hidden" name="filename" value="script-local-cmd.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G              # Specify memory (set to 0 to use all compute node memory)</span>
<span class="c1">#SBATCH --ntasks=8             # Specify cores (beluga 40, cedar 32 or 48, graham 32 or 44, narval 64)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (Do Not Change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020
module<span class="w"> </span>load<span class="w"> </span>ansysedt/2021R2

<span class="c1"># Uncomment next line to run a test example:</span>
cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$EBROOTANSYSEDT</span>/AnsysEM21.2/Linux64/Examples/HFSS/Antennas/TransientGeoRadar.aedt<span class="w"> </span>.

<span class="c1"># Specify input file such as:</span>
<span class="nv">YOUR_AEDT_FILE</span><span class="o">=</span><span class="s2">&quot;TransientGeoRadar.aedt&quot;</span>

<span class="c1"># Remove previous output:</span>
rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$YOUR_AEDT_FILE</span>.*<span class="w"> </span><span class="si">${</span><span class="nv">YOUR_AEDT_FILE</span><span class="si">}</span>results

<span class="c1"># ---- do not change anything below this line ---- #</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nANSYSLI_SERVERS= </span><span class="nv">$ANSYSLI_SERVERS</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE= </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SLURM_TMPDIR= </span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> on </span><span class="nv">$SLURMD_NODENAME</span><span class="s2">\n&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
ansysedt<span class="w"> </span>-monitor<span class="w"> </span>-UseElectronicsPPE<span class="w"> </span>-ng<span class="w"> </span>-distributed<span class="w"> </span>-machinelist<span class="w"> </span><span class="nv">list</span><span class="o">=</span>localhost:1:<span class="nv">$SLURM_NTASKS</span><span class="w"> </span><span class="se">\</span>
-batchoptions<span class="w"> </span><span class="s2">&quot;TempDirectory=</span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> HPCLicenseType=pool HFSS/EnableGPU=0&quot;</span><span class="w"> </span>-batchsolve<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$YOUR_AEDT_FILE</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-local-opt.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D16G++++++++++++++%23+Specify+memory+%28set+to+0+to+allocate+all+compute+node+memory%29%0A%23SBATCH+--ntasks%3D8+++++++++++++%23+Specify+cores+%28beluga+40%2C+cedar+32+or+48%2C+graham+32+or+44%2C+narval+64%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28Do+Not+Change%29%0A%0Amodule+load+StdEnv%2F2020%0Amodule+load+ansysedt%2F2021R2%0A%0A%23+Uncomment+next+line+to+run+a+test+example%3A%0Acp+-f+%24EBROOTANSYSEDT%2FAnsysEM21.2%2FLinux64%2FExamples%2FHFSS%2FAntennas%2FTransientGeoRadar.aedt+.%0A%0A%23+Specify+input+filename+such+as%3A%0AYOUR_AEDT_FILE%3D%22TransientGeoRadar.aedt%22%0A%0A%23+Remove+previous+output%3A%0Arm+-rf+%24YOUR_AEDT_FILE.%2A+%24%7BYOUR_AEDT_FILE%7Dresults%0A%0A%23+Specify+options+filename%3A%0AOPTIONS_TXT%3D%22Options.txt%22%0A%0A%23+Write+sample+options+file%0Arm+-f+%24OPTIONS_TXT%0Acat+%3E+%24OPTIONS_TXT+%3C%3CEOF%0A%5C%24begin+%27Config%27%0A%27TempDirectory%27%3D%27%24SLURM_TMPDIR%27%0A%27HPCLicenseType%27%3D%27pool%27%0A%27HFSS%2FEnableGPU%27%3D0%0A%5C%24end+%27Config%27%0AEOF%0A%0A%23+----+do+not+change+anything+below+this+line+----+%23%0A%0Aecho+-e+%22%5CnANSYSLI_SERVERS%3D+%24ANSYSLI_SERVERS%22%0Aecho+%22ANSYSLMD_LICENSE_FILE%3D+%24ANSYSLMD_LICENSE_FILE%22%0Aecho+-e+%22SLURM_TMPDIR%3D+%24SLURM_TMPDIR+on+%24SLURMD_NODENAME%5Cn%22%0A%0Aexport+KMP_AFFINITY%3Ddisabled%0Aansysedt+-monitor+-UseElectronicsPPE+-ng+-distributed+-machinelist+list%3Dlocalhost%3A1%3A%24SLURM_NTASKS+%5C%0A-batchoptions+%24OPTIONS_TXT+-batchsolve+%22%24YOUR_AEDT_FILE%22" />
<input type="hidden" name="filename" value="script-local-opt.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=16G              # Specify memory (set to 0 to allocate all compute node memory)</span>
<span class="c1">#SBATCH --ntasks=8             # Specify cores (beluga 40, cedar 32 or 48, graham 32 or 44, narval 64)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (Do Not Change)</span>

module<span class="w"> </span>load<span class="w"> </span>StdEnv/2020
module<span class="w"> </span>load<span class="w"> </span>ansysedt/2021R2

<span class="c1"># Uncomment next line to run a test example:</span>
cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$EBROOTANSYSEDT</span>/AnsysEM21.2/Linux64/Examples/HFSS/Antennas/TransientGeoRadar.aedt<span class="w"> </span>.

<span class="c1"># Specify input filename such as:</span>
<span class="nv">YOUR_AEDT_FILE</span><span class="o">=</span><span class="s2">&quot;TransientGeoRadar.aedt&quot;</span>

<span class="c1"># Remove previous output:</span>
rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$YOUR_AEDT_FILE</span>.*<span class="w"> </span><span class="si">${</span><span class="nv">YOUR_AEDT_FILE</span><span class="si">}</span>results

<span class="c1"># Specify options filename:</span>
<span class="nv">OPTIONS_TXT</span><span class="o">=</span><span class="s2">&quot;Options.txt&quot;</span>

<span class="c1"># Write sample options file</span>
rm<span class="w"> </span>-f<span class="w"> </span><span class="nv">$OPTIONS_TXT</span>
cat<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$OPTIONS_TXT</span><span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s">\$begin &#39;Config&#39;</span>
<span class="s">&#39;TempDirectory&#39;=&#39;$SLURM_TMPDIR&#39;</span>
<span class="s">&#39;HPCLicenseType&#39;=&#39;pool&#39;</span>
<span class="s">&#39;HFSS/EnableGPU&#39;=0</span>
<span class="s">\$end &#39;Config&#39;</span>
<span class="s">EOF</span>

<span class="c1"># ---- do not change anything below this line ---- #</span>

<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nANSYSLI_SERVERS= </span><span class="nv">$ANSYSLI_SERVERS</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE= </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="s2">&quot;</span>
<span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SLURM_TMPDIR= </span><span class="nv">$SLURM_TMPDIR</span><span class="s2"> on </span><span class="nv">$SLURMD_NODENAME</span><span class="s2">\n&quot;</span>

<span class="nb">export</span><span class="w"> </span><span class="nv">KMP_AFFINITY</span><span class="o">=</span>disabled
ansysedt<span class="w"> </span>-monitor<span class="w"> </span>-UseElectronicsPPE<span class="w"> </span>-ng<span class="w"> </span>-distributed<span class="w"> </span>-machinelist<span class="w"> </span><span class="nv">list</span><span class="o">=</span>localhost:1:<span class="nv">$SLURM_NTASKS</span><span class="w"> </span><span class="se">\</span>
-batchoptions<span class="w"> </span><span class="nv">$OPTIONS_TXT</span><span class="w"> </span>-batchsolve<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$YOUR_AEDT_FILE</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h2><span class="mw-headline" id="Ansys_ROCKY">Ansys ROCKY</span></h2>
<p>Besides being able to run simulations in gui mode (as discussed in the Graphical usage section below) <a rel="nofollow" class="external text" href="https://www.ansys.com/products/fluids/ansys-rocky">Ansys Rocky</a> can also run simulations in non-gui mode.  Both modes support running Rocky with cpus only or with cpus and <a rel="nofollow" class="external text" href="https://www.ansys.com/blog/mastering-multi-gpu-ansys-rocky-software-enhancing-its-performance">gpus</a>.  In the below section two sample slurm scripts are  provided where each script would be submitted to the graham queue with the sbatch command as per usual.  At the time of this writing neither script has been tested and therefore extensive customization will likely be required.  It's important to note that these scripts are only usable on graham since the rocky module which they both load is only (at the present time) installed on graham (locally).
</p>
<h3><span class="mw-headline" id="Slurm_scripts_6">Slurm scripts</span></h3>
<p>To get a full listing of command line options run <code>Rocky -h</code> on the command line after loading any rocky module (currently only ansysrocky/2023R2 is available on Graham).   If Rocky is being run with gpus to solving coupled problems, the number of cpus you should request from slurm (on the same node) should be increased to a maximum until the scalability limit of the coupled application is reached.   If however Rocky is being run with gpus to solve standalone uncoupled problems, then only a minimal number of cpus should be requested that will allow be sufficient for Rocky to still run optimally.  For instance only 2cpus or possibly 3cpus maybe required.  When Rocky is run with &gt;= 4 cpus then <i>rocky_hpc</i> licenses will be required which the SHARCNET license does provide.
</p>
<div class="tabs tabs-tabbox"><input type="radio" form="tabs-inputform" id="tabs-input-9-0" name="tabs-9" class="tabs-input tabs-input-0" checked="" /><input type="radio" form="tabs-inputform" id="tabs-input-9-1" name="tabs-9" class="tabs-input tabs-input-1" /><label class="tabs-label" for="tabs-input-9-1" data-tabpos="1">CPU only</label><wbr /><input type="radio" form="tabs-inputform" id="tabs-input-9-2" name="tabs-9" class="tabs-input tabs-input-2" /><label class="tabs-label" for="tabs-input-9-2" data-tabpos="2">GPU based</label><wbr /><div class="tabs-container" style="">
<div class="tabs-content tabs-content-1">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-rocky-cpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+rrg%29%0A%23SBATCH+--time%3D00-02%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D24G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D6++++++%23+Specify+cores+%28graham+32+or+44+to+use+all+cores%29%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28do+not+change%29%0A%0A%23+the+rocky2023R2+module+on+graham+was+renamed+to+ansysrocky%2F2023R2+++Apr24%2F2025%0A%23module+load+ansysrocky%2F2023R2+StdEnv%2F2020+ansys%2F2023R2+++++++%23+only+avail+on+graham%0Amodule+load+ansysrocky%2F2024R2.0+StdEnv%2F2023+ansys%2F2024R2.04+++%23+only+avail+on+graham%0A%0ARocky+--simulate+%E2%80%9Cmysim.rocky%E2%80%9D+--resume%3D1+--ncpus%3D%24SLURM_CPUS_PER_TASK+--use-gpu%3D0" />
<input type="hidden" name="filename" value="script-rocky-cpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or rrg)</span>
<span class="c1">#SBATCH --time=00-02:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=24G              # Specify memory (set to 0 to use all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=6      # Specify cores (graham 32 or 44 to use all cores)</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (do not change)</span>

<span class="c1"># the rocky2023R2 module on graham was renamed to ansysrocky/2023R2   Apr24/2025</span>
<span class="c1">#module load ansysrocky/2023R2 StdEnv/2020 ansys/2023R2       # only avail on graham</span>
module<span class="w"> </span>load<span class="w"> </span>ansysrocky/2024R2.0<span class="w"> </span>StdEnv/2023<span class="w"> </span>ansys/2024R2.04<span class="w">   </span><span class="c1"># only avail on graham</span>

Rocky<span class="w"> </span>--simulate<span class="w"> </span>“mysim.rocky”<span class="w"> </span>--resume<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ncpus<span class="o">=</span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--use-gpu<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p><br />
</p>
</div>
<div class="tabs-content tabs-content-2">
<div class="code-file">
<div class="filename"><b>File&#160;:</b> script-rocky-gpu.sh</div>
<div class="download_form">
<p class="mw-empty-elt"></p><form action="/mediawiki/resources/assets/download.php" method="post">
<input type="hidden" name="text" value="%23%21%2Fbin%2Fbash%0A%0A%23SBATCH+--account%3Daccount++++++%23+Specify+your+account+%28def+or+reg%29%0A%23SBATCH+--time%3D00-01%3A00++++++++%23+Specify+time+%28DD-HH%3AMM%29%0A%23SBATCH+--mem%3D24G++++++++++++++%23+Specify+memory+%28set+to+0+to+use+all+node+memory%29%0A%23SBATCH+--cpus-per-task%3D6++++++%23+Specify+cores+%28graham+32+or+44+to+use+all+cores%29%0A%23SBATCH+--gres%3Dgpu%3Av100%3A2++++++%23+Specify+gpu+type+%3A+gpu+quantity%0A%23SBATCH+--nodes%3D1++++++++++++++%23+Request+one+node+%28do+not+change%29%0A%0A%23+the+rocky2023R2+module+on+graham+was+renamed+to+ansysrocky%2F2023R2+++Apr24%2F2025%0A%23module+load+ansysrocky%2F2023R2+StdEnv%2F2020+ansys%2F2023R2+++++++%23+only+avail+on+graham%0Amodule+load+ansysrocky%2F2024R2.0+StdEnv%2F2023+ansys%2F2024R2.04+++%23+only+avail+on+graham%0A%0ARocky+--simulate+%E2%80%9Cmysim.rocky%E2%80%9D+--resume%3D1+--ncpus%3D%24SLURM_CPUS_PER_TASK+--use-gpu%3D1+--gpu-num%3D%24SLURM_GPUS_ON_NODE" />
<input type="hidden" name="filename" value="script-rocky-gpu.sh" />
<input type="submit" value="" name="submit" class="download_submit" />
</form>
<p class="mw-empty-elt"></p>
</div>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --account=account      # Specify your account (def or reg)</span>
<span class="c1">#SBATCH --time=00-01:00        # Specify time (DD-HH:MM)</span>
<span class="c1">#SBATCH --mem=24G              # Specify memory (set to 0 to use all node memory)</span>
<span class="c1">#SBATCH --cpus-per-task=6      # Specify cores (graham 32 or 44 to use all cores)</span>
<span class="c1">#SBATCH --gres=gpu:v100:2      # Specify gpu type&#160;: gpu quantity</span>
<span class="c1">#SBATCH --nodes=1              # Request one node (do not change)</span>

<span class="c1"># the rocky2023R2 module on graham was renamed to ansysrocky/2023R2   Apr24/2025</span>
<span class="c1">#module load ansysrocky/2023R2 StdEnv/2020 ansys/2023R2       # only avail on graham</span>
module<span class="w"> </span>load<span class="w"> </span>ansysrocky/2024R2.0<span class="w"> </span>StdEnv/2023<span class="w"> </span>ansys/2024R2.04<span class="w">   </span><span class="c1"># only avail on graham</span>

Rocky<span class="w"> </span>--simulate<span class="w"> </span>“mysim.rocky”<span class="w"> </span>--resume<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ncpus<span class="o">=</span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--use-gpu<span class="o">=</span><span class="m">1</span><span class="w"> </span>--gpu-num<span class="o">=</span><span class="nv">$SLURM_GPUS_ON_NODE</span>
</pre></div>
</div>
<p><br />
</p>
</div>
</div></div>
<h1><span class="mw-headline" id="Graphical_use">Graphical use</span></h1>
<p>Ansys programs may be run interactively in GUI mode on cluster compute nodes or Graham VDI Nodes.
</p>
<h2><span class="mw-headline" id="Compute_nodes">Compute nodes</span></h2>
<p>Ansys can be run interactively on a single compute node for up to 24 hours.  This approach is ideal for testing large simulations since all cores and memory can be requested with salloc as described in <a href="/wiki/VNC#Compute_Nodes" title="VNC">TigerVNC</a>.  Once connected with vncviewer, any of the following program versions can be started after loading the required modules as shown below.
</p>
<h3><span class="mw-headline" id="Fluids">Fluids</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R1</code> (or newer versions)</dd>
<dd><code>fluent -mpi=intel</code>, or,</dd>
<dd><code>QTWEBENGINE_DISABLE_SANDBOX=1 cfx5</code></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Mapdl">Mapdl</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R2</code> (or newer versions)</dd>
<dd><code>mapdl -g</code>, or via launcher,</dd>
<dd><code>launcher</code> --&gt; click RUN button</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Workbench_2">Workbench</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020</code></dd>
<dd><code>module load ansys/2021R2</code> (or newer versions)</dd>
<dd><code>xfwm4 --replace &amp;</code> (only needed if using Ansys Mechanical)</dd>
<dd><code>export QTWEBENGINE_DISABLE_SANDBOX=1</code> (only needed if using CFD-Post)</dd>
<dd><code>runwb2</code></dd>
<dd><br /></dd>
<dd>NOTES :When running an Analysis Program such as Mechanical or Fluent in parallel on a single node, untick <i>Distributed</i> and specify a value of cores equal to your <b>salloc session setting minus 1</b>. The pulldown menus in the Ansys Mechanical workbench do not respond properly. As a workaround run <code>xfwm4 --replace</code> on the command line before starting workbench as shown. To make xfwm4 your default edit <code>$HOME/.vnc/xstartup</code> and change <code>mate-session</code> to <code>xfce4-session</code>.  Lastly, fluent from ansys/2022R2 does not currently work on compute nodes please use a different version.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ansys_EDT_2">Ansys EDT</span></h3>
<dl><dd><dl><dd><dl><dd>Start an interactive session using the following form of the salloc command (to specify cores and available memory):</dd>
<dd><code>salloc --time=3:00:00 --nodes=1 --cores=8 --mem=16G --account=def-group</code></dd>
<dd><code>xfwm4 --replace &amp;</code> (then hit enter twice)</dd>
<dd><code>module load StdEnv/2020 ansysedt/2021R2</code>, or</dd>
<dd><code>module load StdEnv/2020 ansysedt/2023R2</code>, or</dd>
<dd><code>module load StdEnv/2023 ansysedt/2023R2</code>, or</dd>
<dd><code>module load StdEnv/2023 ansysedt/2024R2</code>  &lt;---&#160;!!! this module version is currently only on graham&#160;!!!</dd>
<dd><code>ansysedt</code></dd>
<dd>o Click <code>Tools -&gt; Options -&gt; HPC and Analysis Options -&gt; Edit</code> then&#160;:
<dl><dd>1) untick Use Automatic Settings box (required one time only)</dd>
<dd>2) under Machines tab do not change Cores (auto-detected from slurm)</dd></dl></dd>
<dd>o To run interactive analysis click:  <code>Project -&gt; Analyze All</code></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ensight">Ensight</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load StdEnv/2020 ansys/2022R2; A=222; B=5.12.6</code>, or</dd>
<dd><code>module load StdEnv/2020 ansys/2022R1; A=221; B=5.12.6</code>, or</dd>
<dd><code>module load StdEnv/2020 ansys/2021R2; A=212; B=5.12.6</code>, or</dd>
<dd><code>module load StdEnv/2020 ansys/2021R1; A=211; B=5.12.6</code>, or</dd>
<dd><code>export LD_LIBRARY_PATH=$EBROOTANSYS/v$A/CEI/apex$A/machines/linux_2.6_64/qt-$B/lib</code></dd>
<dd><code>ensight -X</code></dd></dl></dd></dl></dd></dl>
<p>Note: ansys/2022R2 Ensight is lightly tested on compute nodes. Please let us know if you find any problems using it.
</p>
<h3><span class="mw-headline" id="Rocky">Rocky</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load ansysrocky/2023R2 StdEnv/2020 ansys/2023R2</code></dd>
<dd><code>module load ansysrocky/2024R2.0 StdEnv/2023 ansys/2024R2.04</code></dd>
<dd><code>Rocky</code> Uses the SHARCNET license server by default (does not read ansys.lic)<br /></dd>
<dd><code>Rocky-gui</code> Uses ~/licenses/ansys.lic if it exists else select CMC or SHARCNET server<br /></dd>
<dd><code>RockySolver</code> Run rocky solver directly from command line add -h for help (untested)</dd>
<dd><code>RockySchedular</code>  Start rocky schedular gui to submit/run jobs on present node (untested)</dd>
<dd>o The Rocky, RockySolver, RockySchedular commands provided by the locally installed ansysrocky modules on gra-vdi (and graham) all use the SHARCNET license server by default. To specify a different license server you must currently manually export ANSYSLMD_LICENSE_FILE and ANSYSLI_SERVERS environment variables to port@yourserverip</dd>
<dd>o Rocky is currently only available on gra-vdi and graham cluster</dd>
<dd>o The SHARCNET license now includes Rocky and is therefore free for all researchers to use</dd>
<dd>o Rocky supports GPU-accelerated computing however this capability not been tested ..</dd>
<dd>o To request a graham compute node for 8hrs with 4 cpus and 1 gpu for interactive use&#160;:</dd>
<dd><code>salloc --time=08:00:00 --nodes=1 --cpus-per-task=4 --gres=gpu:v100:1 --mem=32G --account=someaccount</code></dd></dl></dd></dl></dd></dl>
<h2><span class="mw-headline" id="VDI_nodes">VDI nodes</span></h2>
<p>Ansys programs can be run for up to 7days on grahams VDI nodes (gra-vdi.alliancecan.ca) using 8 cores (16 cores max) and 128GB memory.  The VDI System provides GPU OpenGL acceleration therefore it is ideal for performing tasks that benefit from high performance graphics.  One might use VDI to create or modify simulation input files, post-process data or visualize simulation results.  To log in connect with <a href="/wiki/VNC#VDI_Nodes" title="VNC">TigerVNC</a> then open a new terminal window and start one of the program versions shown below.  The vertical bar <code>|</code> notation is used to separate the various commands.   The maximum job size for any parallel job run on gra-vdi should be limited to 16cores to avoid overloading the servers and impacting other users.  To run two simultaneous gui jobs (16 cores max each) on gra-vdi establish two independent vnc sessions.  For the first session, connect to gra-vdi3.sharcnet.ca with vnc. For the second session connect to gra-vdi4.sharecnet.ca also with vnc.  Then within each session, start Ansys in gui mode and run your simulation.  Note that simultaneous simulations should in general be run in different directories to avoid file conflict issues.  Unlike compute nodes vnc connections (which impose slurm limits through salloc) there is no time limit constraint on gra-vdi when running simulations.
</p>
<h3><span class="mw-headline" id="Fluids_2">Fluids</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load CcEnv StdEnv/2023</code></dd>
<dd><code>ansys/2024R2.04</code> (or older versions)</dd>
<dd><code>unset SESSION_MANAGER</code></dd>
<dd><code>fluent | cfx5 | icemcfd</code></dd>
<dd>o Where unsetting SESSION_MANAGER prevents the following Qt message from appearing when starting fluent:</dd>
<dd>[<span style="Color:#ff7f50">Qt: Session management error: None of the authentication protocols specified are supported</span>]</dd>
<dd>o In the event the following message appears in a popup window when starting icemcfd ...</dd>
<dd>[<span style="Color:#ff7f50">Error segmentation violation - exiting after doing an emergency save</span>]</dd>
<dd>... do not click the popup OK button otherwise icemcfd will crash.  Instead do the following (one time only):</dd>
<dd>click the Settings Tab -&gt; Display -&gt; tick X11 -&gt; Apply -&gt; OK -&gt; File -&gt; Exit</dd>
<dd>The error popup should no longer appear when icemcfd is restarted.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Mapdl_2">Mapdl</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load CcEnv StdEnv/2023</code></dd>
<dd><code>ansys/2024R2.04</code> (or older versions)</dd>
<dd><code>mapdl -g</code> (to start the gui directly), or,</dd>
<dd><code>unset SESSION_MANAGER; launcher -&gt; click RUN button</code></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Workbench_3">Workbench</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load CcEnv StdEnv/2023</code></dd>
<dd><code>ansys/2024R2.04</code> (or older versions)</dd>
<dd><code>export HOOPS_PICTURE=opengl</code></dd>
<dd><code>runwb2</code></dd>
<dd>o The export line avoids the following tui Warning from appearing when fluent starts:
<dl><dd>[<span style="Color:#ff7f50">Software rasterizer found, hardware acceleration will be disabled.</span>]</dd></dl></dd>
<dd>Alternatively the HOOPS_PICTURE environment variable can be set inside workbench by doing:
<dl><dd>Fluent Launcher --&gt; Environment Tab --&gt; HOOPS_PICTURE=opengl (without the export)</dd></dl></dd></dl></dd></dl></dd></dl>
<dl><dd><dl><dd><dl><dd>NOTE1: When running Mechanical in Workbench on gra-vdi be sure to <b>tic</b> <i>Distributed</i> in the upper ribbon Solver panel and specify a maximum value of <b>24</b> cores.  When running Fluent on gra-vdi instead, <b>untic</b> <i>Distributed</i> and specify a maximum value of <b>12</b> cores.  Do not attempt to use more than 128GB memory otherwise Ansys will hit the hard limit and be killed. If you need more cores or memory then please use a cluster compute node to run your graphical session on (as described in the previous Compute nodes section above).  When doing old pre-processing or post-processing work with Ansys on gra-vdi and not running calculation, please only use <b>4</b> cores otherwise hpc licenses will be checked out unnecessarily.</dd>
<dd>NOTE2: On rare occasions Ansys workbench or some programs that run within it will freeze or not start properly; Inparticular if vncviewer unexpectedly disconnected before Ansys could be cleanly shutdown.  In general, if Ansys is not behaving properly open a new terminal window on gra-vdi and run  <code>pkill -9 -e -u $USER -f "ansys|fluent|mwrpcss|mwfwrapper|ENGINE|mono"</code> to fully kill off all Ansys processes.  If the problem persists then try running <code>rm -rf .ansys</code> if you have been working in the gui on compute nodes before working on gra-vdi.  If the problem involves home, project or scratch (the df command hangs) then its highly probable ansys will resume working normally again once the attached storage issue is resolved.</dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ansys_EDT_3">Ansys EDT</span></h3>
<dl><dd><dl><dd><dl><dd>Open a terminal window and load the module:</dd>
<dd><code>module load SnEnv</code></dd>
<dd><code>ansysedt/2024R2.1</code> (or older versions)</dd>
<dd>Type <code>ansysedt</code> in the terminal and wait for the gui to start</dd>
<dd>The following only needs to be done once:
<dl><dd>click <code>Tools -&gt; Options -&gt; HPC and Analysis Options -&gt; Options</code></dd>
<dd>change <code>HPC License</code> pulldown to <b>Pool</b> (allows &gt; 4 cores to be used)</dd>
<dd>click <code>OK</code></dd></dl></dd>
<dd>----------   EXAMPLES  ----------</dd>
<dd>To copy the 2023R2 Antennas examples directory into your account:
<dl><dd>login to a cluster such as graham</dd>
<dd><code>module load ansysedt/2023R2</code></dd>
<dd><code>mkdir -p ~/Ansoft/$EBVERSIONANSYSEDT; cd ~/Ansoft/$EBVERSIONANSYSEDT; rm -rf Antennas</code></dd>
<dd><code>cp -a $EBROOTANSYSEDT/v232/Linux64/Examples/HFSS/Antennas ~/Ansoft/$EBVERSIONANSYSEDT</code></dd></dl></dd>
<dd>To run an example:
<dl><dd>open a simulation .aedt file then click <code>HFSS -&gt; Validation Check</code></dd>
<dd>(if errors are reported by the validation check, close then reopen the simulation and repeat as required)</dd>
<dd>to run simulation click <code>Project -&gt; Analyze All</code></dd>
<dd>to quit without saving the converged solution click <code>File -&gt; Close -&gt; No </code></dd></dl></dd>
<dd>If the program crashes and won't restart try running the following commands:
<dl><dd><code>pkill -9 -u $USER -f "ansys*|mono|mwrpcss|apip-standalone-service"</code></dd>
<dd><code>rm -rf ~/.mw</code> (ansysedt will re-run first-time configuration on startup)</dd></dl></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Ensight_2">Ensight</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load SnEnv</code></dd>
<dd><code>ansys/2024R2.04</code> (or older versions back to 2021R2)</dd>
<dd><code>ensight</code><br /></dd></dl></dd></dl></dd></dl>
<h3><span class="mw-headline" id="Rocky_2">Rocky</span></h3>
<dl><dd><dl><dd><dl><dd><code>module load clumod ansysrocky/2023R2 CcEnv StdEnv/2020 ansys/2023R2</code>, or,</dd>
<dd><code>module load clumod ansysrocky/2024R2.0 CcEnv StdEnv/2023 ansys/2024R2.04</code></dd>
<dd>o This local module setup provides two custom wrapper commands <b>1)</b> <code>Rocky-bat</code> that will read your <i>~/.license/ansys.lic</i> if one exists otherwise default to the SHARCNET license server and <b>2)</b> <code>Rocky-gui</code> that will also read your <i>~/.license/ansys.lic</i> file if one exists and provide an interactive prompt to choose either the CMC or SHARCNET server.</dd>
<dd>o The standard <code>Rocky</code>, <code>RockySolver</code> and <code>RockyScheduler</code> commands are also directly available and configured to use the SHARCNET license server by default.  They will not attempt to read <i>~/.license/ansys.lic</i> even if one is present. So the user must manually set ANSYSLMD_LICENSE_FILE and ANSYSLI_SERVERS environment variables to specify a different license server (other than SHARCNET).  Adding <code>-h</code> as an argument to any of these commands will result in their respective command line options being printed before immediately exiting.</dd>
<dd>o Rocky is currently only available on gra-vdi and graham clusters with a global cluster module coming asap</dd>
<dd>o When Rocky is run on gra-vdi it should only be used with cpus since the machine currently only has a gpu for graphics</dd>
<dd>o The SHARCNET license includes Rocky and is therefore free for all researchers to use</dd>
<dd>o The Rocky Innovation Space is located <a rel="nofollow" class="external text" href="https://innovationspace.ansys.com/ais-rocky/">https://innovationspace.ansys.com/ais-rocky/</a></dd>
<dd>o For Ansys Rocky 2024 R2 and 2025 R1  Release Highlights click <a rel="nofollow" class="external text" href="https://innovationspace.ansys.com/knowledge/forums/topic/ansys-rocky-2024-r2-release-highlights/">here</a> and <a rel="nofollow" class="external text" href="https://innovationspace.ansys.com/knowledge/forums/topic/ansys-rocky-2025-r1-release-highlights/">here</a></dd></dl></dd></dl></dd></dl>
<h2><span class="mw-headline" id="SSH_issues">SSH issues</span></h2>
<dl><dd><dl><dd><dl><dd>Some Ansys GUI programs can be run remotely on a cluster compute node by X forwarding over SSH to your local desktop.  Unlike VNC, this approach is untested and unsupported since it relies on a properly setup X display server for your particular operating system OR the selection, installation and configuration of a suitable X client emulator package such as MobaXterm.  Most users will find interactive response times unacceptably slow for basic menu tasks let alone performing more complex tasks such as those involving graphics rendering.  Startup times for GUI programs can also be very slow depending on your Internet connection. For example, in one test it took 40 minutes to fully start <i>ansysedt</i> over SSH while starting it with vncviewer required only 34 seconds.  Despite the potential slowness when connecting over SSH to run GUI programs, doing so may still be of interest if your only goal is to open a simulation and perform some basic menu operations or run some calculations. The basic steps are given here as a starting point: 1) ssh -Y username@graham.computecanada.ca; 2) salloc --x11 --time=1:00:00 --mem=16G --cpus-per-task=4 [--gpus-per-node=1] --account=def-mygroup; 3) once connected onto a compute node try running <code>xclock</code>.  If the clock appears on your desktop, proceed to load the desired Ansys module and try running the program.</dd></dl></dd></dl></dd></dl>
<h1><span class="mw-headline" id="Site-specific_usage">Site-specific usage</span></h1>
<h2><span class="mw-headline" id="SHARCNET_license">SHARCNET license</span></h2>
<p>The SHARCNET Ansys license is free for academic use by <b>any</b> Alliance researcher on <b>any</b> Alliance system.   The installed software does not have any solver or geometry limits.  The SHARCNET license may <b>only</b> be used for the purpose of <b><i>Publishable Academic Research</i></b>.  Producing results for private commercial purposes is strictly prohibited.  The SHARCNET license was upgraded from CFD to MCS (Multiphysics Campus Solution) in May of 2020. It includes the following products: HF, EM, Electronics HPC, Mechanical and CFD as described <a rel="nofollow" class="external text" href="https://www.ansys.com/academic/educator-tools/academic-product-portfolio">here</a>. In 2023 Rocky for Linux (no Workbench support) was also added. Neither LS-DYNA or Lumerical are included in the SHARCNET license. Note that since all the Alliance clusters are Linux based, SpaceClaim cannot be used on our systems. In July of 2021, an additional 1024 anshpc licenses were added to the previous 512 pool.  Before running large parallel jobs, scaling tests should be run for any given simulation.  Parallel jobs that do not achieve at least 50% CPU utilization may be flagged by the system for a follow-up by our support team.
</p><p>As of December 2022, each researcher can run 4 jobs using a total of 252 anshpc (plus 4 anshpc per job).  Thus any of the following uniform job size combinations are possible: one 256 core job, two 130 core jobs, three 88 core jobs, or four 67 core jobs according to ( (252 + 4*num_jobs) / num_jobs ).  UPDATE as of October 2024 the license limit has been increased to 8 jobs and 512 hpc cores per researcher (collectively across all clusters for all applications) for a testing period to allow some researchers more flexibility for parameter explorations and running larger problems.  As the license will be far more oversubscribed some instances of job failures on startup may rarely occur, in which rare case the jobs will need to be  resubmitted.  Nevertheless assuming most researchers continue with a pattern of running one or two jobs using 128 cores on average total this is not expected to be an issue.  That said it will be helpful to close Ansys applications immediately upon completion of any gui related tasks to release any licenses that maybe consumed while the application is otherwise idle, for others to use.
</p><p>Since the best parallel performance is usually achieved by using all cores on compute nodes (aka full nodes), one can determine the number of full nodes by dividing the total anshpc cores with the compute node size.  For example, consider  Graham which has many 32-core (Broadwell) and some 44-core (Cascade) compute nodes, the maximum number of nodes that could be requested when running various size jobs on 32-core nodes assuming a 252 hpc core limit would be: 256/32=8, 130/32=~4, 88/32=~2 or 67/32=~2 to run 1, 2, 3 or 4 simultaneous jobs respectively. To express this in equation form, for a given compute node size on any cluster, the number of compute nodes can be calculated by ( 252 + (4*num_jobs) ) / (num_jobs*cores_per_node) ) then round down and finally determine the total cores to request by multiplying the even number of nodes by the number of cores_per_node.
</p><p>The SHARCNET Ansys license is made available on a first come first serve basis.  Should an unusually large number of Ansys jobs be submitted on a given day, some jobs could fail on startup if insufficient licenses are available.  If this occurs, resubmit your job as soon as possible. If your research requires more than 512 hpc cores (the recent new max limit), open a ticket to let us know.  You will most likely need to purchase (and host) your own Ansys license at your local institution if it's urgently needed; in such case, contact your local <a rel="nofollow" class="external text" href="https://www.simutechgroup.com">SimuTech</a> office for a quote. However, if over time enough researchers express the same need, acquiring a larger Ansys license on the next renewal cycle may be possible.
</p><p>Researchers can also purchase their own license subscription from <a rel="nofollow" class="external text" href="https://www.cmc.ca/subscriptions/">CMC</a> and use their remote license servers.  Doing so will have several benefits 1) a local institutional license server is not needed 2) a physical license does not need to be obtained upon each renewal 3) the license can be used <a rel="nofollow" class="external text" href="https://www.cmc.ca/ansys-campus-solutions-cmc-00200-04847/">almost anywhere</a> including at home, institutions, or any alliance cluster across Canada and 4) download and installation instructions for the Windows version are provided so researchers can run spaceclaim on their own computer (not possible on the Alliance since all systems are Linux-based).  There is however one potentially serious limitation; according to the CMC <a rel="nofollow" class="external text" href="https://www.cmc.ca/qsg-ansys-cadpass-r20/">Ansys Quick Start Guides</a>, there may be a 64 core limit per user.
</p>
<h4><span class="mw-headline" id="License_server_file">License server file</span></h4>
<p>To use the SHARCNET Ansys license on any Alliance cluster, simply configure your <code>ansys.lic</code> file as follows:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="o">[</span>username@cluster:~<span class="o">]</span><span class="w"> </span>cat<span class="w"> </span>~/.licenses/ansys.lic
setenv<span class="o">(</span><span class="s2">&quot;ANSYSLMD_LICENSE_FILE&quot;</span>,<span class="w"> </span><span class="s2">&quot;1055@license3.sharcnet.ca&quot;</span><span class="o">)</span>
setenv<span class="o">(</span><span class="s2">&quot;ANSYSLI_SERVERS&quot;</span>,<span class="w"> </span><span class="s2">&quot;2325@license3.sharcnet.ca&quot;</span><span class="o">)</span>
</pre></div>
<h4><span class="mw-headline" id="Query_license_server">Query license server</span></h4>
<p>To show the number of licenses in use by your username and the total in use by all users, run:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span>ssh<span class="w"> </span>graham.computecanada.ca
module<span class="w"> </span>load<span class="w"> </span>ansys
lmutil<span class="w"> </span>lmstat<span class="w"> </span>-c<span class="w"> </span><span class="nv">$ANSYSLMD_LICENSE_FILE</span><span class="w"> </span>-a<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Users of\|</span><span class="nv">$USER</span><span class="s2">&quot;</span>
</pre></div>
<p>If you discover any licenses unexpectedly in use by your username (usually due to ansys not exiting cleanly on gra-vdi), connect to the node where it's running, open a terminal window and run the following command to terminate the rogue processes <code>pkill -9 -e -u $USER -f "ansys"</code> after which your licenses should be freed.  Note that gra-vdi consists of two nodes (gra-vdi3 and gra-vdi4) which researchers are randomly placed on when connecting to gra-vdi.computecanada.ca with <a href="/wiki/VNC#VDI_Nodes" title="VNC">TigerVNC</a>.  Therefore it's necessary to specify the full hostname (gra-vdi3.sharcnet.ca or grav-vdi4.sharcnet.ca) when connecting with tigervnc to ensure you log into the correct node before running pkill.
</p>
<h3><span class="mw-headline" id="Local_VDI_modules">Local VDI modules</span></h3>
<p>When using gra-vdi, researchers have the choice of loading Ansys modules from our global environment (after loading CcEnv) or loading Ansys modules installed locally on the machine itself (after loading SnEnv).  The local modules may be of interest as they include some Ansys programs and versions not yet supported by our standard environment.  When starting programs from local Ansys modules, you can select the CMC license server or accept the default SHARCNET license server.  Presently, the settings from <code>~/.licenses/ansys.lic</code> are not used by the local Ansys modules except when starting <code>runwb2</code> where they will override the default SHARCNET license server settings. Suitable usage of Ansys programs on gra-vdi includes: running a single test job interactively with up to 8 cores and/or 128G RAM, create or modify simulation input files, post process or visualize data.
</p>
<h4><span class="mw-headline" id="Ansys_modules">Ansys modules</span></h4>
<ol><li>Connect to gra-vdi.computecanada.ca with <a href="/wiki/VNC#VDI_Nodes" title="VNC">TigerVNC</a>.</li>
<li>Open a new terminal window and load a module:
<dl><dt><code>module load SnEnv ansys/2021R2</code>, or</dt>
<dt><code>module load SnEnv ansys/2021R1</code>, or</dt>
<dt><code>module load SnEnv ansys/2020R2</code>, or</dt>
<dt><code>module load SnEnv ansys/2020R1</code>, or</dt>
<dt><code>module load SnEnv ansys/2019R3</code></dt></dl></li>
<li>Start an Ansys program by issuing one of the following:
<dl><dt><code>runwb2|fluent|<b>cfx5</b>|icemcfd|apdl</code></dt></dl></li>
<li>Press <code>y</code> and <code>Enter</code> to accept the conditions</li>
<li>Press <code>Enter</code> to accept the <code>n</code> option and use the SHARCNET license server by default (in the case of runwb2 <i>~/.licenses/ansysedt.lic</i> will be used if present, otherwise ANSYSLI_SERVERS and ANSYSLMD_LICENSE_FILE will be used if set in your environment for example to some other remote license server).  If you change <code>n</code> to <code>y</code> and hit <code>y</code>. the CMC license server will be used.</li></ol>
<p>where <code><b>cfx5</b></code> from step 3. above provides the option to start the following components:
</p>
<pre>   1) CFX-Launcher  (cfx5 -&gt; cfx5launch)
   2) CFX-Pre       (cfx5pre)
   3) CFD-Post      (cfdpost -&gt; cfx5post)
   4) CFX-Solver    (cfx5solve)
</pre>
<h4><span class="mw-headline" id="ansysedt_modules">ansysedt modules</span></h4>
<ol><li>Connect to gra-vdi.computecanada.ca with <a href="/wiki/VNC#VDI_Nodes" title="VNC">TigerVNC</a>.</li>
<li>Open a new terminal window and load a module:
<dl><dt><code>module load SnEnv ansysedt/2021R2</code>, or</dt>
<dt><code>module load SnEnv ansysedt/2021R1</code></dt></dl></li>
<li>Start the Ansys Electromagnetics Desktop program by typing the following command: <code>ansysedt</code></li>
<li>Press <code>y</code> and <code>Enter</code> to accept the conditions.</li>
<li>Press <code>Enter</code> to accept the <code>n</code> option and use the SHARCNET license server by default (note that  <i>~/.licenses/ansysedt.lic</i> will be used if present, otherwise ANSYSLI_SERVERS and ANSYSLMD_LICENSE_FILE will be used if set in your environment for example to some other remote license server).  If you change <code>n</code> to <code>y</code> and hit enter,  the CMC license server will be used.</li></ol>
<p>License feature preferences previously setup with <i>anslic_admin</i> are no longer supported following the recent SHARCNET license server update (2021-09-09).  If a license problem occurs, try removing the <code>~/.ansys</code> directory in your /home account to clear the settings.  If problems persist please contact our <a href="/wiki/Technical_support" title="Technical support">technical support</a> and provide the contents of your <code>~/.licenses/ansys.lic</code> file.
</p>
<h1><span class="mw-headline" id="Additive_Manufacturing">Additive Manufacturing</span></h1>
<p>To get started configure your <code>~/.licenses/ansys.lic</code> file to point to a license server that has a valid Ansys Mechanical License.  This must be done on all systems where you plan to run the software.  
</p>
<h2><span class="mw-headline" id="Enable_Additive">Enable Additive</span></h2>
<p>This section describes how to make the Ansys Additive Manufacturing ACT extension available for use in your project. The steps must be performed on each cluster for each ansys module version where the extension will be used. Any extensions needed by your project will also need to be installed on the cluster as described below.  If you get warnings about missing un-needed extensions (such as ANSYSMotion) then uninstall them from your project.
</p>
<h3><span class="mw-headline" id="Download_Extension">Download Extension</span></h3>
<ul><li>download AdditiveWizard.wbex from <a rel="nofollow" class="external free" href="https://catalog.ansys.com/">https://catalog.ansys.com/</a></li>
<li>upload AdditiveWizard.wbex to the cluster where it will be used</li></ul>
<h3><span class="mw-headline" id="Start_Workbench">Start Workbench</span></h3>
<ul><li>follow the Workbench section in <a href="/wiki/ANSYS#Graphical_use" class="mw-redirect" title="ANSYS">Graphical use above</a>.</li>
<li>File -&gt; Open your project file (ending in .wbpj) into Workbench gui</li></ul>
<h3><span class="mw-headline" id="Open_Extension_Manager">Open Extension Manager</span></h3>
<ul><li>click ACT Start Page and the ACT Home page tab will open</li>
<li>click Manage Extensions and the Extension Manager will open</li></ul>
<h3><span class="mw-headline" id="Install_Extension">Install Extension</span></h3>
<ul><li>click the box with the large + sign under the search bar</li>
<li>navigate to select and install your AdditiveWizard.wbex file</li></ul>
<h3><span class="mw-headline" id="Load_Extension">Load Extension</span></h3>
<ul><li>click to highlight the AdditiveWizard box (loads the AdditiveWizard extension for current session only)</li>
<li>click lower right corner arrow in the AdditiveWizard box and select <i>Load extension</i> (loads the extension for current AND future sessions)</li></ul>
<h3><span class="mw-headline" id="Unload_Extension">Unload Extension</span></h3>
<ul><li>click to un-highlight the AdditiveWizard box (unloads extension for the current session only)</li>
<li>click lower right corner arrow in the AdditiveWizard box and select <i>Do not load as default</i> (extension will not load for future sessions)</li></ul>
<h2><span class="mw-headline" id="Run_Additive">Run Additive</span></h2>
<h3><span class="mw-headline" id="Gra-vdi">Gra-vdi</span></h3>
<p>A user can run a single Ansys Additive Manufacturing job on gra-vdi with up to 16 cores as follows: 
</p>
<ul><li>Start Workbench on Gra-vdi as described above in <b>Enable Additive</b>.</li>
<li>click File -&gt; Open and select <i>test.wbpj</i> then click Open</li>
<li>click View -&gt; reset workspace if you get a grey screen</li>
<li>start Mechanical, Clear Generated Data, tick Distributed, specify Cores</li>
<li>click File -&gt; Save Project -&gt; Solve</li></ul>
<p>Check utilization:
</p>
<ul><li>open another terminal and run: <code>top -u $USER</code>   **OR**  <code>ps u -u $USER | grep ansys</code></li>
<li>kill rogue processes from previous runs:  <code>pkill -9 -e -u $USER -f "ansys|mwrpcss|mwfwrapper|ENGINE"</code></li></ul>
<p>Please note that rogue processes can persistently tie up licenses between gra-vdi login sessions or cause other unusual errors when trying to start gui programs on gra-vdi.  Although rare, rogue processes can occur if an ansys gui session (fluent, workbench, etc) is not cleanly terminated by the user before vncviewer is terminated either manually or unexpectedly - for instance due to a transient network outage or hung filesystem.  If the latter is to blame then the processes may not by killable until normal disk access is restored.
</p>
<h3><span class="mw-headline" id="Cluster">Cluster</span></h3>
<p>Project preparation:
</p><p>Before submitting a newly uploaded Additive project to a cluster queue (with <code>sbatch scriptname</code>) certain preparations must be done.  To begin, open your simulation with Workbench gui (as described in the <code>Enable Additive</code> section above) in the same directory that your job will be submitted from and then save it again. Be sure to use the same ansys module version that will be used for the job.  Next create a Slurm script (as explained in the <i>Cluster Batch Job Submission - WORKBENCH</i> section above).  To perform parametric studies, change <code>Update()</code> to <code>UpdateAllDesignPoints()</code> in the Slurm script.  Determine the optimal number of cores and memory by submitting several short test jobs.  To avoid needing to manually clear the solution <b>and</b> recreate all the design points in Workbench between each test run, either 1) change <code>Save(Overwrite=True)</code> to <code>Save(Overwrite=False)</code> or 2) save a copy of the original YOURPROJECT.wbpj file and corresponding YOURPROJECT_files directory.  Optionally create and then manually run a replay file on the cluster in the respective test case directory between each run, noting that a single replay file can be used in different directories by opening it in a text editor and changing the internal FilePath setting.
</p>
<pre>module load ansys/2019R3
rm -f test_files/.lock
runwb2 -R myreplay.wbjn
</pre>
<p>Resource utilization:
</p><p>Once your additive job has been running for a few minutes, a snapshot of its resource utilization on the compute node(s) can be obtained with the following srun command.  Sample output corresponding to an eight core submission script is shown next.  It can be seen that two nodes were selected by the scheduler:
</p>
<pre>[gra-login1:~] srun --jobid=myjobid top -bn1 -u $USER | grep R | grep -v top
  PID USER   PR  NI    VIRT    RES    SHR S  %CPU %MEM    TIME+  COMMAND
22843 demo   20   0 2272124 256048  72796 R  88.0  0.2  1:06.24  ansys.e
22849 demo   20   0 2272118 256024  72822 R  99.0  0.2  1:06.37  ansys.e
22838 demo   20   0 2272362 255086  76644 R  96.0  0.2  1:06.37  ansys.e
  PID USER   PR  NI    VIRT    RES    SHR S  %CPU %MEM    TIME+  COMMAND
 4310 demo   20   0 2740212 271096 101892 R 101.0  0.2  1:06.26  ansys.e
 4311 demo   20   0 2740416 284552  98084 R  98.0  0.2  1:06.55  ansys.e
 4304 demo   20   0 2729516 268824 100388 R 100.0  0.2  1:06.12  ansys.e
 4305 demo   20   0 2729436 263204 100932 R 100.0  0.2  1:06.88  ansys.e
 4306 demo   20   0 2734720 431532  95180 R 100.0  0.3  1:06.57  ansys.e
</pre>
<p>Scaling tests:
</p><p>After a job completes, its "Job Wall-clock time" can be obtained from <code>seff myjobid</code>.  Using this value, scaling tests can be performed by submitting short test jobs with an increasing number of cores.  If the Wall-clock time decreases by ~50% when the number of cores is doubled, additional cores may be considered.
</p>
<h1><span class="mw-headline" id="Help_resources">Help resources</span></h1>
<h2><span class="mw-headline" id="Online_documentation">Online documentation</span></h2>
<p>A publicly accessible online version of the <a rel="nofollow" class="external text" href="https://ansyshelp.ansys.com/public/account/secured?returnurl=/Views/Secured/prod_page.html?pn=Fluent&amp;pid=Fluent&amp;lang=en">Ansys Help site</a> with full Documentation, Tutorial and Videos for the <b>LATEST</b> Ansys release version.  Developer documentation is available <a rel="nofollow" class="external text" href="https://developer.ansys.com/docs">here</a> also without login. To access documentation for Ansys versions 2024R1, 2024R2 AND 2025R1 you however WILL need to login <a rel="nofollow" class="external text" href="https://ansyshelp.ansys.com/">here</a>.  There is documentation for Multiphysics System Coupling versions 2023R1 ---&gt; 202R2 available <a rel="nofollow" class="external text" href="https://ansysapi.ansys.com">here</a> where again login will be required.   To access the Ansys Help for a specific version such as 2023R2 perform the below steps precisely which should work for any module installed under StdEnv/2023 (thus back to 2022R2) and **NOT** require login:
</p>
<ol><li>Connect to <b>gra-vdi.computecanada.ca</b> with tigervnc as described <a href="/wiki/VNC#VDI_Nodes" title="VNC">here</a>.</li>
<li>If the Firefox browser or the Ansys Workbench is open, close it now.</li>
<li>Start Firefox by clicking <i>Applications -&gt; Internet -&gt; Firefox</i>.</li>
<li>Open a <b><i>new</i></b> terminal window by clicking  <i>Applications -&gt; System Tools -&gt; Mate Terminal</i>.</li>
<li>Start Workbench by typing the following in your terminal: <i>module load CcEnv StdEnv/2023 ansys; runwb2</i></li>
<li>Go to the upper Workbench menu bar and click  <i>Help -&gt; ANSYS Workbench Help</i>.  The <b>Workbench Users' Guide</b> should appear loaded in Firefox.</li>
<li>At this point Workbench is no longer needed so close it by clicking the <i>&gt;Unsaved Project - Workbench</i> tab located along the bottom frame (doing this will bring Workbench into focus) and then click <i>File -&gt; Exit</i>.</li>
<li>In the top middle of the Ansys documentation page, click the word <i>HOME</i> located just left of <i>API DOCS</i>.</li>
<li>Now scroll down and you should see a list of Ansys product icons and/or alphabetical ranges.</li>
<li>Select a product to view its documentation.  The documentation for the latest release version will be displayed by default.  Change the version by clicking the <i>Release Year</i> pull down located above and just to the right of the Ansys documentation page search bar.</li>
<li>To search for documentation corresponding to a different Ansys product, click <i>HOME</i> again.</li></ol>
<h2><span class="mw-headline" id="Youtube_videos">Youtube videos</span></h2>
<p>Search the Ansys How To videos <a rel="nofollow" class="external text" href="https://www.youtube.com/@AnsysHowTo/videos">here</a>.
</p>
<h2><span class="mw-headline" id="Innovation_Space">Innovation Space</span></h2>
<p>Search the Ansys Innovation Space <a rel="nofollow" class="external text" href="https://innovationspace.ansys.com/">here</a>.
</p>
<!-- 
NewPP limit report
Cached time: 20250530235443
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.206 seconds
Real time usage: 1.433 seconds
Preprocessor visited node count: 1724/1000000
Post‐expand include size: 46425/2097152 bytes
Template argument size: 67507/2097152 bytes
Highest expansion depth: 9/100
Expensive parser function count: 25/100
Unstrip recursion depth: 3/20
Unstrip post‐expand size: 176862/5000000 bytes
ExtLoops count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00% 1284.314      1 -total
 98.94% 1270.702     23 Template:File
-->

<!-- Saved in parser cache with key ccwiki:pcache:idhash:4568-0!canonical and timestamp 20250530235443 and revision id 177665. Rendering was triggered because: page-view
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys&amp;oldid=177665">https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys&amp;oldid=177665</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/mediawiki/index.php?title=Category:Pages_using_deprecated_source_tags&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using deprecated source tags (page does not exist)">Pages using deprecated source tags</a></li><li><a href="/wiki/Category:Software" title="Category:Software">Software</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-login" class="mw-list-item"><a href="/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Ansys" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li>
		</ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-namespaces-label"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/Ansys" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="/mediawiki/index.php?title=Talk:Ansys&amp;action=edit&amp;redlink=1" rel="discussion" class="new" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-variants-label"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	>
	<label
		id="p-variants-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy vector-menu" aria-labelledby="p-views-label"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected mw-list-item"><a href="/wiki/Ansys"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-menu" aria-labelledby="p-cactions-label"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<h3 >Search</h3>
	<form action="/mediawiki/index.php" id="searchform" class="vector-search-box-form">
		<div id="simpleSearch"
			class="vector-search-box-inner"
			 data-search-loc="header-navigation">
			<input class="vector-search-box-input"
				 type="search" name="search" placeholder="Search Alliance Doc" aria-label="Search Alliance Doc" autocapitalize="sentences" title="Search Alliance Doc [f]" accesskey="f" id="searchInput"
			>
			<input type="hidden" name="title" value="Special:Search">
			<input id="mw-searchButton"
				 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
			<input id="searchButton"
				 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel" class="vector-legacy-sidebar">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Technical_documentation"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu-portal portal vector-menu" aria-labelledby="p-navigation-label"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-wiki-main-page" class="mw-list-item"><a href="/wiki/Technical_documentation"><span>Wiki Main Page</span></a></li>
		</ul>
		
	</div>
</nav>

	
<nav id="p-sidebar-support" class="mw-portlet mw-portlet-sidebar-support vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-support-label"  >
	<h3
		id="p-sidebar-support-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Support</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-getting-started" class="mw-list-item"><a href="/wiki/Getting_started"><span>Getting started</span></a></li><li id="n-sidebar-technical-support" class="mw-list-item"><a href="/wiki/Technical_support"><span>Getting help</span></a></li><li id="n-sidebar-running-jobs" class="mw-list-item"><a href="/wiki/Running_jobs"><span>Running jobs</span></a></li><li id="n-sidebar-known-issues" class="mw-list-item"><a href="/wiki/Known_issues"><span>Known issues</span></a></li><li id="n-sidebar-system-status" class="mw-list-item"><a href="http://status.computecanada.ca" rel="nofollow"><span>System status</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-resources" class="mw-portlet mw-portlet-sidebar-resources vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-resources-label"  >
	<h3
		id="p-sidebar-resources-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Resources</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Béluga" class="mw-list-item"><a href="/wiki/B%C3%A9luga/en"><span>Béluga</span></a></li><li id="n-Cedar" class="mw-list-item"><a href="/wiki/Cedar"><span>Cedar</span></a></li><li id="n-Graham" class="mw-list-item"><a href="/wiki/Graham"><span>Graham</span></a></li><li id="n-Narval" class="mw-list-item"><a href="/wiki/Narval/en"><span>Narval</span></a></li><li id="n-Niagara" class="mw-list-item"><a href="/wiki/Niagara"><span>Niagara</span></a></li><li id="n-sidebar-cloud" class="mw-list-item"><a href="/wiki/CC-Cloud"><span>Cloud</span></a></li><li id="n-tamIA" class="mw-list-item"><a href="/wiki/TamIA/en"><span>tamIA</span></a></li><li id="n-Killarney" class="mw-list-item"><a href="/wiki/Killarney"><span>Killarney</span></a></li><li id="n-sidebar-quantum-computing" class="mw-list-item"><a href="/wiki/Services_d%27informatique_quantique/en"><span>Quantum computing</span></a></li><li id="n-sidebar-available-software" class="mw-list-item"><a href="/wiki/Available_software"><span>Available software</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-alliance" class="mw-portlet mw-portlet-sidebar-alliance vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-alliance-label"  >
	<h3
		id="p-sidebar-alliance-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">The Alliance</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-alliance-main-page" class="mw-list-item"><a href="https://alliancecan.ca/en" rel="nofollow"><span>Alliance main page</span></a></li><li id="n-sidebar-ccdb" class="mw-list-item"><a href="https://ccdb.computecanada.ca/security/login" rel="nofollow"><span>CCDB</span></a></li><li id="n-sidebar-getting-an-account" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/apply-account" rel="nofollow"><span>Getting An Account</span></a></li><li id="n-sidebar-acknowledging-alliance" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/research-portal/acknowledging-alliance" rel="nofollow"><span>Acknowledging the Alliance</span></a></li><li id="n-sidebar-aup" class="mw-list-item"><a href="https://alliancecan.ca/en/services/advanced-research-computing/account-management/policies" rel="nofollow"><span>Acceptable Use Policy</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-sidebar-authoring" class="mw-portlet mw-portlet-sidebar-authoring vector-menu-portal portal vector-menu" aria-labelledby="p-sidebar-authoring-label"  >
	<h3
		id="p-sidebar-authoring-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Authoring</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-sidebar-guidelines" class="mw-list-item"><a href="/wiki/Authoring_guidelines"><span>Guidelines</span></a></li><li id="n-sidebar-mediawiki-help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
		</ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu-portal portal vector-menu" aria-labelledby="p-tb-label"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/Ansys" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/Ansys" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys&amp;oldid=177665" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/mediawiki/index.php?title=Ansys&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
		</ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 9 May 2025, at 17:10.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="/wiki/CCWiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/CCWiki:About">About Alliance Doc</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/CCWiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://docs.alliancecan.ca/mediawiki/index.php?title=Ansys&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/mediawiki/resources/assets/poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.log.warn("This page is using the deprecated ResourceLoader module \"codex-search-styles\".\n[1.43] Use a CodexModule with codexComponents to set your specific components used: https://www.mediawiki.org/wiki/Codex#Using_a_limited_subset_of_components");});</script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-TVBPRD78K4" async=""></script><script>
window.dataLayer = window.dataLayer || [];

function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TVBPRD78K4', {});
</script>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":1555,"wgPageParseReport":{"limitreport":{"cputime":"0.206","walltime":"1.433","ppvisitednodes":{"value":1724,"limit":1000000},"postexpandincludesize":{"value":46425,"limit":2097152},"templateargumentsize":{"value":67507,"limit":2097152},"expansiondepth":{"value":9,"limit":100},"expensivefunctioncount":{"value":25,"limit":100},"unstrip-depth":{"value":3,"limit":20},"unstrip-size":{"value":176862,"limit":5000000},"timingprofile":["100.00% 1284.314      1 -total"," 98.94% 1270.702     23 Template:File"]},"loops":{"limitreport-count-limited":{"value":0,"limit":100}},"cachereport":{"timestamp":"20250530235443","ttl":86400,"transientcontent":false}}});});</script>
</body>
</html>